{
  "states": [
    "Client_Connected",
    "Command_Sent",
    "Waiting_For_Response",
    "Command_Continuation",
    "Finished",
    "Not Authenticated",
    "Authenticated",
    "Selected",
    "Logout"
  ],
  "initial_state": "Client_Connected",
  "final_states": [
    "Finished",
    "Logout"
  ],
  "transitions": [
    {
      "from": "Client_Connected",
      "requisite": "Client sends command",
      "to": "Command_Sent",
      "actions": [
        "Generate unique tag"
      ],
      "response": "None"
    },
    {
      "from": "Command_Sent",
      "requisite": "Server ready for octets or remainder of command",
      "to": "Command_Continuation",
      "actions": [],
      "response": "Command continuation request (+)"
    },
    {
      "from": "Command_Sent",
      "requisite": "Server detects error",
      "to": "Finished",
      "actions": [],
      "response": "BAD completion response"
    },
    {
      "from": "Command_Sent",
      "requisite": "Server processes command successfully",
      "to": "Waiting_For_Response",
      "actions": [],
      "response": "None"
    },
    {
      "from": "Command_Continuation",
      "requisite": "Client sends octets or remainder of command",
      "to": "Waiting_For_Response",
      "actions": [],
      "response": "None"
    },
    {
      "from": "Waiting_For_Response",
      "requisite": "Server sends untagged data",
      "to": "Waiting_For_Response",
      "actions": [
        "Client remembers/caches data"
      ],
      "response": "Untagged response (*)"
    },
    {
      "from": "Waiting_For_Response",
      "requisite": "Server sends completion response (success)",
      "to": "Finished",
      "actions": [],
      "response": "OK completion response"
    },
    {
      "from": "Waiting_For_Response",
      "requisite": "Server sends completion response (failure)",
      "to": "Finished",
      "actions": [],
      "response": "NO completion response"
    },
    {
      "from": "Waiting_For_Response",
      "requisite": "Server sends completion response (protocol error)",
      "to": "Finished",
      "actions": [],
      "response": "BAD completion response"
    },
    {
      "from": "Finished",
      "requisite": "Client initiates new command",
      "to": "Command_Sent",
      "actions": [
        "Generate unique tag"
      ],
      "response": "None"
    },
    {
      "from": "Not Authenticated",
      "requisite": "successful LOGIN or AUTHENTICATE command",
      "to": "Authenticated",
      "actions": [],
      "response": null
    },
    {
      "from": "Authenticated",
      "requisite": "successful SELECT or EXAMINE command",
      "to": "Selected",
      "actions": [],
      "response": null
    },
    {
      "from": "Selected",
      "requisite": "CLOSE or UNSELECT command, unsolicited CLOSED response code, or failed SELECT or EXAMINE command",
      "to": "Authenticated",
      "actions": [],
      "response": null
    },
    {
      "from": "Not Authenticated",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [],
      "response": null
    },
    {
      "from": "Authenticated",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [],
      "response": null
    },
    {
      "from": "Selected",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [],
      "response": null
    },
    {
      "from": "Not Authenticated",
      "requisite": "STARTTLS",
      "to": "Not Authenticated",
      "actions": [
        "begin TLS negotiation"
      ],
      "response": "no specific response"
    },
    {
      "from": "Not Authenticated",
      "requisite": "AUTHENTICATE",
      "to": "Authenticated",
      "actions": [
        "authenticate"
      ],
      "response": "continuation data can be requested"
    },
    {
      "from": "Not Authenticated",
      "requisite": "LOGIN",
      "to": "Authenticated",
      "actions": [
        "authenticate"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Authenticated",
      "requisite": "ENABLE",
      "to": "Authenticated",
      "actions": [
        "enable capabilities"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Authenticated",
      "requisite": "SELECT",
      "to": "Selected",
      "actions": [
        "select mailbox"
      ],
      "response": "FLAGS, EXISTS, LIST, PERMANENTFLAGS, UIDNEXT, UIDVALIDITY"
    },
    {
      "from": "Authenticated",
      "requisite": "EXAMINE",
      "to": "Selected",
      "actions": [
        "examine mailbox"
      ],
      "response": "FLAGS, EXISTS, LIST, PERMANENTFLAGS, UIDNEXT, UIDVALIDITY"
    },
    {
      "from": "Authenticated",
      "requisite": "NAMESPACE",
      "to": "Authenticated",
      "actions": [],
      "response": "NAMESPACE"
    },
    {
      "from": "Authenticated",
      "requisite": "CREATE",
      "to": "Authenticated",
      "actions": [
        "create mailbox"
      ],
      "response": "OPTIONAL LIST"
    },
    {
      "from": "Authenticated",
      "requisite": "DELETE",
      "to": "Authenticated",
      "actions": [
        "delete mailbox"
      ],
      "response": "OPTIONAL LIST"
    },
    {
      "from": "Authenticated",
      "requisite": "RENAME",
      "to": "Authenticated",
      "actions": [
        "rename mailbox"
      ],
      "response": "OPTIONAL LIST"
    },
    {
      "from": "Authenticated",
      "requisite": "SUBSCRIBE",
      "to": "Authenticated",
      "actions": [
        "subscribe to mailbox"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Authenticated",
      "requisite": "UNSUBSCRIBE",
      "to": "Authenticated",
      "actions": [
        "unsubscribe from mailbox"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Authenticated",
      "requisite": "LIST",
      "to": "Authenticated",
      "actions": [
        "list mailboxes"
      ],
      "response": "LIST"
    },
    {
      "from": "Authenticated",
      "requisite": "STATUS",
      "to": "Authenticated",
      "actions": [
        "get mailbox status"
      ],
      "response": "STATUS"
    },
    {
      "from": "Authenticated",
      "requisite": "APPEND",
      "to": "Authenticated",
      "actions": [
        "append message to mailbox"
      ],
      "response": "OPTIONAL LIST"
    },
    {
      "from": "Authenticated",
      "requisite": "IDLE",
      "to": "Authenticated",
      "actions": [
        "wait for server updates"
      ],
      "response": "continuation data will be requested"
    },
    {
      "from": "Selected",
      "requisite": "CLOSE",
      "to": "Authenticated",
      "actions": [
        "remove deleted messages"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Selected",
      "requisite": "UNSELECT",
      "to": "Authenticated",
      "actions": [
        "free session resources"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Selected",
      "requisite": "EXPUNGE",
      "to": "Selected",
      "actions": [
        "permanently remove deleted messages"
      ],
      "response": "EXPUNGE"
    },
    {
      "from": "Selected",
      "requisite": "SEARCH",
      "to": "Selected",
      "actions": [
        "search mailbox"
      ],
      "response": "OPTIONAL ESEARCH"
    },
    {
      "from": "Selected",
      "requisite": "FETCH",
      "to": "Selected",
      "actions": [
        "retrieve message data"
      ],
      "response": "FETCH"
    },
    {
      "from": "Selected",
      "requisite": "STORE",
      "to": "Selected",
      "actions": [
        "alter message data"
      ],
      "response": "FETCH"
    },
    {
      "from": "Selected",
      "requisite": "COPY",
      "to": "Selected",
      "actions": [
        "copy messages to mailbox"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Selected",
      "requisite": "MOVE",
      "to": "Selected",
      "actions": [
        "move messages to mailbox"
      ],
      "response": "no specific responses"
    },
    {
      "from": "Selected",
      "requisite": "UID",
      "to": "Selected",
      "actions": [
        "perform command using UIDs"
      ],
      "response": "FETCH, ESEARCH, EXPUNGE"
    }
  ]
}