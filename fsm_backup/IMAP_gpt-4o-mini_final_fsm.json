{
  "states": [
    "Client Command State",
    "Server Response State",
    "Command Continuation State",
    "Not Authenticated",
    "Authenticated",
    "Selected",
    "Logout",
    "Any State",
    "Not Authenticated State",
    "Authenticated State",
    "Selected State",
    "initial",
    "authenticated",
    "selected",
    "STARTTLS",
    "AUTHENTICATE",
    "FETCH",
    "STORE"
  ],
  "initial_state": "Client Command State",
  "final_states": [
    "Logout",
    "STARTTLS"
  ],
  "transitions": [
    {
      "from": "Client Command State",
      "requisite": "Client sends command",
      "to": "Server Response State",
      "actions": [
        "Parse command",
        "Send command to server"
      ],
      "response": "Server sends response"
    },
    {
      "from": "Server Response State",
      "requisite": "Server sends untagged response",
      "to": "Command Continuation State",
      "actions": [
        "Handle untagged response"
      ],
      "response": "Client processes response"
    },
    {
      "from": "Command Continuation State",
      "requisite": "Server sends command continuation request",
      "to": "Client Command State",
      "actions": [
        "Client sends continuation"
      ],
      "response": "Server processes continuation"
    },
    {
      "from": "Not Authenticated",
      "requisite": "connection without pre-authentication",
      "to": "Not Authenticated",
      "actions": [],
      "response": "OK greeting"
    },
    {
      "from": "Not Authenticated",
      "requisite": "pre-authenticated connection",
      "to": "Authenticated",
      "actions": [],
      "response": "PREAUTH greeting"
    },
    {
      "from": "Not Authenticated",
      "requisite": "rejected connection",
      "to": "Logout",
      "actions": [],
      "response": "BYE greeting"
    },
    {
      "from": "Not Authenticated",
      "requisite": "successful LOGIN or AUTHENTICATE command",
      "to": "Authenticated",
      "actions": [],
      "response": "success"
    },
    {
      "from": "Authenticated",
      "requisite": "successful SELECT or EXAMINE command",
      "to": "Selected",
      "actions": [],
      "response": "success"
    },
    {
      "from": "Authenticated",
      "requisite": "CLOSE or UNSELECT command, unsolicited CLOSED response code, or failed SELECT or EXAMINE command",
      "to": "Authenticated",
      "actions": [],
      "response": "success"
    },
    {
      "from": "Authenticated",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [],
      "response": "server response"
    },
    {
      "from": "Selected",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [],
      "response": "server response"
    },
    {
      "from": "Any State",
      "requisite": "CAPABILITY, NOOP, LOGOUT",
      "to": "Any State",
      "actions": [],
      "response": "OK"
    },
    {
      "from": "Not Authenticated State",
      "requisite": "STARTTLS, AUTHENTICATE, LOGIN",
      "to": "Authenticated State",
      "actions": [],
      "response": "OK"
    },
    {
      "from": "Authenticated State",
      "requisite": "ENABLE, SELECT, EXAMINE, NAMESPACE, CREATE, DELETE, RENAME, SUBSCRIBE, UNSUBSCRIBE, LIST, STATUS, APPEND, IDLE",
      "to": "Selected State",
      "actions": [],
      "response": "OK"
    },
    {
      "from": "Selected State",
      "requisite": "CLOSE, UNSELECT, EXPUNGE, SEARCH, FETCH, STORE, COPY, MOVE, UID",
      "to": "Selected State",
      "actions": [],
      "response": "OK"
    },
    {
      "from": "initial",
      "requisite": "client sends LOGIN or AUTHENTICATE",
      "to": "authenticated",
      "actions": [
        "process authentication"
      ],
      "response": "OK or NO with response code"
    },
    {
      "from": "authenticated",
      "requisite": "client selects a mailbox",
      "to": "selected",
      "actions": [
        "check mailbox status"
      ],
      "response": "EXISTS or FLAGS response"
    },
    {
      "from": "selected",
      "requisite": "client issues commands",
      "to": "selected",
      "actions": [
        "execute command"
      ],
      "response": "untagged responses or command completion"
    },
    {
      "from": "STARTTLS",
      "requisite": "Client requests STARTTLS",
      "to": "AUTHENTICATE",
      "actions": [
        "Initiate TLS negotiation"
      ],
      "response": "OK Proceed with TLS negotiation"
    },
    {
      "from": "AUTHENTICATE",
      "requisite": "Client sends authentication data",
      "to": "SELECT",
      "actions": [
        "Authenticate user"
      ],
      "response": "OK SCRAM-SHA-256 authentication successful"
    },
    {
      "from": "SELECT",
      "requisite": "Client selects mailbox",
      "to": "FETCH",
      "actions": [
        "Select mailbox"
      ],
      "response": "OK [READ-WRITE] SELECT completed"
    },
    {
      "from": "FETCH",
      "requisite": "Client requests message data",
      "to": "STORE",
      "actions": [
        "Fetch message data"
      ],
      "response": "OK FETCH completed"
    },
    {
      "from": "STORE",
      "requisite": "Client requests to store flags",
      "to": "LOGOUT",
      "actions": [
        "Store flags"
      ],
      "response": "OK +FLAGS completed"
    },
    {
      "from": "LOGOUT",
      "requisite": "Client requests logout",
      "to": "STARTTLS",
      "actions": [
        "Terminate connection"
      ],
      "response": "OK LOGOUT completed"
    }
  ]
}