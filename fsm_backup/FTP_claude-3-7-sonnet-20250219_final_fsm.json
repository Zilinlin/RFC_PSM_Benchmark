{
  "states": [
    "INITIAL",
    "CONNECTED",
    "WAIT_FOR_PASSWORD",
    "WAIT_FOR_ACCOUNT",
    "LOGGED_IN",
    "RENAME_FROM_RECEIVED",
    "WAIT_FOR_RESTART_COMMAND",
    "FILE_TRANSFER",
    "TYPE_SET",
    "ACCESS_DENIED",
    "TERMINATED"
  ],
  "initial_state": "INITIAL",
  "final_states": [
    "TERMINATED"
  ],
  "transitions": [
    {
      "from": "INITIAL",
      "requisite": "User initiates connection",
      "to": "CONNECTED",
      "actions": [
        "Connect to host S, port L"
      ],
      "response": "220 Service ready"
    },
    {
      "from": "CONNECTED",
      "requisite": "USER command received",
      "to": "WAIT_FOR_PASSWORD",
      "actions": [
        "Process USER command"
      ],
      "response": "331 User name okay, need password."
    },
    {
      "from": "WAIT_FOR_PASSWORD",
      "requisite": "PASS command received and account required",
      "to": "WAIT_FOR_ACCOUNT",
      "actions": [
        "Process PASS command"
      ],
      "response": "332 Need account for login."
    },
    {
      "from": "WAIT_FOR_PASSWORD",
      "requisite": "PASS command received and no account required",
      "to": "LOGGED_IN",
      "actions": [
        "Process PASS command"
      ],
      "response": "230 User logged in, proceed."
    },
    {
      "from": "WAIT_FOR_ACCOUNT",
      "requisite": "ACCT command received",
      "to": "LOGGED_IN",
      "actions": [
        "Process ACCT command"
      ],
      "response": "230 User logged in, proceed."
    },
    {
      "from": "LOGGED_IN",
      "requisite": "RNFR command received",
      "to": "RENAME_FROM_RECEIVED",
      "actions": [
        "Process RNFR command"
      ],
      "response": "350 Requested file action pending further information."
    },
    {
      "from": "RENAME_FROM_RECEIVED",
      "requisite": "RNTO command received",
      "to": "LOGGED_IN",
      "actions": [
        "Process RNTO command",
        "Rename file"
      ],
      "response": "250 Requested file action okay, completed."
    },
    {
      "from": "LOGGED_IN",
      "requisite": "REST command received",
      "to": "WAIT_FOR_RESTART_COMMAND",
      "actions": [
        "Process REST command"
      ],
      "response": "350 Requested file action pending further information."
    },
    {
      "from": "WAIT_FOR_RESTART_COMMAND",
      "requisite": "RETR or STOR command received",
      "to": "LOGGED_IN",
      "actions": [
        "Process file transfer with restart marker"
      ],
      "response": "150 File status okay; about to open data connection."
    },
    {
      "from": "LOGGED_IN",
      "requisite": "QUIT command received",
      "to": "INITIAL",
      "actions": [
        "Close control connection"
      ],
      "response": "221 Service closing control connection."
    },
    {
      "from": "LOGGED_IN",
      "requisite": "REIN command received",
      "to": "INITIAL",
      "actions": [
        "Reset parameters to default settings"
      ],
      "response": "220 Service ready for new user."
    },
    {
      "from": "LOGGED_IN",
      "requisite": "User requests file retrieval",
      "to": "FILE_TRANSFER",
      "actions": [
        "RETR test.pl1"
      ],
      "response": "150 File status okay; about to open data connection"
    },
    {
      "from": "FILE_TRANSFER",
      "requisite": "File transfer completes",
      "to": "LOGGED_IN",
      "actions": [
        "Server makes data connection",
        "Data transfer occurs"
      ],
      "response": "226 Closing data connection, file transfer successful"
    },
    {
      "from": "LOGGED_IN",
      "requisite": "User changes transfer type",
      "to": "TYPE_SET",
      "actions": [
        "TYPE I"
      ],
      "response": "200 Command OK"
    },
    {
      "from": "TYPE_SET",
      "requisite": "User attempts to store file",
      "to": "ACCESS_DENIED",
      "actions": [
        "STOR >udd>cn>fd"
      ],
      "response": "550 Access denied"
    },
    {
      "from": "ACCESS_DENIED",
      "requisite": "User terminates session",
      "to": "TERMINATED",
      "actions": [
        "QUIT"
      ],
      "response": "Server closes all connections"
    }
  ]
}