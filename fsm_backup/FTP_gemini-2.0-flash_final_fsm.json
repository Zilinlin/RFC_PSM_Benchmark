{
  "states": [
    "Default",
    "Non-Default",
    "Initial",
    "UserSent",
    "PassSent",
    "AccountSent",
    "RenameFromSent",
    "LoggedIn",
    "Connection Establishment",
    "Login",
    "Transfer parameters",
    "File action commands",
    "Informational commands",
    "Miscellaneous commands",
    "B",
    "W",
    "S",
    "F",
    "E"
  ],
  "initial_state": "Connection Establishment",
  "final_states": [
    "Non-Default",
    "LoggedIn",
    "File action commands",
    "Informational commands",
    "Miscellaneous commands",
    "E"
  ],
  "transitions": [
    {
      "from": "Default",
      "requisite": "User-PI initiates a change to non-default ports",
      "to": "Non-Default",
      "actions": [
        "User specifies alternate data port using PORT command",
        "User requests server to identify non-default server side data port with PASV command"
      ],
      "response": "Server acknowledges the port change"
    },
    {
      "from": "Non-Default",
      "requisite": "Server completes sending data in stream mode or receives ABORT command or port specification is changed or control connection is closed or irrecoverable error occurs",
      "to": "Default",
      "actions": [
        "Server closes the data connection"
      ],
      "response": "250 or 226 reply"
    },
    {
      "from": "Initial",
      "requisite": "USER command",
      "to": "UserSent",
      "actions": [],
      "response": "331 User name okay, need password."
    },
    {
      "from": "Initial",
      "requisite": "USER command",
      "to": "UserSent",
      "actions": [],
      "response": "332 Need account for login."
    },
    {
      "from": "UserSent",
      "requisite": "PASS command",
      "to": "PassSent",
      "actions": [],
      "response": "230 User logged in, proceed."
    },
    {
      "from": "UserSent",
      "requisite": "PASS command",
      "to": "PassSent",
      "actions": [],
      "response": "332 Need account for login."
    },
    {
      "from": "PassSent",
      "requisite": "ACCT command",
      "to": "AccountSent",
      "actions": [],
      "response": "230 User logged in, proceed."
    },
    {
      "from": "PassSent",
      "requisite": "ACCT command",
      "to": "AccountSent",
      "actions": [],
      "response": "532 Need account for storing files."
    },
    {
      "from": "Any",
      "requisite": "REIN command",
      "to": "Initial",
      "actions": [
        "reset parameters to default"
      ],
      "response": "220 Service ready for new user."
    },
    {
      "from": "Any",
      "requisite": "QUIT command",
      "to": "Initial",
      "actions": [
        "close control connection"
      ],
      "response": "221 Service closing control connection."
    },
    {
      "from": "Any",
      "requisite": "RNFR command",
      "to": "RenameFromSent",
      "actions": [],
      "response": "350 Requested file action pending further information."
    },
    {
      "from": "RenameFromSent",
      "requisite": "RNTO command",
      "to": "Any",
      "actions": [],
      "response": "250 Requested file action okay, completed."
    },
    {
      "from": "Connection Establishment",
      "requisite": "Connect",
      "to": "Login",
      "actions": [],
      "response": "120, 220, 421"
    },
    {
      "from": "Login",
      "requisite": "USER",
      "to": "Login",
      "actions": [],
      "response": "230, 530, 500, 501, 421, 331, 332"
    },
    {
      "from": "Login",
      "requisite": "PASS",
      "to": "Login",
      "actions": [],
      "response": "230, 202, 530, 500, 501, 503, 421, 332"
    },
    {
      "from": "Login",
      "requisite": "ACCT",
      "to": "Login",
      "actions": [],
      "response": "230, 202, 530, 500, 501, 503, 421"
    },
    {
      "from": "Login",
      "requisite": "CWD",
      "to": "Login",
      "actions": [],
      "response": "250, 500, 501, 502, 421, 530, 550"
    },
    {
      "from": "Login",
      "requisite": "CDUP",
      "to": "Login",
      "actions": [],
      "response": "200, 500, 501, 502, 421, 530, 550"
    },
    {
      "from": "Login",
      "requisite": "SMNT",
      "to": "Login",
      "actions": [],
      "response": "202, 250, 500, 501, 502, 421, 530, 550"
    },
    {
      "from": "Login",
      "requisite": "REIN",
      "to": "Connection Establishment",
      "actions": [],
      "response": "120, 220, 421, 500, 502"
    },
    {
      "from": "Login",
      "requisite": "QUIT",
      "to": "Connection Establishment",
      "actions": [],
      "response": "221, 500"
    },
    {
      "from": "Login",
      "requisite": "PORT",
      "to": "Transfer parameters",
      "actions": [],
      "response": "200, 500, 501, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "PASV",
      "to": "Transfer parameters",
      "actions": [],
      "response": "227, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "MODE",
      "to": "Transfer parameters",
      "actions": [],
      "response": "200, 500, 501, 504, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "TYPE",
      "to": "Transfer parameters",
      "actions": [],
      "response": "200, 500, 501, 504, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "STRU",
      "to": "Transfer parameters",
      "actions": [],
      "response": "200, 500, 501, 504, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "ALLO",
      "to": "File action commands",
      "actions": [],
      "response": "200, 202, 500, 501, 504, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "REST",
      "to": "File action commands",
      "actions": [],
      "response": "500, 501, 502, 421, 530, 350"
    },
    {
      "from": "Login",
      "requisite": "STOR",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 532, 450, 452, 553, 500, 501, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "STOU",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 532, 450, 452, 553, 500, 501, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "RETR",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 450, 550, 500, 501, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "LIST",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 450, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "NLST",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 450, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "APPE",
      "to": "File action commands",
      "actions": [],
      "response": "125, 150, 532, 450, 550, 452, 553, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "RNFR",
      "to": "File action commands",
      "actions": [],
      "response": "450, 550, 500, 501, 502, 421, 530, 350"
    },
    {
      "from": "Login",
      "requisite": "RNTO",
      "to": "File action commands",
      "actions": [],
      "response": "250, 532, 553, 500, 501, 502, 503, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "DELE",
      "to": "File action commands",
      "actions": [],
      "response": "250, 450, 550, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "RMD",
      "to": "File action commands",
      "actions": [],
      "response": "250, 500, 501, 502, 421, 530, 550"
    },
    {
      "from": "Login",
      "requisite": "MKD",
      "to": "File action commands",
      "actions": [],
      "response": "257, 500, 501, 502, 421, 530, 550"
    },
    {
      "from": "Login",
      "requisite": "PWD",
      "to": "File action commands",
      "actions": [],
      "response": "257, 500, 501, 502, 421, 550"
    },
    {
      "from": "Login",
      "requisite": "ABOR",
      "to": "File action commands",
      "actions": [],
      "response": "225, 226, 500, 501, 502, 421"
    },
    {
      "from": "Login",
      "requisite": "SYST",
      "to": "Informational commands",
      "actions": [],
      "response": "215, 500, 501, 502, 421"
    },
    {
      "from": "Login",
      "requisite": "STAT",
      "to": "Informational commands",
      "actions": [],
      "response": "211, 212, 213, 450, 500, 501, 502, 421, 530"
    },
    {
      "from": "Login",
      "requisite": "HELP",
      "to": "Informational commands",
      "actions": [],
      "response": "211, 214, 500, 501, 502, 421"
    },
    {
      "from": "Login",
      "requisite": "SITE",
      "to": "Miscellaneous commands",
      "actions": [],
      "response": "200, 202, 500, 501, 530"
    },
    {
      "from": "Login",
      "requisite": "NOOP",
      "to": "Miscellaneous commands",
      "actions": [],
      "response": "200, 500, 421"
    },
    {
      "from": "File action commands",
      "requisite": "Data Transfer Complete",
      "to": "Login",
      "actions": [],
      "response": "226, 250"
    },
    {
      "from": "B",
      "requisite": "cmd",
      "to": "W",
      "actions": [],
      "response": null
    },
    {
      "from": "W",
      "requisite": "2",
      "to": "S",
      "actions": [],
      "response": null
    },
    {
      "from": "W",
      "requisite": "4,5",
      "to": "F",
      "actions": [],
      "response": null
    },
    {
      "from": "W",
      "requisite": "1,3",
      "to": "E",
      "actions": [],
      "response": null
    }
  ]
}