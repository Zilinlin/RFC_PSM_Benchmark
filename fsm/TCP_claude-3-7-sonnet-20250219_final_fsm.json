{
  "states": [
    "CLOSED",
    "LISTEN",
    "SYN_SENT",
    "SYN_RECEIVED",
    "ESTABLISHED",
    "FIN_WAIT_1",
    "FIN_WAIT_2",
    "CLOSE_WAIT",
    "CLOSING",
    "LAST_ACK",
    "TIME_WAIT"
  ],
  "initial_state": "CLOSED",
  "final_states": [],
  "transitions": [
    {
      "from": "CLOSED",
      "event": "receive active OPEN",
      "action": "send SYN",
      "to": "SYN_SENT"
    },
    {
      "from": "CLOSED",
      "event": "receive passive OPEN",
      "action": "create TCB",
      "to": "LISTEN"
    },
    {
      "from": "LISTEN",
      "event": "receive SYN",
      "action": "send SYN,ACK",
      "to": "SYN_RECEIVED"
    },
    {
      "from": "LISTEN",
      "event": "receive SEND",
      "action": "send SYN",
      "to": "SYN_SENT"
    },
    {
      "from": "SYN_SENT",
      "event": "receive SYN",
      "action": "send SYN,ACK",
      "to": "SYN_RECEIVED"
    },
    {
      "from": "SYN_SENT",
      "event": "receive SYN,ACK",
      "action": "send ACK",
      "to": "ESTABLISHED"
    },
    {
      "from": "SYN_RECEIVED",
      "event": "receive ACK",
      "action": "set connection established",
      "to": "ESTABLISHED"
    },
    {
      "from": "SYN_RECEIVED",
      "event": "receive RST",
      "action": "close connection",
      "to": "LISTEN"
    },
    {
      "from": "ESTABLISHED",
      "event": "receive CLOSE",
      "action": "send FIN",
      "to": "FIN_WAIT_1"
    },
    {
      "from": "ESTABLISHED",
      "event": "receive FIN",
      "action": "send ACK",
      "to": "CLOSE_WAIT"
    },
    {
      "from": "FIN_WAIT_1",
      "event": "receive ACK",
      "action": "acknowledge FIN",
      "to": "FIN_WAIT_2"
    },
    {
      "from": "FIN_WAIT_1",
      "event": "receive FIN",
      "action": "send ACK",
      "to": "CLOSING"
    },
    {
      "from": "FIN_WAIT_1",
      "event": "receive FIN,ACK",
      "action": "send ACK",
      "to": "TIME_WAIT"
    },
    {
      "from": "FIN_WAIT_2",
      "event": "receive FIN",
      "action": "send ACK",
      "to": "TIME_WAIT"
    },
    {
      "from": "CLOSE_WAIT",
      "event": "receive CLOSE",
      "action": "send FIN",
      "to": "LAST_ACK"
    },
    {
      "from": "CLOSING",
      "event": "receive ACK",
      "action": "acknowledge FIN",
      "to": "TIME_WAIT"
    },
    {
      "from": "LAST_ACK",
      "event": "receive ACK",
      "action": "delete TCB",
      "to": "CLOSED"
    },
    {
      "from": "TIME_WAIT",
      "event": "timeout 2MSL",
      "action": "delete TCB",
      "to": "CLOSED"
    },
    {
      "from": "ESTABLISHED",
      "event": "receive RST",
      "action": "close connection",
      "to": "CLOSED"
    },
    {
      "from": "ESTABLISHED",
      "event": "receive ABORT",
      "action": "send RST",
      "to": "CLOSED"
    }
  ]
}