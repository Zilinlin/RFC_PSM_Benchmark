{
  "states": [
    "Not Authenticated",
    "Authenticated",
    "Selected",
    "Logout",
    "Connection Established",
    "Connection Closed"
  ],
  "initial_state": "Connection Established",
  "final_states": [
    "Connection Closed"
  ],
  "transitions": [
    {
      "from": "Connection Established",
      "requisite": "OK greeting",
      "to": "Not Authenticated",
      "actions": [
        "server greeting"
      ],
      "response": "connection without pre-authentication"
    },
    {
      "from": "Connection Established",
      "requisite": "PREAUTH greeting",
      "to": "Authenticated",
      "actions": [
        "server greeting"
      ],
      "response": "pre-authenticated connection"
    },
    {
      "from": "Connection Established",
      "requisite": "BYE greeting",
      "to": "Logout",
      "actions": [
        "server greeting"
      ],
      "response": "rejected connection"
    },
    {
      "from": "Not Authenticated",
      "requisite": "successful LOGIN or AUTHENTICATE command",
      "to": "Authenticated",
      "actions": [
        "establish authentication"
      ],
      "response": "OK - authenticate/login completed"
    },
    {
      "from": "Not Authenticated",
      "requisite": "STARTTLS command",
      "to": "Not Authenticated",
      "actions": [
        "begin TLS negotiation"
      ],
      "response": "OK - starttls completed"
    },
    {
      "from": "Authenticated",
      "requisite": "successful SELECT or EXAMINE command",
      "to": "Selected",
      "actions": [
        "select mailbox"
      ],
      "response": "OK - select/examine completed"
    },
    {
      "from": "Selected",
      "requisite": "CLOSE command",
      "to": "Authenticated",
      "actions": [
        "remove messages with \\Deleted flag"
      ],
      "response": "OK - close completed"
    },
    {
      "from": "Selected",
      "requisite": "UNSELECT command",
      "to": "Authenticated",
      "actions": [
        "free resources associated with selected mailbox"
      ],
      "response": "OK - unselect completed"
    },
    {
      "from": "Selected",
      "requisite": "SELECT or EXAMINE command",
      "to": "Selected",
      "actions": [
        "deselect current mailbox, select new mailbox"
      ],
      "response": "OK - select/examine completed"
    },
    {
      "from": "Not Authenticated",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [
        "close connection"
      ],
      "response": "BYE followed by OK"
    },
    {
      "from": "Authenticated",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [
        "close connection"
      ],
      "response": "BYE followed by OK"
    },
    {
      "from": "Selected",
      "requisite": "LOGOUT command, server shutdown, or connection closed",
      "to": "Logout",
      "actions": [
        "close connection"
      ],
      "response": "BYE followed by OK"
    },
    {
      "from": "Logout",
      "requisite": "",
      "to": "Connection Closed",
      "actions": [
        "both sides close the connection"
      ],
      "response": ""
    }
  ]
}