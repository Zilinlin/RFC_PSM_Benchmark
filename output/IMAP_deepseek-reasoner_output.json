{
  "protocol": "IMAP",
  "model": "deepseek-reasoner",
  "sections": [
    {
      "tag": "Section 1. How to Read This Document",
      "prompt": "\nYou will be given the section \"Section 1. How to Read This Document\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\n1.1.  Organization of This Document\n   This document is written from the point of view of the implementor of\n   an IMAP4rev2 client or server.  Beyond the protocol overview in\n   Section 2, it is not optimized for someone trying to understand the\n   operation of the protocol.  The material in Sections 3, 4, and 5\n   provides the general context and definitions with which IMAP4rev2\n   operates.\n   Sections 6, 7, and 9 describe the IMAP commands, responses, and\n   syntax, respectively.  The relationships among these are such that it\n   is almost impossible to understand any of them separately.  In\n   particular, do not attempt to deduce command syntax from the command\n   section alone; instead, refer to \"Formal Syntax\" (Section 9).\n1.2.  Conventions Used in This Document\n   \"Conventions\" are basic principles or procedures.  Document\n   conventions are noted in this section.\n   In examples, \"C:\" and \"S:\" indicate lines sent by the client and\n   server, respectively.  Note that each line includes the terminating\n   CRLF.\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n   capitals, as shown here.\n   The word \"can\" (not \"may\") is used to refer to a possible\n   circumstance or situation, as opposed to an optional facility of the\n   protocol.\n   \"User\" is used to refer to a human user, whereas \"client\" refers to\n   the software being run by the user.\n   \"Connection\" refers to the entire sequence of client/server\n   interaction from the initial establishment of the network connection\n   until its termination.\n   \"Session\" refers to the sequence of client/server interaction from\n   the time that a mailbox is selected (SELECT or EXAMINE command) until\n   the time that selection ends (SELECT or EXAMINE of another mailbox,\n   CLOSE command, UNSELECT command, or connection termination).\n   The term \"Implicit TLS\" refers to the automatic negotiation of TLS\n   whenever a TCP connection is made on a particular TCP port that is\n   used exclusively by that server for TLS connections.  The term\n   \"Implicit TLS\" is intended to contrast with the use of the STARTTLS\n   command in IMAP that is used by the client and the server to\n   explicitly negotiate TLS on an established cleartext TCP connection.\n   Characters are 8-bit UTF-8 (of which 7-bit US-ASCII is a subset),\n   unless otherwise specified.  Other character sets are indicated using\n   a \"CHARSET\", as described in [MIME-IMT] and defined in [CHARSET].\n   CHARSETs have important additional semantics in addition to defining\n   a character set; refer to these documents for more detail.\n   There are several protocol conventions in IMAP.  These refer to\n   aspects of the specification that are not strictly part of the IMAP\n   protocol but reflect generally accepted practice.  Implementations\n   need to be aware of these conventions, and avoid conflicts whether or\n   not they implement the convention.  For example, \"&\" may not be used\n   as a hierarchy delimiter since it conflicts with the Mailbox\n   International Naming Convention, and other uses of \"&\" in mailbox\n   names are impacted as well.\n1.3.  Special Notes to Implementors\n   Implementors of the IMAP protocol are strongly encouraged to read the\n   IMAP implementation recommendations document [IMAP-IMPLEMENTATION] in\n   conjunction with this document, to help understand the intricacies of\n   this protocol and how best to build an interoperable product.\n   IMAP4rev2 is designed to be upwards compatible from the IMAP4rev1\n   [RFC3501], IMAP2 [IMAP2], and unpublished IMAP2bis [IMAP2BIS]\n   protocols.  IMAP4rev2 is largely compatible with the IMAP4rev1\n   protocol described in RFC 3501 and the IMAP4 protocol described in\n   [RFC1730]; the exception being in certain facilities added in\n   [RFC1730] and [RFC3501] that proved problematic and were subsequently\n   removed or replaced by better alternatives.  In the course of the\n   evolution of IMAP4rev2, some aspects in the earlier protocols have\n   become obsolete.  Obsolete commands, responses, and data formats that\n   an IMAP4rev2 implementation can encounter when used with an earlier\n   implementation are described in Appendices A and E and\n   [IMAP-OBSOLETE].  IMAP4rev2 supports 63-bit body parts and message\n   sizes.  IMAP4rev2 compatibility with BINARY and LIST-EXTENDED IMAP\n   extensions are described in Appendices B and C, respectively.\n   Other compatibility issues with IMAP2bis, the most common variant of\n   the earlier protocol, are discussed in [IMAP-COMPAT].  A full\n   discussion of compatibility issues with rare (and presumed extinct)\n   variants of [IMAP2] is in [IMAP-HISTORICAL]; this document is\n   primarily of historical interest.\n   IMAP was originally developed for the older [RFC822] standard, and as\n   a consequence, the \"RFC822.SIZE\" fetch item in IMAP incorporates\n   \"RFC822\" in its name.  \"RFC822\" should be interpreted as a reference\n   to the updated [RFC5322] standard.\n   IMAP4rev2 does not specify a means of posting mail; this function is\n   handled by a mail submission protocol such as the one specified in\n   [RFC6409].\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>None</json>"
    },
    {
      "tag": "Section 2. Protocol Overview",
      "prompt": "\nYou will be given the section \"Section 2. Protocol Overview\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\n2.1.  Link Level\n   The IMAP4rev2 protocol assumes a reliable data stream such as that\n   provided by TCP.  When TCP is used, an IMAP4rev2 server listens on\n   port 143 (cleartext port) or port 993 (Implicit TLS port).\n2.2.  Commands and Responses\n   An IMAP4rev2 connection consists of the establishment of a client/\n   server network connection, an initial greeting from the server, and\n   client/server interactions.  These client/server interactions consist\n   of a client command, server data, and a server completion result\n   response.\n   All interactions transmitted by client and server are in the form of\n   lines, that is, strings that end with a CRLF.  The protocol receiver\n   of an IMAP4rev2 client or server is reading either a line or a\n   sequence of octets with a known count followed by a line.\n2.2.1.  Client Protocol Sender and Server Protocol Receiver\n   The client command begins an operation.  Each client command is\n   prefixed with an identifier (typically a short alphanumeric string,\n   e.g., A0001, A0002, etc.) called a \"tag\".  A different tag is\n   generated by the client for each command.  More formally: the client\n   SHOULD generate a unique tag for every command, but a server MUST\n   accept tag reuse.\n   Clients MUST follow the syntax outlined in this specification\n   strictly.  It is a syntax error to send a command with missing or\n   extraneous spaces or arguments.\n   There are two cases in which a line from the client does not\n   represent a complete command.  In one case, a command argument is\n   quoted with an octet count (see the description of literal in\n   Section 4.3); in the other case, the command arguments require server\n   feedback (see the AUTHENTICATE command in Section 6.2.2).  In either\n   case, the server sends a command continuation request response if it\n   is ready for the octets (if appropriate) and the remainder of the\n   command.  This response is prefixed with the token \"+\".\n      Note: If, instead, the server detected an error in the command, it\n      sends a BAD completion response with a tag matching the command\n      (as described below) to reject the command and prevent the client\n      from sending any more of the command.\n      It is also possible for the server to send a completion response\n      for some other command (if multiple commands are in progress) or\n      untagged data.  In either case, the command continuation request\n      is still pending; the client takes the appropriate action for the\n      response and reads another response from the server.  In all\n      cases, the client MUST send a complete command (including\n      receiving all command continuation request responses and sending\n      command continuations for the command) before initiating a new\n      command.\n   The protocol receiver of an IMAP4rev2 server reads a command line\n   from the client, parses the command and its arguments, and transmits\n   server data and a server command completion result response.\n2.2.2.  Server Protocol Sender and Client Protocol Receiver\n   Data transmitted by the server to the client and status responses\n   that do not indicate command completion are prefixed with the token\n   \"*\" and are called untagged responses.\n   Server data MAY be sent as a result of a client command or MAY be\n   sent unilaterally by the server.  There is no syntactic difference\n   between server data that resulted from a specific command and server\n   data that were sent unilaterally.\n   The server completion result response indicates the success or\n   failure of the operation.  It is tagged with the same tag as the\n   client command that began the operation.  Thus, if more than one\n   command is in progress, the tag in a server completion response\n   identifies the command to which the response applies.  There are\n   three possible server completion responses: OK (indicating success),\n   NO (indicating failure), or BAD (indicating a protocol error such as\n   unrecognized command or command syntax error).\n   Servers SHOULD strictly enforce the syntax outlined in this\n   specification.  Any client command with a protocol syntax error,\n   including (but not limited to) missing or extraneous spaces or\n   arguments, SHOULD be rejected and the client given a BAD server\n   completion response.\n   The protocol receiver of an IMAP4rev2 client reads a response line\n   from the server.  It then takes action on the response based upon the\n   first token of the response, which can be a tag, a \"*\", or a \"+\".\n   A client MUST be prepared to accept any server response at all times.\n   This includes server data that was not requested.  Server data SHOULD\n   be remembered (cached), so that the client can reference its\n   remembered copy rather than sending a command to the server to\n   request the data.  In the case of certain server data, the data MUST\n   be remembered, as specified elsewhere in this document.\n   This topic is discussed in greater detail in \"Server Responses\" (see\n   Section 7).\n2.3.  Message Attributes\n   In addition to message text, each message has several attributes\n   associated with it.  These attributes can be retrieved individually\n   or in conjunction with other attributes or message texts.\n2.3.1.  Message Numbers\n   Messages in IMAP4rev2 are accessed by one of two numbers: the Unique\n   Identifier (UID) or the message sequence number.\n2.3.1.1.  Unique Identifier (UID) Message Attribute\n   A UID is an unsigned non-zero 32-bit value assigned to each message,\n   which when used with the unique identifier validity value (see below)\n   forms a 64-bit value that MUST NOT refer to any other message in the\n   mailbox or any subsequent mailbox with the same name forever.  Unique\n   identifiers are assigned in a strictly ascending fashion in the\n   mailbox; as each message is added to the mailbox, it is assigned a\n   higher UID than those of all message(s) that are already in the\n   mailbox.  Unlike message sequence numbers, unique identifiers are not\n   necessarily contiguous.\n   The unique identifier of a message MUST NOT change during the session\n   and SHOULD NOT change between sessions.  Any change of unique\n   identifiers between sessions MUST be detectable using the UIDVALIDITY\n   mechanism discussed below.  Persistent unique identifiers are\n   required for a client to resynchronize its state from a previous\n   session with the server (e.g., disconnected or offline access clients\n   [IMAP-MODEL]); this is discussed further in [IMAP-DISC].\n   Associated with every mailbox are two 32-bit unsigned non-zero values\n   that aid in unique identifier handling: the next unique identifier\n   value (UIDNEXT) and the unique identifier validity value\n   (UIDVALIDITY).\n   The next unique identifier value is the predicted value that will be\n   assigned to a new message in the mailbox.  Unless the unique\n   identifier validity also changes (see below), the next unique\n   identifier value MUST have the following two characteristics.  First,\n   the next unique identifier value MUST NOT change unless new messages\n   are added to the mailbox; and second, the next unique identifier\n   value MUST change whenever new messages are added to the mailbox,\n   even if those new messages are subsequently expunged.\n      |  Note: The next unique identifier value is intended to provide a\n      |  means for a client to determine whether any messages have been\n      |  delivered to the mailbox since the previous time it checked\n      |  this value.  It is not intended to provide any guarantee that\n      |  any message will have this unique identifier.  A client can\n      |  only assume, at the time that it obtains the next unique\n      |  identifier value, that messages arriving after that time will\n      |  have a UID greater than or equal to that value.\n   The unique identifier validity value is sent in a UIDVALIDITY\n   response code in an OK untagged response at mailbox selection time.\n   If unique identifiers from an earlier session fail to persist in this\n   session, the unique identifier validity value MUST be greater than\n   the one used in the earlier session.  A good UIDVALIDITY value to use\n   is a 32-bit representation of the current date/time when the value is\n   assigned: this ensures that the value is unique and always increases.\n   Another possible alternative is a global counter that gets\n   incremented every time a mailbox is created.\n      Note: Ideally, unique identifiers SHOULD persist at all times.\n      Although this specification recognizes that failure to persist can\n      be unavoidable in certain server environments, it strongly\n      encourages message store implementation techniques that avoid this\n      problem.  For example:\n   1.  Unique identifiers MUST be strictly ascending in the mailbox at\n       all times.  If the physical message store is reordered by a non-\n       IMAP agent, the unique identifiers in the mailbox MUST be\n       regenerated, since the former unique identifiers are no longer\n       strictly ascending as a result of the reordering.\n   2.  If the message store has no mechanism to store unique\n       identifiers, it must regenerate unique identifiers at each\n       session, and each session must have a unique UIDVALIDITY value.\n       Note that this situation can be very disruptive to client message\n       caching.\n   3.  If the mailbox is deleted/renamed and a new mailbox with the same\n       name is created at a later date, the server must either keep\n       track of unique identifiers from the previous instance of the\n       mailbox or assign a new UIDVALIDITY value to the new instance of\n       the mailbox.\n   4.  The combination of mailbox name, UIDVALIDITY, and UID must refer\n       to a single, immutable (or expunged) message on that server\n       forever.  In particular, the internal date, RFC822.SIZE,\n       envelope, body structure, and message texts (all BODY[...] fetch\n       data items) MUST never change.  This does not include message\n       numbers, nor does it include attributes that can be set by a\n       STORE command (such as FLAGS).  When a message is expunged, its\n       UID MUST NOT be reused under the same UIDVALIDITY value.\n2.3.1.2.  Message Sequence Number Message Attribute\n   A message sequence number is a relative position from 1 to the number\n   of messages in the mailbox.  This position MUST be ordered by\n   ascending unique identifiers.  As each new message is added, it is\n   assigned a message sequence number that is 1 higher than the number\n   of messages in the mailbox before that new message was added.\n   Message sequence numbers can be reassigned during the session.  For\n   example, when a message is permanently removed (expunged) from the\n   mailbox, the message sequence number for all subsequent messages is\n   decremented.  The number of messages in the mailbox is also\n   decremented.  Similarly, a new message can be assigned a message\n   sequence number that was once held by some other message prior to an\n   expunge.\n   In addition to accessing messages by relative position in the\n   mailbox, message sequence numbers can be used in mathematical\n   calculations.  For example, if an untagged \"11 EXISTS\" is received,\n   and previously an untagged \"8 EXISTS\" was received, three new\n   messages have arrived with message sequence numbers of 9, 10, and 11.\n   As another example, if message 287 in a 523-message mailbox has UID\n   12345, there are exactly 286 messages that have lesser UIDs and 236\n   messages that have greater UIDs.\n2.3.2.  Flags Message Attribute\n   A message has a list of zero or more named tokens, known as \"flags\",\n   associated with it.  A flag is set by its addition to this list and\n   is cleared by its removal.  There are two types of flags in\n   IMAP4rev2: system flags and keywords.  A flag of either type can be\n   permanent or session-only.\n   A system flag is a flag name that is predefined in this specification\n   and begins with \"\\\".  Certain system flags (\\Deleted and \\Seen) have\n   special semantics described elsewhere in this document.  The\n   currently defined system flags are:\n   \\Seen         Message has been read\n   \\Answered     Message has been answered\n   \\Flagged      Message is \"flagged\" for urgent/special attention\n   \\Deleted      Message is \"deleted\" for removal by later EXPUNGE\n   \\Draft        Message has not completed composition (marked as a\n                 draft).\n   \\Recent       This flag was in use in IMAP4rev1 and is now\n                 deprecated.\n   A keyword is defined by the server implementation.  Keywords do not\n   begin with \"\\\".  Servers MAY permit the client to define new keywords\n   in the mailbox (see the description of the PERMANENTFLAGS response\n   code for more information).  Some keywords that start with \"$\" are\n   also defined in this specification.\n   This document defines several keywords that were not originally\n   defined in [RFC3501] but were found to be useful by client\n   implementations.  These keywords SHOULD be supported (allowed in\n   SEARCH and allowed and preserved in APPEND, COPY, and MOVE commands)\n   by server implementations:\n   $Forwarded\n      Message has been forwarded to another email address by being\n      embedded within, or attached to a new message.  An email client\n      sets this keyword when it successfully forwards the message to\n      another email address.  Typical usage of this keyword is to show a\n      different (or additional) icon for a message that has been\n      forwarded.  Once set, the flag SHOULD NOT be cleared.\n   $MDNSent\n      Message Disposition Notification [RFC8098] was generated and sent\n      for this message.  See [RFC3503] for more details on how this\n      keyword is used and for requirements on clients and servers.\n   $Junk\n      The user (or a delivery agent on behalf of the user) may choose to\n      mark a message as definitely containing junk ($Junk; see also the\n      related keyword $NotJunk).  The $Junk keyword can be used to mark,\n      group, or hide undesirable messages (and such messages might be\n      moved or deleted later).  See [IMAP-KEYWORDS-REG] for more\n      information.\n   $NotJunk\n      The user (or a delivery agent on behalf of the user) may choose to\n      mark a message as definitely not containing junk ($NotJunk; see\n      also the related keyword $Junk).  The $NotJunk keyword can be used\n      to mark, group, or show messages that the user wants to see.  See\n      [IMAP-KEYWORDS-REG] for more information.\n   $Phishing\n      The $Phishing keyword can be used by a delivery agent to mark a\n      message as highly likely to be a phishing email.  A message that's\n      determined to be a phishing email by the delivery agent should\n      also be considered a junk email and have the appropriate junk\n      filtering applied, including setting the $Junk flag and placing\n      the message in the \\Junk special-use mailbox (see Section 7.3.1),\n      if available.\n      If both the $Phishing flag and the $Junk flag are set, the user\n      agent should display an additional warning message to the user.\n      Additionally, the user agent might display a warning, such as\n      something of the form, \"This message may be trying to steal your\n      personal information,\" when the user clicks on any hyperlinks\n      within the message.\n      The requirement for both $Phishing and $Junk to be set before a\n      user agent displays a warning is for better backwards\n      compatibility with existing clients that understand the $Junk flag\n      but not the $Phishing flag.  This is so that when an unextended\n      client removes the $Junk flag, an extended client will also show\n      the correct state.  See [IMAP-KEYWORDS-REG] for more information.\n   $Junk and $NotJunk are mutually exclusive.  If more than one of these\n   is set for a message, the client MUST treat it as if none are set,\n   and it SHOULD unset both of them on the IMAP server.\n   Other registered keywords can be found in the \"IMAP and JMAP\n   Keywords\" registry [IMAP-KEYWORDS-REG].  New keywords SHOULD be\n   registered in this registry using the procedure specified in\n   [RFC5788].\n   A flag can be permanent or session-only on a per-flag basis.\n   Permanent flags are those that the client can add or remove from the\n   message flags permanently; that is, concurrent and subsequent\n   sessions will see any change in permanent flags.  Changes to session\n   flags are valid only in that session.\n2.3.3.  Internal Date Message Attribute\n   An Internal Date message attribute is the internal date and time of\n   the message on the server.  This is not the date and time in the\n   [RFC5322] header but rather a date and time that reflects when the\n   message was received.  In the case of messages delivered via [SMTP],\n   this is the date and time of final delivery of the message as defined\n   by [SMTP].  In the case of messages created by the IMAP4rev2 COPY or\n   MOVE command, this SHOULD be the same as the Internal Date attribute\n   of the source message.  In the case of messages created by the\n   IMAP4rev2 APPEND command, this SHOULD be the date and time as\n   specified in the APPEND command description.  All other cases are\n   implementation defined.\n2.3.4.  RFC822.SIZE Message Attribute\n   RFC822.SIZE is the number of octets in the message when the message\n   is expressed in [RFC5322] format.  This size SHOULD match the result\n   of a \"FETCH BODY[]\" command.  If the message is internally stored in\n   some other format, the server calculates the size and often stores it\n   for later use to avoid the need for recalculation.\n2.3.5.  Envelope Structure Message Attribute\n   An envelope structure is a parsed representation of the [RFC5322]\n   header of the message.  Note that the IMAP envelope structure is not\n   the same as an [SMTP] envelope.\n2.3.6.  Body Structure Message Attribute\n   A body structure is a parsed representation of the [MIME-IMB] body\n   structure information of the message.\n2.4.  Message Texts\n   In addition to being able to fetch the full [RFC5322] text of a\n   message, IMAP4rev2 permits the fetching of portions of the full\n   message text.  Specifically, it is possible to fetch the [RFC5322]\n   message header, the [RFC5322] message body, a [MIME-IMB] body part,\n   or a [MIME-IMB] header.\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"Ready\", \"ProcessingCommand\", \"WaitingForContinuation\"],\n  \"transitions\": [\n    {\n      \"from\": \"Ready\",\n      \"event\": \"receive COMMAND\",\n      \"action\": \"process command\",\n      \"to\": \"ProcessingCommand\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"send +\",\n      \"action\": \"reply +\",\n      \"to\": \"WaitingForContinuation\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"send OK/NO/BAD\",\n      \"action\": \"reply tagged\",\n      \"to\": \"Ready\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"receive CONTINUATION\",\n      \"action\": \"process data\",\n      \"to\": \"ProcessingCommand\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 3. State and Flow Diagram",
      "prompt": "\nYou will be given the section \"Section 3. State and Flow Diagram\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nOnce the connection between client and server is established, an\n   IMAP4rev2 connection is in one of four states.  The initial state is\n   identified in the server greeting.  Most commands are only valid in\n   certain states.  It is a protocol error for the client to attempt a\n   command while the connection is in an inappropriate state, and the\n   server will respond with a BAD or NO (depending upon server\n   implementation) command completion result.\n3.1.  Not Authenticated State\n   In the not authenticated state, the client MUST supply authentication\n   credentials before most commands will be permitted.  This state is\n   entered when a connection starts unless the connection has been pre-\n   authenticated.\n3.2.  Authenticated State\n   In the authenticated state, the client is authenticated and MUST\n   select a mailbox to access before commands that affect messages will\n   be permitted.  This state is entered when a pre-authenticated\n   connection starts, when acceptable authentication credentials have\n   been provided, after an error in selecting a mailbox, or after a\n   successful CLOSE or UNSELECT command.\n3.3.  Selected State\n   In a selected state, a mailbox has been selected to access.  This\n   state is entered when a mailbox has been successfully selected.\n3.4.  Logout State\n   In the logout state, the connection is being terminated.  This state\n   can be entered as a result of a client request (via the LOGOUT\n   command) or by unilateral action on the part of either the client or\n   the server.\n   If the client requests the logout state, the server MUST send an\n   untagged BYE response and a tagged OK response to the LOGOUT command\n   before the server closes the connection; and the client MUST read the\n   tagged OK response to the LOGOUT command before the client closes the\n   connection.\n   A server SHOULD NOT unilaterally close the connection without first\n   sending an untagged BYE response that contains the reason for doing\n   so.  A client SHOULD NOT unilaterally close the connection; instead,\n   it SHOULD issue a LOGOUT command.  If the server detects that the\n   client has unilaterally closed the connection, the server MAY omit\n   the untagged BYE response and simply close its connection.\n                      +----------------------+\n                      |connection established|\n                      +----------------------+\n                                 ||\n                                 \\/\n               +--------------------------------------+\n               |          server greeting             |\n               +--------------------------------------+\n                         || (1)       || (2)        || (3)\n                         \\/           ||            ||\n               +-----------------+    ||            ||\n               |Not Authenticated|    ||            ||\n               +-----------------+    ||            ||\n                || (7)   || (4)       ||            ||\n                ||       \\/           \\/            ||\n                ||     +----------------+           ||\n                ||     | Authenticated  |<=++       ||\n                ||     +----------------+  ||       ||\n                ||       || (7)   || (5)   || (6)   ||\n                ||       ||       \\/       ||       ||\n                ||       ||    +--------+  ||       ||\n                ||       ||    |Selected|==++       ||\n                ||       ||    +--------+           ||\n                ||       ||       || (7)            ||\n                \\/       \\/       \\/                \\/\n               +--------------------------------------+\n               |               Logout                 |\n               +--------------------------------------+\n                                 ||\n                                 \\/\n                   +-------------------------------+\n                   |both sides close the connection|\n                   +-------------------------------+\n   Legend for the above diagram:\n   (1)  connection without pre-authentication (OK greeting)\n   (2)  pre-authenticated connection (PREAUTH greeting)\n   (3)  rejected connection (BYE greeting)\n   (4)  successful LOGIN or AUTHENTICATE command\n   (5)  successful SELECT or EXAMINE command\n   (6)  CLOSE or UNSELECT command, unsolicited CLOSED response code, or\n        failed SELECT or EXAMINE command\n   (7)  LOGOUT command, server shutdown, or connection closed\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"Not_Authenticated\", \"Authenticated\", \"Selected\", \"Logout\"],\n  \"transitions\": [\n    {\n      \"from\": \"Not_Authenticated\",\n      \"event\": \"receive LOGIN\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Not_Authenticated\",\n      \"event\": \"receive AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive SELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive EXAMINE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive CLOSE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive UNSELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Not_Authenticated\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 4. Data Formats",
      "prompt": "\nYou will be given the section \"Section 4. Data Formats\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nIMAP4rev2 uses textual commands and responses.  Data in IMAP4rev2 can\n   be in one of several forms: atom, number, string, parenthesized list,\n   or NIL.  Note that a particular data item may take more than one\n   form; for example, a data item defined as using \"astring\" syntax may\n   be either an atom or a string.\n4.1.  Atom\n   An atom consists of one or more non-special characters.\n4.1.1.  Sequence Set and UID Set\n   A set of messages can be referenced by a sequence set containing\n   either message sequence numbers or unique identifiers.  See Section 9\n   for details.  A sequence set can contain ranges of sequence numbers\n   (such as \"5:50\"), an enumeration of specific sequence numbers, or a\n   combination of the above.  A sequence set can use the special symbol\n   \"*\" to represent the maximum sequence number in the mailbox.  A\n   sequence set never contains unique identifiers.\n   A \"UID set\" is similar to the sequence set, but uses unique\n   identifiers instead of message sequence numbers, and is not permitted\n   to contain the special symbol \"*\".\n4.2.  Number\n   A number consists of one or more digit characters and represents a\n   numeric value.\n4.3.  String\n   A string is in one of three forms: synchronizing literal, non-\n   synchronizing literal, or quoted string.  The synchronizing literal\n   form is the general form of a string, without limitation on the\n   characters the string may include.  The non-synchronizing literal\n   form is also the general form, but it has a length restriction.  The\n   quoted string form is an alternative that avoids the overhead of\n   processing a literal, but has limitations on the characters that may\n   be used.\n   When the distinction between synchronizing and non-synchronizing\n   literals is not important, this document only uses the term\n   \"literal\".\n   A synchronizing literal is a sequence of zero or more octets\n   (including CR and LF), prefix-quoted with an octet count in the form\n   of an open brace (\"{\"), the number of octets, a close brace (\"}\"),\n   and a CRLF.  In the case of synchronizing literals transmitted from\n   server to client, the CRLF is immediately followed by the octet data.\n   In the case of synchronizing literals transmitted from client to\n   server, the client MUST wait to receive a command continuation\n   request (described later in this document) before sending the octet\n   data (and the remainder of the command).\n   The non-synchronizing literal is an alternative form of synchronizing\n   literal and may be used from client to server anywhere a\n   synchronizing literal is permitted.  The non-synchronizing literal\n   form MUST NOT be sent from server to client.  The non-synchronizing\n   literal is distinguished from the synchronizing literal by having a\n   plus (\"+\") between the octet count and the closing brace (\"}\").  The\n   server does not generate a command continuation request in response\n   to a non-synchronizing literal, and clients are not required to wait\n   before sending the octets of a non-synchronizing literal.  Unless\n   otherwise specified in an IMAP extension, non-synchronizing literals\n   MUST NOT be larger than 4096 octets.  Any literal larger than 4096\n   bytes MUST be sent as a synchronizing literal.  (Non-synchronizing\n   literals defined in this document are the same as non-synchronizing\n   literals defined by the LITERAL- extension from [RFC7888].  See that\n   document for details on how to handle invalid non-synchronizing\n   literals longer than 4096 octets and for interaction with other IMAP\n   extensions.)\n   A quoted string is a sequence of zero or more Unicode characters,\n   excluding CR and LF, encoded in UTF-8, with double quote (<\">)\n   characters at each end.\n   The empty string is represented as \"\" (a quoted string with zero\n   characters between double quotes), as {0} followed by a CRLF (a\n   synchronizing literal with an octet count of 0), or as {0+} followed\n   by a CRLF (a non-synchronizing literal with an octet count of 0).\n      Note: Even if the octet count is 0, a client transmitting a\n      synchronizing literal MUST wait to receive a command continuation\n      request.\n4.3.1.  8-Bit and Binary Strings\n   8-bit textual and binary mail is supported through the use of a\n   [MIME-IMB] content transfer encoding.  IMAP4rev2 implementations MAY\n   transmit 8-bit or multi-octet characters in literals but SHOULD do so\n   only when the [CHARSET] is identified.\n   IMAP4rev2 is compatible with [I18N-HDRS].  As a result, the\n   identified charset for header-field values with 8-bit content is\n   UTF-8 [UTF-8].  IMAP4rev2 implementations MUST accept and MAY\n   transmit [UTF-8] text in quoted-strings as long as the string does\n   not contain NUL, CR, or LF.  This differs from IMAP4rev1\n   implementations.\n   Although a BINARY content transfer encoding is defined, unencoded\n   binary strings are not permitted, unless returned in a <literal8> in\n   response to a BINARY.PEEK[<section-binary>]<<partial>> or\n   BINARY[<section-binary>]<<partial>> FETCH data item.  A \"binary\n   string\" is any string with NUL characters.  A string with an\n   excessive amount of CTL characters MAY also be considered to be\n   binary.  Unless returned in response to BINARY.PEEK[...]/BINARY[...]\n   FETCH, client and server implementations MUST encode binary data into\n   a textual form, such as base64, before transmitting the data.\n4.4.  Parenthesized List\n   Data structures are represented as a \"parenthesized list\"; a sequence\n   of data items, delimited by space, and bounded at each end by\n   parentheses.  A parenthesized list can contain other parenthesized\n   lists, using multiple levels of parentheses to indicate nesting.\n   The empty list is represented as () -- a parenthesized list with no\n   members.\n4.5.  NIL\n   The special form \"NIL\" represents the non-existence of a particular\n   data item that is represented as a string or parenthesized list, as\n   distinct from the empty string \"\" or the empty parenthesized list ().\n      |  Note: NIL is never used for any data item that takes the form\n      |  of an atom.  For example, a mailbox name of \"NIL\" is a mailbox\n      |  named NIL as opposed to a non-existent mailbox name.  This is\n      |  because mailbox uses \"astring\" syntax, which is an atom or a\n      |  string.  Conversely, an addr-name of NIL is a non-existent\n      |  personal name, because addr-name uses \"nstring\" syntax, which\n      |  is NIL or a string, but never an atom.\n   Examples:\n   The following LIST response:\n     * LIST () \"/\" NIL\n   is equivalent to:\n     * LIST () \"/\" \"NIL\"\n   as LIST response ABNF is using \"astring\" for mailbox name.\n   However, the following response:\n     * FETCH 1 (BODY[1] NIL)\n   is not equivalent to:\n     * FETCH 1 (BODY[1] \"NIL\")\n   The former indicates absence of the body part, while the latter means\n   that it contains a string with the three characters \"NIL\".\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"ready\", \"waiting_continuation\"],\n  \"transitions\": [\n    {\n      \"from\": \"ready\",\n      \"event\": \"send_sync_literal\",\n      \"action\": \"send_literal_header\",\n      \"to\": \"waiting_continuation\"\n    },\n    {\n      \"from\": \"waiting_continuation\",\n      \"event\": \"receive_continuation\",\n      \"action\": \"send_data\",\n      \"to\": \"ready\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 5. Operational Considerations",
      "prompt": "\nYou will be given the section \"Section 5. Operational Considerations\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nThe following rules are listed here to ensure that all IMAP4rev2\n   implementations interoperate properly.\n5.1.  Mailbox Naming\n   In IMAP4rev2, mailbox names are encoded in Net-Unicode [NET-UNICODE]\n   (this differs from IMAP4rev1).  Client implementations MAY attempt to\n   create Net-Unicode mailbox names and MUST interpret any 8-bit mailbox\n   names returned by LIST as [NET-UNICODE].  Server implementations MUST\n   prohibit the creation of 8-bit mailbox names that do not comply with\n   Net-Unicode.  However, servers MAY accept a denormalized UTF-8\n   mailbox name and convert it to Unicode Normalization Form C (NFC) (as\n   per Net-Unicode requirements) prior to mailbox creation.  Servers\n   that choose to accept such denormalized UTF-8 mailbox names MUST\n   accept them in all IMAP commands that have a mailbox name parameter.\n   In particular, SELECT <name> must open the same mailbox that was\n   successfully created with CREATE <name>, even if <name> is a\n   denormalized UTF-8 mailbox name.\n   The case-insensitive mailbox name INBOX is a special name reserved to\n   mean \"the primary mailbox for this user on this server\".  (Note that\n   this special name might not exist on some servers for some users, for\n   example, if the user has no access to personal namespace.)  The\n   interpretation of all other names is implementation dependent.\n   In particular, this specification takes no position on case\n   sensitivity in non-INBOX mailbox names.  Some server implementations\n   are fully case sensitive in ASCII range; others preserve the case of\n   a newly created name but otherwise are case insensitive; and yet\n   others coerce names to a particular case.  Client implementations\n   must be able to interact with any of these.\n   There are certain client considerations when creating a new mailbox\n   name:\n   1.  Any character that is one of the atom-specials (see \"Formal\n       Syntax\" in Section 9) will require that the mailbox name be\n       represented as a quoted string or literal.\n   2.  CTL and other non-graphic characters are difficult to represent\n       in a user interface and are best avoided.  Servers MAY refuse to\n       create mailbox names containing Unicode CTL characters.\n   3.  Although the list-wildcard characters (\"%\" and \"*\") are valid in\n       a mailbox name, it is difficult to use such mailbox names with\n       the LIST command due to the conflict with wildcard\n       interpretation.\n   4.  Usually, a character (determined by the server implementation) is\n       reserved to delimit levels of hierarchy.\n   5.  Two characters, \"#\" and \"&\", have meanings by convention and\n       should be avoided except when used in that convention.  See\n       Section 5.1.2.1 and Appendix A.1, respectively.\n5.1.1.  Mailbox Hierarchy Naming\n   If it is desired to export hierarchical mailbox names, mailbox names\n   MUST be left-to-right hierarchical, using a single ASCII character to\n   separate levels of hierarchy.  The same hierarchy separator character\n   is used for all levels of hierarchy within a single name.\n5.1.2.  Namespaces\n   Personal Namespace:\n      A namespace that the server considers within the personal scope of\n      the authenticated user on a particular connection.  Typically,\n      only the authenticated user has access to mailboxes in their\n      Personal Namespace.  It is the part of the namespace that belongs\n      to the user and is allocated for mailboxes.  If an INBOX exists\n      for a user, it MUST appear within the user's Personal Namespace.\n      In the typical case, there SHOULD be only one Personal Namespace\n      per user on a server.\n   Other Users' Namespace:\n      A namespace that consists of mailboxes from the Personal\n      Namespaces of other users.  To access mailboxes in the Other\n      Users' Namespace, the currently authenticated user MUST be\n      explicitly granted access rights.  For example, it is common for a\n      manager to grant to their administrative support staff access\n      rights to their mailbox.  In the typical case, there SHOULD be\n      only one Other Users' Namespace per user on a server.\n   Shared Namespace:\n      A namespace that consists of mailboxes that are intended to be\n      shared amongst users and do not exist within a user's Personal\n      Namespace.\n   The namespaces a server uses MAY differ on a per-user basis.\n5.1.2.1.  Historic Mailbox Namespace Naming Convention\n   By convention, the first hierarchical element of any mailbox name\n   that begins with \"#\" identifies the \"namespace\" of the remainder of\n   the name.  This makes it possible to disambiguate between different\n   types of mailbox stores, each of which have their own namespaces.\n      For example, implementations that offer access to USENET\n      newsgroups MAY use the \"#news\" namespace to partition the USENET\n      newsgroup namespace from that of other mailboxes.  Thus, the\n      comp.mail.misc newsgroup would have a mailbox name of\n      \"#news.comp.mail.misc\", and the name \"comp.mail.misc\" can refer to\n      a different object (e.g., a user's private mailbox).\n   Namespaces that include the \"#\" character are not IMAP URL [IMAP-URL]\n   friendly and require the \"#\" character to be represented as %23 when\n   within URLs.  As such, server implementors MAY instead consider using\n   namespace prefixes that do not contain the \"#\" character.\n5.1.2.2.  Common Namespace Models\n   The previous version of this protocol did not define a default server\n   namespace.  Two common namespace models have evolved:\n   The \"Personal Mailbox\" model, in which the default namespace that is\n   presented consists of only the user's personal mailboxes.  To access\n   shared mailboxes, the user must use an escape mechanism to reach\n   another namespace.\n   The \"Complete Hierarchy\" model, in which the default namespace that\n   is presented includes the user's personal mailboxes along with any\n   other mailboxes they have access to.\n5.2.  Mailbox Size and Message Status Updates\n   At any time, a server can send data that the client did not request.\n   Sometimes, such behavior is required by this specification and/or\n   extensions.  For example, agents other than the server may add\n   messages to the mailbox (e.g., new message delivery); change the\n   flags of the messages in the mailbox (e.g., simultaneous access to\n   the same mailbox by multiple agents); or even remove messages from\n   the mailbox.  A server MUST send mailbox size updates automatically\n   if a mailbox size change is observed during the processing of a\n   command.  A server SHOULD send message flag updates automatically,\n   without requiring the client to request such updates explicitly.\n   Special rules exist for server notification of a client about the\n   removal of messages to prevent synchronization errors; see the\n   description of the EXPUNGE response (Section 7.5.1) for more detail.\n   In particular, it is NOT permitted to send an EXISTS response that\n   would reduce the number of messages in the mailbox; only the EXPUNGE\n   response can do this.\n   Regardless of what implementation decisions a client makes on\n   remembering data from the server, a client implementation MUST\n   remember mailbox size updates.  It MUST NOT assume that any command\n   after the initial mailbox selection will return the size of the\n   mailbox.\n5.3.  Response When No Command in Progress\n   Server implementations are permitted to send an untagged response\n   (except for EXPUNGE) while there is no command in progress.  Server\n   implementations that send such responses MUST deal with flow control\n   considerations.  Specifically, they MUST either (1) verify that the\n   size of the data does not exceed the underlying transport's available\n   window size or (2) use non-blocking writes.\n5.4.  Autologout Timer\n   If a server has an inactivity autologout timer that applies to\n   sessions after authentication, the duration of that timer MUST be at\n   least 30 minutes.  The receipt of any command from the client during\n   that interval resets the autologout timer.\n   Note that this specification doesn't have any restrictions on an\n   autologout timer used before successful client authentication.  In\n   particular, servers are allowed to use a shortened pre-authentication\n   timer to protect themselves from Denial-of-Service attacks.\n5.5.  Multiple Commands in Progress (Command Pipelining)\n   The client MAY send another command without waiting for the\n   completion result response of a command, subject to ambiguity rules\n   (see below) and flow control constraints on the underlying data\n   stream.  Similarly, a server MAY begin processing another command\n   before processing the current command to completion, subject to\n   ambiguity rules.  However, any command continuation request responses\n   and command continuations MUST be negotiated before any subsequent\n   command is initiated.\n   The exception is if an ambiguity would result because of a command\n   that would affect the results of other commands.  If the server\n   detects a possible ambiguity, it MUST execute commands to completion\n   in the order given by the client.\n   The most obvious example of ambiguity is when a command would affect\n   the results of another command.  One example is a FETCH that would\n   cause \\Seen flags to be set and a SEARCH UNSEEN command.\n   A non-obvious ambiguity occurs with commands that permit an untagged\n   EXPUNGE response (commands other than FETCH, STORE, and SEARCH),\n   since an untagged EXPUNGE response can invalidate sequence numbers in\n   a subsequent command.  This is not a problem for FETCH, STORE, or\n   SEARCH commands because servers are prohibited from sending EXPUNGE\n   responses while any of those commands are in progress.  Therefore, if\n   the client sends any command other than FETCH, STORE, or SEARCH, it\n   MUST wait for the completion result response before sending a command\n   with message sequence numbers.\n      Note: EXPUNGE responses are permitted while UID FETCH, UID STORE,\n      and UID SEARCH are in progress.  If the client sends a UID\n      command, it MUST wait for a completion result response before\n      sending a command that uses message sequence numbers (this may\n      include UID SEARCH).  Any message sequence numbers in an argument\n      to UID SEARCH are associated with messages prior to the effect of\n      any untagged EXPUNGE responses returned by the UID SEARCH.\n   For example, the following non-waiting command sequences are invalid:\n      FETCH + NOOP + STORE\n      STORE + COPY + FETCH\n      COPY + COPY\n   The following are examples of valid non-waiting command sequences:\n      FETCH + STORE + SEARCH + NOOP\n      STORE + COPY + EXPUNGE\n   UID SEARCH + UID SEARCH may be valid or invalid as a non-waiting\n   command sequence, depending upon whether or not the second UID SEARCH\n   contains message sequence numbers.\n   Use of a SEARCH result variable (see Section 6.4.4.1) creates direct\n   dependency between two commands.  See Section 6.4.4.2 for more\n   considerations about pipelining such dependent commands.\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"Authenticated\", \"LoggedOut\"],\n  \"transitions\": [\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"timeout 30m\",\n      \"action\": \"close connection\",\n      \"to\": \"LoggedOut\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive any command\",\n      \"action\": \"reset timer\",\n      \"to\": \"Authenticated\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 6. Client Commands",
      "prompt": "\nYou will be given the section \"Section 6. Client Commands\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nIMAP4rev2 commands are described in this section.  Commands are\n   organized by the state in which the command is permitted.  Commands\n   that are permitted in multiple states are listed in the minimum\n   permitted state (for example, commands valid in authenticated and\n   selected states are listed in the authenticated state commands).\n   Command arguments, identified by \"Arguments:\" in the command\n   descriptions below, are described by function, not by syntax.  The\n   precise syntax of command arguments is described in \"Formal Syntax\"\n   (Section 9).\n   Some commands cause specific server responses to be returned; these\n   are identified by \"Responses:\" in the command descriptions below.\n   See the response descriptions in \"Responses\" (Section 7) for\n   information on these responses and in \"Formal Syntax\" (Section 9) for\n   the precise syntax of these responses.  It is possible for server\n   data to be transmitted as a result of any command.  Thus, commands\n   that do not specifically require server data specify \"no specific\n   responses for this command\" instead of \"none\".\n   The \"Result:\" in the command description refers to the possible\n   tagged status responses to a command and any special interpretation\n   of these status responses.\n   The state of a connection is only changed by successful commands that\n   are documented as changing state.  A rejected command (BAD response)\n   never changes the state of the connection or of the selected mailbox.\n   A failed command (NO response) generally does not change the state of\n   the connection or of the selected mailbox, with the exception of the\n   SELECT and EXAMINE commands.\n6.1.  Client Commands - Any State\n   The following commands are valid in any state: CAPABILITY, NOOP, and\n   LOGOUT.\n6.1.1.  CAPABILITY Command\n   Arguments:    none\n   Responses:    REQUIRED untagged response:  CAPABILITY\n   Result:       OK -  capability completed\n                 BAD -  arguments invalid\n   The CAPABILITY command requests a listing of capabilities (e.g.,\n   extensions and/or modifications of server behavior) that the server\n   supports.  The server MUST send a single untagged CAPABILITY response\n   with \"IMAP4rev2\" as one of the listed capabilities before the\n   (tagged) OK response.\n   A capability name that begins with \"AUTH=\" indicates that the server\n   supports that particular authentication mechanism as defined in the\n   Simple Authentication and Security Layer (SASL) [SASL].  All such\n   names are, by definition, part of this specification.\n   Other capability names refer to extensions, revisions, or amendments\n   to this specification.  See the documentation of the CAPABILITY\n   response in Section 7.2.2 for additional information.  If IMAP4rev1\n   capability is not advertised, no capabilities, beyond the base\n   IMAP4rev2 set defined in this specification, are enabled without\n   explicit client action to invoke the capability.  If both IMAP4rev1\n   and IMAP4rev2 capabilities are advertised, no capabilities, beyond\n   the base IMAP4rev1 set specified in [RFC3501], are enabled without\n   explicit client action to invoke the capability.\n   Client and server implementations MUST implement the STARTTLS\n   (Section 6.2.1) and LOGINDISABLED capabilities on cleartext ports.\n   Client and server implementations MUST also implement AUTH=PLAIN\n   (described in [PLAIN]) capability on both cleartext and Implicit TLS\n   ports.  See the Security Considerations (Section 11) for important\n   information.\n   Unless otherwise specified, all registered extensions to IMAP4rev1\n   are also valid extensions to IMAP4rev2.\n   Example:\n     C: abcd CAPABILITY\n     S: * CAPABILITY IMAP4rev2 STARTTLS AUTH=GSSAPI\n      LOGINDISABLED\n     S: abcd OK CAPABILITY completed\n     C: efgh STARTTLS\n     S: efgh OK STARTTLS completed\n     <TLS negotiation, further commands are under TLS layer>\n     C: ijkl CAPABILITY\n     S: * CAPABILITY IMAP4rev2 AUTH=GSSAPI AUTH=PLAIN\n     S: ijkl OK CAPABILITY completed\n6.1.2.  NOOP Command\n   Arguments:    none\n   Responses:    no specific responses for this command (but see below)\n   Result:       OK -  noop completed\n                 BAD -  command unknown or arguments invalid\n   The NOOP command always succeeds.  It does nothing.\n   Since any command can return a status update as untagged data, the\n   NOOP command can be used as a periodic poll for new messages or\n   message status updates during a period of inactivity (the IDLE\n   command; see Section 6.3.13) should be used instead of NOOP if real-\n   time updates to mailbox state are desirable).  The NOOP command can\n   also be used to reset any inactivity autologout timer on the server.\n   Example:\n     C: a002 NOOP\n     S: a002 OK NOOP completed\n        . . .\n     C: a047 NOOP\n     S: * 22 EXPUNGE\n     S: * 23 EXISTS\n     S: * 14 FETCH (UID 1305 FLAGS (\\Seen \\Deleted))\n     S: a047 OK NOOP completed\n6.1.3.  LOGOUT Command\n   Arguments:    none\n   Responses:    REQUIRED untagged response:  BYE\n   Result:       OK -  logout completed\n                 BAD -  command unknown or arguments invalid\n   The LOGOUT command informs the server that the client is done with\n   the connection.  The server MUST send a BYE untagged response before\n   the (tagged) OK response, and then close the network connection.\n   Example:\n     C: A023 LOGOUT\n     S: * BYE IMAP4rev2 Server logging out\n     S: A023 OK LOGOUT completed\n     (Server and client then close the connection)\n6.2.  Client Commands - Not Authenticated State\n   In the not authenticated state, the AUTHENTICATE or LOGIN command\n   establishes authentication and enters the authenticated state.  The\n   AUTHENTICATE command provides a general mechanism for a variety of\n   authentication techniques, privacy protection, and integrity\n   checking, whereas the LOGIN command uses a conventional user name and\n   plaintext password pair and has no means of establishing privacy\n   protection or integrity checking.\n   The STARTTLS command is an alternative form of establishing session\n   privacy protection and integrity checking but does not by itself\n   establish authentication or enter the authenticated state.\n   Server implementations MAY allow access to certain mailboxes without\n   establishing authentication.  This can be done by means of the\n   ANONYMOUS [SASL] authenticator described in [ANONYMOUS].  An older\n   convention is a LOGIN command using the userid \"anonymous\"; in this\n   case, a password is required although the server may choose to accept\n   any password.  The restrictions placed on anonymous users are\n   implementation dependent.\n   Once authenticated (including as anonymous), it is not possible to\n   re-enter not authenticated state.\n   In addition to the universal commands (CAPABILITY, NOOP, and LOGOUT),\n   the following commands are valid in the not authenticated state:\n   STARTTLS, AUTHENTICATE, and LOGIN.  See the Security Considerations\n   (Section 11) for important information about these commands.\n6.2.1.  STARTTLS Command\n   Arguments:    none\n   Responses:    no specific response for this command\n   Result:       OK -  starttls completed, begin TLS negotiation\n                 NO -  TLS negotiation can't be initiated, due to server\n                    configuration error\n                 BAD -  STARTTLS received after a successful TLS\n                    negotiation or arguments invalid\n   Note that the STARTTLS command is available only on cleartext ports.\n   The server MUST always respond with a tagged BAD response when the\n   STARTTLS command is received on an Implicit TLS port.\n   A TLS [TLS-1.3] negotiation begins immediately after the CRLF at the\n   end of the tagged OK response from the server.  Once a client issues\n   a STARTTLS command, it MUST NOT issue further commands until a server\n   response is seen and the TLS negotiation is complete.  Some past\n   server implementations incorrectly implemented STARTTLS processing\n   and are known to contain STARTTLS plaintext command injection\n   vulnerability [CERT-555316].  In order to avoid this vulnerability,\n   server implementations MUST do one of the following if any data is\n   received in the same TCP buffer after the CRLF that starts the\n   STARTTLS command:\n   1.  Extra data from the TCP buffer is interpreted as the beginning of\n       the TLS handshake.  (If the data is in cleartext, this will\n       result in the TLS handshake failing.)\n   2.  Extra data from the TCP buffer is thrown away.\n   Note that the first option is friendlier to clients that pipeline the\n   beginning of the STARTTLS command with TLS handshake data.\n   After successful TLS negotiation, the server remains in the non-\n   authenticated state, even if client credentials are supplied during\n   the TLS negotiation.  This does not preclude an authentication\n   mechanism such as EXTERNAL (defined in [SASL]) from using client\n   identity determined by the TLS negotiation.\n   Once TLS has been started, the client MUST discard cached information\n   about server capabilities and SHOULD reissue the CAPABILITY command.\n   This is necessary to protect against active attacks that alter the\n   capabilities list prior to STARTTLS.  The server MAY advertise\n   different capabilities and, in particular, SHOULD NOT advertise the\n   STARTTLS capability, after a successful STARTTLS command.\n   Example:\n      C: a001 CAPABILITY\n      S: * CAPABILITY IMAP4rev2 STARTTLS LOGINDISABLED\n      S: a001 OK CAPABILITY completed\n      C: a002 STARTTLS\n      S: a002 OK Begin TLS negotiation now\n      <TLS negotiation, further commands are under TLS layer>\n      C: a003 CAPABILITY\n      S: * CAPABILITY IMAP4rev2 AUTH=PLAIN\n      S: a003 OK CAPABILITY completed\n      C: a004 AUTHENTICATE PLAIN dGVzdAB0ZXN0AHRlc3Q=\n      S: a004 OK Success (tls protection)\n6.2.2.  AUTHENTICATE Command\n   Arguments:    SASL authentication mechanism name\n                 OPTIONAL initial response\n   Responses:    continuation data can be requested\n   Result:       OK -  authenticate completed, now in authenticated\n                    state\n                 NO -  authenticate failure: unsupported authentication\n                    mechanism, credentials rejected\n                 BAD -  command unknown or arguments invalid,\n                    authentication exchange canceled\n   The AUTHENTICATE command indicates a [SASL] authentication mechanism\n   to the server.  If the server supports the requested authentication\n   mechanism, it performs an authentication protocol exchange to\n   authenticate and identify the client.  It MAY also negotiate an\n   OPTIONAL security layer for subsequent protocol interactions.  If the\n   requested authentication mechanism is not supported, the server\n   SHOULD reject the AUTHENTICATE command by sending a tagged NO\n   response.\n   The AUTHENTICATE command supports the optional \"initial response\"\n   feature defined in Section 4 of [SASL].  The client doesn't need to\n   use it.  If a SASL mechanism supports \"initial response\", but it is\n   not specified by the client, the server handles it as specified in\n   Section 3 of [SASL].\n   The service name specified by this protocol's profile of [SASL] is\n   \"imap\".\n   The authentication protocol exchange consists of a series of server\n   challenges and client responses that are specific to the\n   authentication mechanism.  A server challenge consists of a command\n   continuation request response with the \"+\" token followed by a\n   base64-encoded (see Section 4 of [RFC4648]) string.  The client\n   response consists of a single line consisting of a base64-encoded\n   string.  If the client wishes to cancel an authentication exchange,\n   it issues a line consisting of a single \"*\".  If the server receives\n   such a response, or if it receives an invalid base64 string (e.g.,\n   characters outside the base64 alphabet or non-terminal \"=\"), it MUST\n   reject the AUTHENTICATE command by sending a tagged BAD response.\n   As with any other client response, the initial response MUST be\n   encoded as base64.  It also MUST be transmitted outside of a quoted\n   string or literal.  To send a zero-length initial response, the\n   client MUST send a single pad character (\"=\").  This indicates that\n   the response is present, but it is a zero-length string.\n   When decoding the base64 data in the initial response, decoding\n   errors MUST be treated as in any normal SASL client response, i.e.,\n   with a tagged BAD response.  In particular, the server should check\n   for any characters not explicitly allowed by the base64 alphabet, as\n   well as any sequence of base64 characters that contains the pad\n   character ('=') anywhere other than the end of the string (e.g.,\n   \"=AAA\" and \"AAA=BBB\" are not allowed).\n   If the client uses an initial response with a SASL mechanism that\n   does not support an initial response, the server MUST reject the\n   command with a tagged BAD response.\n   If a security layer is negotiated through the [SASL] authentication\n   exchange, it takes effect immediately following the CRLF that\n   concludes the authentication exchange for the client and the CRLF of\n   the tagged OK response for the server.\n   While client and server implementations MUST implement the\n   AUTHENTICATE command itself, it is not required to implement any\n   authentication mechanisms other than the PLAIN mechanism described in\n   [PLAIN].  Also, an authentication mechanism is not required to\n   support any security layers.\n      Note: a server implementation MUST implement a configuration in\n      which it does NOT permit any plaintext password mechanisms, unless\n      the STARTTLS command has been negotiated, TLS has been negotiated\n      on an Implicit TLS port, or some other mechanism that protects the\n      session from password snooping has been provided.  Server sites\n      SHOULD NOT use any configuration that permits a plaintext password\n      mechanism without such a protection mechanism against password\n      snooping.  Client and server implementations SHOULD implement\n      additional [SASL] mechanisms that do not use plaintext passwords,\n      such as the GSSAPI mechanism described in [RFC4752], the SCRAM-\n      SHA-256/SCRAM-SHA-256-PLUS [SCRAM-SHA-256] mechanisms, and/or the\n      EXTERNAL [SASL] mechanism for mutual TLS authentication.  (Note\n      that the SASL framework allows for the creation of SASL mechanisms\n      that support 2-factor authentication (2FA); however, none are\n      fully ready to be recommended by this document.)\n   Servers and clients can support multiple authentication mechanisms.\n   The server SHOULD list its supported authentication mechanisms in the\n   response to the CAPABILITY command so that the client knows which\n   authentication mechanisms to use.\n   A server MAY include a CAPABILITY response code in the tagged OK\n   response of a successful AUTHENTICATE command in order to send\n   capabilities automatically.  It is unnecessary for a client to send a\n   separate CAPABILITY command if it recognizes these automatic\n   capabilities.  This should only be done if a security layer was not\n   negotiated by the AUTHENTICATE command, because the tagged OK\n   response as part of an AUTHENTICATE command is not protected by\n   encryption/integrity checking.  [SASL] requires the client to re-\n   issue a CAPABILITY command in this case.  The server MAY advertise\n   different capabilities after a successful AUTHENTICATE command.\n   If an AUTHENTICATE command fails with a NO response, the client MAY\n   try another authentication mechanism by issuing another AUTHENTICATE\n   command.  It MAY also attempt to authenticate by using the LOGIN\n   command (see Section 6.2.3 for more detail).  In other words, the\n   client MAY request authentication types in decreasing order of\n   preference, with the LOGIN command as a last resort.\n   The authorization identity passed from the client to the server\n   during the authentication exchange is interpreted by the server as\n   the user name whose privileges the client is requesting.\n   Example:\n     S: * OK [CAPABILITY IMAP4rev2 STARTTLS AUTH=GSSAPI]\n      Capabilities\n     C: A001 AUTHENTICATE GSSAPI\n     S: +\n     C: YIIB+wYJKoZIhvcSAQICAQBuggHqMIIB5qADAgEFoQMCAQ6iBw\n        MFACAAAACjggEmYYIBIjCCAR6gAwIBBaESGxB1Lndhc2hpbmd0\n        b24uZWR1oi0wK6ADAgEDoSQwIhsEaW1hcBsac2hpdmFtcy5jYW\n        Mud2FzaGluZ3Rvbi5lZHWjgdMwgdCgAwIBAaEDAgEDooHDBIHA\n        cS1GSa5b+fXnPZNmXB9SjL8Ollj2SKyb+3S0iXMljen/jNkpJX\n        AleKTz6BQPzj8duz8EtoOuNfKgweViyn/9B9bccy1uuAE2HI0y\n        C/PHXNNU9ZrBziJ8Lm0tTNc98kUpjXnHZhsMcz5Mx2GR6dGknb\n        I0iaGcRerMUsWOuBmKKKRmVMMdR9T3EZdpqsBd7jZCNMWotjhi\n        vd5zovQlFqQ2Wjc2+y46vKP/iXxWIuQJuDiisyXF0Y8+5GTpAL\n        pHDc1/pIGmMIGjoAMCAQGigZsEgZg2on5mSuxoDHEA1w9bcW9n\n        FdFxDKpdrQhVGVRDIzcCMCTzvUboqb5KjY1NJKJsfjRQiBYBdE\n        NKfzK+g5DlV8nrw81uOcP8NOQCLR5XkoMHC0Dr/80ziQzbNqhx\n        O6652Npft0LQwJvenwDI13YxpwOdMXzkWZN/XrEqOWp6GCgXTB\n        vCyLWLlWnbaUkZdEYbKHBPjd8t/1x5Yg==\n     S: + YGgGCSqGSIb3EgECAgIAb1kwV6ADAgEFoQMCAQ+iSzBJoAMC\n        AQGiQgRAtHTEuOP2BXb9sBYFR4SJlDZxmg39IxmRBOhXRKdDA0\n        uHTCOT9Bq3OsUTXUlk0CsFLoa8j+gvGDlgHuqzWHPSQg==\n     C:\n     S: + YDMGCSqGSIb3EgECAgIBAAD/////6jcyG4GE3KkTzBeBiVHe\n        ceP2CWY0SR0fAQAgAAQEBAQ=\n     C: YDMGCSqGSIb3EgECAgIBAAD/////3LQBHXTpFfZgrejpLlLImP\n        wkhbfa2QteAQAgAG1yYwE=\n     S: A001 OK GSSAPI authentication successful\n   The following example demonstrates the use of an initial response.\n   Example:\n     S: * OK [CAPABILITY IMAP4rev2 STARTTLS AUTH=GSSAPI\n      LOGINDISABLED] Server ready\n     C: A01 STARTTLS\n     S: A01 OK STARTTLS completed\n     <TLS negotiation, further commands are under TLS layer>\n     C: A02 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 AUTH=GSSAPI AUTH=PLAIN\n     S: A02 OK CAPABILITY completed\n     C: A03 AUTHENTICATE PLAIN dGVzdAB0ZXN0AHRlc3Q=\n     S: A03 OK Success (tls protection)\n   Note that because the initial response is optional, the following\n   negotiation (which does not use the initial response) is still valid\n   and MUST be supported by the server:\n     ... client connects to server and negotiates a TLS\n         protection layer ...\n     C: C01 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 AUTH=PLAIN\n     S: C01 OK Completed\n     C: A01 AUTHENTICATE PLAIN\n     S: +\n     C: dGVzdAB0ZXN0AHRlc3Q=\n     S: A01 OK Success (tls protection)\n   Note that in the above example there is a space following the \"+\"\n   from the server.\n   The following is an example authentication using the SASL EXTERNAL\n   mechanism (defined in [SASL]) under a TLS protection layer and an\n   empty initial response:\n     ... client connects to server and negotiates a TLS\n         protection layer ...\n     C: C01 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 AUTH=PLAIN AUTH=EXTERNAL\n     S: C01 OK Completed\n     C: A01 AUTHENTICATE EXTERNAL =\n     S: A01 OK Success (tls protection)\n   Note: The line breaks within server challenges and client responses\n   are for editorial clarity and are not in real authenticators.\n6.2.3.  LOGIN Command\n   Arguments:    user name\n                 password\n   Responses:    no specific responses for this command\n   Result:       OK -  login completed, now in authenticated state\n                 NO -  login failure: user name or password rejected\n                 BAD -  command unknown or arguments invalid\n   The LOGIN command identifies the client to the server and carries the\n   plaintext password authenticating this user.  The LOGIN command\n   SHOULD NOT be used except as a last resort (after attempting and\n   failing to authenticate using the AUTHENTICATE command one or more\n   times), and it is recommended that client implementations have a\n   means to disable any automatic use of the LOGIN command.\n   A server MAY include a CAPABILITY response code in the tagged OK\n   response to a successful LOGIN command in order to send capabilities\n   automatically.  It is unnecessary for a client to send a separate\n   CAPABILITY command if it recognizes these automatic capabilities.\n   Example:\n     C: a001 LOGIN SMITH SESAME\n     S: a001 OK LOGIN completed\n   Note: Use of the LOGIN command over an insecure network (such as the\n   Internet) is a security risk, because anyone monitoring network\n   traffic can obtain plaintext passwords.  For that reason, clients\n   MUST NOT use LOGIN on unsecure networks.\n   Unless the client is accessing IMAP service on an Implicit TLS port\n   [RFC8314], the STARTTLS command has been negotiated, or some other\n   mechanism that protects the session from password snooping has been\n   provided, a server implementation MUST implement a configuration in\n   which it advertises the LOGINDISABLED capability and does NOT permit\n   the LOGIN command.  Server sites SHOULD NOT use any configuration\n   that permits the LOGIN command without such a protection mechanism\n   against password snooping.  A client implementation MUST NOT send a\n   LOGIN command if the LOGINDISABLED capability is advertised.\n6.3.  Client Commands - Authenticated State\n   In the authenticated state, commands that manipulate mailboxes as\n   atomic entities are permitted.  Of these commands, SELECT and EXAMINE\n   will select a mailbox for access and enter the selected state.\n   In addition to the universal commands (CAPABILITY, NOOP, and LOGOUT),\n   the following commands are valid in the authenticated state: ENABLE,\n   SELECT, EXAMINE, NAMESPACE, CREATE, DELETE, RENAME, SUBSCRIBE,\n   UNSUBSCRIBE, LIST, STATUS, APPEND, and IDLE.\n6.3.1.  ENABLE Command\n   Arguments:    capability names\n   Responses:    no specific responses for this command\n   Result:       OK -  Relevant capabilities enabled\n                 BAD -  No arguments, or syntax error in an argument\n   Several IMAP extensions allow the server to return unsolicited\n   responses specific to these extensions in certain circumstances.\n   However, servers cannot send those unsolicited responses (with the\n   exception of response codes (see Section 7.1) included in tagged or\n   untagged OK/NO/BAD responses, which can always be sent) until they\n   know that the clients support such extensions and thus will be able\n   to correctly parse and process the extension response data.\n   The ENABLE command provides an explicit indication from the client\n   that it supports particular extensions.  It is designed such that the\n   client can send a simple constant string with the extensions it\n   supports, and the server will enable the shared subset that both\n   support.\n   The ENABLE command takes a list of capability names and requests the\n   server to enable the named extensions.  Once enabled using ENABLE,\n   each extension remains active until the IMAP connection is closed.\n   For each argument, the server does the following:\n   *  If the argument is not an extension known to the server, the\n      server MUST ignore the argument.\n   *  If the argument is an extension known to the server, and it is not\n      specifically permitted to be enabled using ENABLE, the server MUST\n      ignore the argument.  (Note that knowing about an extension\n      doesn't necessarily imply supporting that extension.)\n   *  If the argument is an extension that is supported by the server\n      and that needs to be enabled, the server MUST enable the extension\n      for the duration of the connection.  Note that once an extension\n      is enabled, there is no way to disable it.\n   If the ENABLE command is successful, the server MUST send an untagged\n   ENABLED response (Section 7.2.1), which includes all enabled\n   extensions as specified above.  The ENABLED response is sent even if\n   no extensions were enabled.\n   Clients SHOULD only include extensions that need to be enabled by the\n   server.  For example, a client can enable IMAP4rev2-specific behavior\n   when both IMAP4rev1 and IMAP4rev2 are advertised in the CAPABILITY\n   response.  Future RFCs may add to this list.\n   The ENABLE command is only valid in the authenticated state, before\n   any mailbox is selected.  Clients MUST NOT issue ENABLE once they\n   SELECT/EXAMINE a mailbox; however, server implementations don't have\n   to check that no mailbox is selected or was previously selected\n   during the duration of a connection.\n   The ENABLE command can be issued multiple times in a session.  It is\n   additive; that is, \"ENABLE a b\", followed by \"ENABLE c\", is the same\n   as a single command \"ENABLE a b c\".  When multiple ENABLE commands\n   are issued, each corresponding ENABLED response SHOULD only contain\n   extensions enabled by the corresponding ENABLE command, i.e., for the\n   above example, the ENABLED response to \"ENABLE c\" should not contain\n   \"a\" or \"b\".\n   There are no limitations on pipelining ENABLE.  For example, it is\n   possible to send ENABLE and then immediately SELECT, or a LOGIN\n   immediately followed by ENABLE.\n   The server MUST NOT change the CAPABILITY list as a result of\n   executing ENABLE; that is, a CAPABILITY command issued right after an\n   ENABLE command MUST list the same capabilities as a CAPABILITY\n   command issued before the ENABLE command.  This is demonstrated in\n   the following example.  Note that below \"X-GOOD-IDEA\" is a fictitious\n   extension capability that can be ENABLED.\n     C: t1 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 ID LITERAL+ X-GOOD-IDEA\n     S: t1 OK foo\n     C: t2 ENABLE CONDSTORE X-GOOD-IDEA\n     S: * ENABLED X-GOOD-IDEA\n     S: t2 OK foo\n     C: t3 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 ID LITERAL+ X-GOOD-IDEA\n     S: t3 OK foo again\n   In the following example, the client enables the Conditional Store\n   (CONDSTORE) extension [RFC7162]:\n     C: a1 ENABLE CONDSTORE\n     S: * ENABLED CONDSTORE\n     S: a1 OK Conditional Store enabled\n6.3.1.1.  Note to Designers of Extensions That May Use the ENABLE\n          Command\n   Designers of IMAP extensions are discouraged from creating extensions\n   that require ENABLE unless there is no good alternative design.\n   Specifically, extensions that cause potentially incompatible behavior\n   changes to deployed server responses (and thus benefit from ENABLE)\n   have a higher complexity cost than extensions that do not.\n6.3.2.  SELECT Command\n   Arguments:    mailbox name\n   Responses:    REQUIRED untagged responses:  FLAGS, EXISTS, LIST\n                 REQUIRED OK untagged responses:  PERMANENTFLAGS,\n                    UIDNEXT, UIDVALIDITY\n   Result:       OK -  select completed, now in selected state\n                 NO -  select failure, now in authenticated state: no\n                    such mailbox, can't access mailbox\n                 BAD -  command unknown or arguments invalid\n   The SELECT command selects a mailbox so that messages in the mailbox\n   can be accessed.  Before returning an OK to the client, the server\n   MUST send the following untagged data to the client.  (The order of\n   individual responses is not important.)  Note that earlier versions\n   of this protocol, such as the IMAP4rev1 version specified in\n   [RFC2060], only required the FLAGS and EXISTS untagged responses and\n   UIDVALIDITY response code.  Client implementations that need to\n   remain compatible with such older IMAP versions have to implement\n   default behavior for missing data, as discussed with the individual\n   items.\n   FLAGS\n      Defined flags in the mailbox.  See the description of the FLAGS\n      response in Section 7.3.5 for more detail.\n   <n> EXISTS\n      The number of messages in the mailbox.  See the description of the\n      EXISTS response in Section 7.4.1 for more detail.\n   LIST\n      The server MUST return a LIST response with the mailbox name.  The\n      list of mailbox attributes MUST be accurate.  If the server allows\n      denormalized UTF-8 mailbox names (see Section 5.1) and the\n      supplied mailbox name differs from the normalized version, the\n      server MUST return LIST with the OLDNAME extended data item.  See\n      Section 6.3.9.7 for more details.\n   OK [PERMANENTFLAGS (<list of flags>)]\n      A list of message flags that the client can change permanently.\n      If this is missing, the client should assume that all flags can be\n      changed permanently.\n   OK [UIDNEXT <n>]\n      The next unique identifier value.  Refer to Section 2.3.1.1 for\n      more information.\n   OK [UIDVALIDITY <n>]\n      The unique identifier validity value.  Refer to Section 2.3.1.1\n      for more information.\n   Only one mailbox can be selected at a time in a connection;\n   simultaneous access to multiple mailboxes requires multiple\n   connections.  The SELECT command automatically deselects any\n   currently selected mailbox before attempting the new selection.\n   Consequently, if a mailbox is selected and a SELECT command that\n   fails is attempted, no mailbox is selected.  When deselecting a\n   selected mailbox, the server MUST return an untagged OK response with\n   the \"[CLOSED]\" response code when the currently selected mailbox is\n   closed (see Section 7.1).\n   If the client is permitted to modify the mailbox, the server SHOULD\n   prefix the text of the tagged OK response with the \"[READ-WRITE]\"\n   response code.\n   If the client is not permitted to modify the mailbox but is permitted\n   read access, the mailbox is selected as read-only, and the server\n   MUST prefix the text of the tagged OK response to SELECT with the\n   \"[READ-ONLY]\" response code.  Read-only access through SELECT differs\n   from the EXAMINE command in that certain read-only mailboxes MAY\n   permit the change of permanent state on a per-user (as opposed to\n   global) basis.  Netnews messages marked in a server-based .newsrc\n   file are an example of such per-user permanent state that can be\n   modified with read-only mailboxes.\n   Example:\n     C: A142 SELECT INBOX\n     S: * 172 EXISTS\n     S: * OK [UIDVALIDITY 3857529045] UIDs valid\n     S: * OK [UIDNEXT 4392] Predicted next UID\n     S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n     S: * OK [PERMANENTFLAGS (\\Deleted \\Seen \\*)] Limited\n     S: * LIST () \"/\" INBOX\n     S: A142 OK [READ-WRITE] SELECT completed\n   Example:\n     C: A142 SELECT INBOX\n     S: * 172 EXISTS\n     S: * OK [UIDVALIDITY 3857529045] UIDs valid\n     S: * OK [UIDNEXT 4392] Predicted next UID\n     S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n     S: * OK [PERMANENTFLAGS (\\Deleted \\Seen \\*)] Limited\n     S: A142 OK [READ-WRITE] SELECT completed\n     [...some time later...]\n     C: A143 SELECT Drafts\n     S: * OK [CLOSED] Previous mailbox is now closed\n     S: * 5 EXISTS\n     S: * OK [UIDVALIDITY 9877410381] UIDs valid\n     S: * OK [UIDNEXT 102] Predicted next UID\n     S: * LIST () \"/\" Drafts\n     S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n     S: * OK [PERMANENTFLAGS (\\Deleted \\Seen \\Answered\n         \\Flagged \\Draft \\*)] System flags and keywords allowed\n     S: A143 OK [READ-WRITE] SELECT completed\n   Note that IMAP4rev1-compliant servers can also send the untagged\n   RECENT response that was deprecated in IMAP4rev2, e.g., \"* 0 RECENT\".\n   Pure IMAP4rev2 clients are advised to ignore the untagged RECENT\n   response.\n6.3.3.  EXAMINE Command\n   Arguments:    mailbox name\n   Responses:    REQUIRED untagged responses:  FLAGS, EXISTS, LIST\n                 REQUIRED OK untagged responses:  PERMANENTFLAGS,\n                    UIDNEXT, UIDVALIDITY\n   Result:       OK -  examine completed, now in selected state\n                 NO -  examine failure, now in authenticated state: no\n                    such mailbox, can't access mailbox\n                 BAD -  command unknown or arguments invalid\n   The EXAMINE command is identical to SELECT and returns the same\n   output; however, the selected mailbox is identified as read-only.  No\n   changes to the permanent state of the mailbox, including per-user\n   state, are permitted.\n   The text of the tagged OK response to the EXAMINE command MUST begin\n   with the \"[READ-ONLY]\" response code.\n   Example:\n      C: A932 EXAMINE blurdybloop\n      S: * 17 EXISTS\n      S: * OK [UIDVALIDITY 3857529045] UIDs valid\n      S: * OK [UIDNEXT 4392] Predicted next UID\n      S: * LIST () \"/\" blurdybloop\n      S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n      S: * OK [PERMANENTFLAGS ()] No permanent flags permitted\n      S: A932 OK [READ-ONLY] EXAMINE completed\n6.3.4.  CREATE Command\n   Arguments:    mailbox name\n   Responses:    OPTIONAL untagged response:  LIST\n   Result:       OK -  create completed\n                 NO -  create failure: can't create mailbox with that\n                    name\n                 BAD -  command unknown or arguments invalid\n   The CREATE command creates a mailbox with the given name.  An OK\n   response is returned only if a new mailbox with that name has been\n   created.  It is an error to attempt to create INBOX or a mailbox with\n   a name that refers to an extant mailbox.  Any error in creation will\n   return a tagged NO response.  If a client attempts to create a UTF-8\n   mailbox name that is not a valid Net-Unicode name, the server MUST\n   reject the creation or convert the name to Net-Unicode prior to\n   creating the mailbox.  If the server decides to convert (normalize)\n   the name, it SHOULD return an untagged LIST with an OLDNAME extended\n   data item, with the OLDNAME value being the supplied mailbox name and\n   the name parameter being the normalized mailbox name.  (See\n   Section 6.3.9.7 for more details.)\n   Mailboxes created in one IMAP session MAY be announced to other IMAP\n   sessions using an unsolicited LIST response.  If the server\n   automatically subscribes a mailbox when it is created, then the\n   unsolicited LIST response for each affected subscribed mailbox name\n   MUST include the \\Subscribed attribute.\n   If the mailbox name is suffixed with the server's hierarchy separator\n   character (as returned from the server by a LIST command), this is a\n   declaration that the client intends to create mailbox names under\n   this name in the hierarchy.  Server implementations that do not\n   require this declaration MUST ignore the declaration.  In any case,\n   the name created is without the trailing hierarchy delimiter.\n   If the server's hierarchy separator character appears elsewhere in\n   the name, the server SHOULD create any superior hierarchical names\n   that are needed for the CREATE command to be successfully completed.\n   In other words, an attempt to create \"foo/bar/zap\" on a server in\n   which \"/\" is the hierarchy separator character SHOULD create foo/ and\n   foo/bar/ if they do not already exist.\n   If a new mailbox is created with the same name as a mailbox that was\n   deleted, its unique identifiers MUST be greater than any unique\n   identifiers used in the previous incarnation of the mailbox unless\n   the new incarnation has a different unique identifier validity value.\n   See the description of the UID command in Section 6.4.9 for more\n   detail.\n   Example:\n     C: A003 CREATE owatagusiam/\n     S: A003 OK CREATE completed\n     C: A004 CREATE owatagusiam/blurdybloop\n     S: A004 OK CREATE completed\n     C: A005 CREATE NonNormalized\n     S: * LIST () \"/\" \"Normalized\" (\"OLDNAME\" (\"NonNormalized\"))\n     S: A005 OK CREATE completed\n   (In the last example, imagine that \"NonNormalized\" is a non-NFC\n   normalized Unicode mailbox name and that \"Normalized\" is its NFC\n   normalized version.)\n      |  Note: The interpretation of this example depends on whether \"/\"\n      |  was returned as the hierarchy separator from LIST.  If \"/\" is\n      |  the hierarchy separator, a new level of hierarchy named\n      |  \"owatagusiam\" with a member called \"blurdybloop\" is created.\n      |  Otherwise, two mailboxes at the same hierarchy level are\n      |  created.\n6.3.5.  DELETE Command\n   Arguments:    mailbox name\n   Responses:    OPTIONAL untagged response:  LIST\n   Result:       OK -  delete completed\n                 NO -  delete failure: can't delete mailbox with that\n                    name\n                 BAD -  command unknown or arguments invalid\n   The DELETE command permanently removes the mailbox with the given\n   name.  A tagged OK response is returned only if the mailbox has been\n   deleted.  It is an error to attempt to delete INBOX or a mailbox name\n   that does not exist.\n   The DELETE command MUST NOT remove inferior hierarchical names.  For\n   example, if a mailbox \"foo\" has an inferior \"foo.bar\" (assuming \".\"\n   is the hierarchy delimiter character), removing \"foo\" MUST NOT remove\n   \"foo.bar\".  It is an error to attempt to delete a name that has\n   inferior hierarchical names and also has the \\Noselect mailbox name\n   attribute (see the description of the LIST response (Section 7.3.1)\n   for more details).\n   It is permitted to delete a name that has inferior hierarchical names\n   and does not have the \\Noselect mailbox name attribute.  If the\n   server implementation does not permit deleting the name while\n   inferior hierarchical names exist, then it SHOULD disallow the DELETE\n   command by returning a tagged NO response.  The NO response SHOULD\n   include the HASCHILDREN response code.  Alternatively, the server MAY\n   allow the DELETE command, but it sets the \\Noselect mailbox name\n   attribute for that name.\n   If the server returns an OK response, all messages in that mailbox\n   are removed by the DELETE command.\n   The value of the highest-used unique identifier of the deleted\n   mailbox MUST be preserved so that a new mailbox created with the same\n   name will not reuse the identifiers of the former incarnation, unless\n   the new incarnation has a different unique identifier validity value.\n   See the description of the UID command in Section 6.4.9 for more\n   detail.\n   If the server decides to convert (normalize) the mailbox name, it\n   SHOULD return an untagged LIST with the \"\\NonExistent\" attribute and\n   OLDNAME extended data item, with the OLDNAME value being the supplied\n   mailbox name and the name parameter being the normalized mailbox\n   name.  (See Section 6.3.9.7 for more details.)\n   Mailboxes deleted in one IMAP session MAY be announced to other IMAP\n   sessions using an unsolicited LIST response, containing the\n   \"\\NonExistent\" attribute.\n   Example:\n     C: A682 LIST \"\" *\n     S: * LIST () \"/\" blurdybloop\n     S: * LIST (\\Noselect) \"/\" foo\n     S: * LIST () \"/\" foo/bar\n     S: A682 OK LIST completed\n     C: A683 DELETE blurdybloop\n     S: A683 OK DELETE completed\n     C: A684 DELETE foo\n     S: A684 NO Name \"foo\" has inferior hierarchical names\n     C: A685 DELETE foo/bar\n     S: A685 OK DELETE Completed\n     C: A686 LIST \"\" *\n     S: * LIST (\\Noselect) \"/\" foo\n     S: A686 OK LIST completed\n     C: A687 DELETE foo\n     S: A687 OK DELETE Completed\n   Example:\n     C: A82 LIST \"\" *\n     S: * LIST () \".\" blurdybloop\n     S: * LIST () \".\" foo\n     S: * LIST () \".\" foo.bar\n     S: A82 OK LIST completed\n     C: A83 DELETE blurdybloop\n     S: A83 OK DELETE completed\n     C: A84 DELETE foo\n     S: A84 OK DELETE Completed\n     C: A85 LIST \"\" *\n     S: * LIST () \".\" foo.bar\n     S: A85 OK LIST completed\n     C: A86 LIST \"\" %\n     S: * LIST (\\Noselect) \".\" foo\n     S: A86 OK LIST completed\n6.3.6.  RENAME Command\n   Arguments:    existing mailbox name\n                 new mailbox name\n   Responses:    OPTIONAL untagged response:  LIST\n   Result:       OK -  rename completed\n                 NO -  rename failure: can't rename mailbox with that\n                    name, can't rename to mailbox with that name\n                 BAD -  command unknown or arguments invalid\n   The RENAME command changes the name of a mailbox.  A tagged OK\n   response is returned only if the mailbox has been renamed.  It is an\n   error to attempt to rename from a mailbox name that does not exist or\n   to a mailbox name that already exists.  Any error in renaming will\n   return a tagged NO response.\n   If the name has inferior hierarchical names, then the inferior\n   hierarchical names MUST also be renamed.  For example, a rename of\n   \"foo\" to \"zap\" will rename \"foo/bar\" (assuming \"/\" is the hierarchy\n   delimiter character) to \"zap/bar\".\n   If the server's hierarchy separator character appears in the new\n   mailbox name, the server SHOULD create any superior hierarchical\n   names that are needed for the RENAME command to complete\n   successfully.  In other words, an attempt to rename \"foo/bar/zap\" to\n   \"baz/rag/zowie\" on a server in which \"/\" is the hierarchy separator\n   character in the corresponding namespace SHOULD create \"baz/\" and\n   \"baz/rag/\" if they do not already exist.\n   The value of the highest-used unique identifier of the old mailbox\n   name MUST be preserved so that a new mailbox created with the same\n   name will not reuse the identifiers of the former incarnation, unless\n   the new incarnation has a different unique identifier validity value.\n   See the description of the UID command in Section 6.4.9 for more\n   detail.\n   Renaming INBOX is permitted and does not result in a tagged BAD\n   response, and it has special behavior: It moves all messages in INBOX\n   to a new mailbox with the given name, leaving INBOX empty.  If the\n   server implementation supports inferior hierarchical names of INBOX,\n   these are unaffected by a rename of INBOX.  (Note that some servers\n   disallow renaming INBOX by returning a tagged NO response, so clients\n   need to be able to handle the failure of such RENAME commands.)\n   If the server allows creation of mailboxes with names that are not\n   valid Net-Unicode names, the server normalizes both the existing\n   mailbox name parameter and the new mailbox name parameter.  If the\n   normalized version of any of these 2 parameters differs from the\n   corresponding supplied version, the server SHOULD return an untagged\n   LIST response with an OLDNAME extended data item, with the OLDNAME\n   value being the supplied existing mailbox name and the name parameter\n   being the normalized new mailbox name (see Section 6.3.9.7).  This\n   would allow the client to correlate the supplied name with the\n   normalized name.\n   Mailboxes renamed in one IMAP session MAY be announced to other IMAP\n   sessions using an unsolicited LIST response with an OLDNAME extended\n   data item.\n   In both of the above cases, if the server automatically subscribes a\n   mailbox when it is renamed, then the unsolicited LIST response for\n   each affected subscribed mailbox name MUST include the \\Subscribed\n   attribute.  No unsolicited LIST responses need to be sent for child\n   mailboxes.  When INBOX is successfully renamed, it is assumed that a\n   new INBOX is created.  No unsolicited LIST responses need to be sent\n   for INBOX in this case.\n   Examples:\n     C: A682 LIST \"\" *\n     S: * LIST () \"/\" blurdybloop\n     S: * LIST (\\Noselect) \"/\" foo\n     S: * LIST () \"/\" foo/bar\n     S: A682 OK LIST completed\n     C: A683 RENAME blurdybloop sarasoop\n     S: A683 OK RENAME completed\n     C: A684 RENAME foo zowie\n     S: A684 OK RENAME Completed\n     C: A685 LIST \"\" *\n     S: * LIST () \"/\" sarasoop\n     S: * LIST (\\Noselect) \"/\" zowie\n     S: * LIST () \"/\" zowie/bar\n     S: A685 OK LIST completed\n     C: Z432 LIST \"\" *\n     S: * LIST () \".\" INBOX\n     S: * LIST () \".\" INBOX.bar\n     S: Z432 OK LIST completed\n     C: Z433 RENAME INBOX old-mail\n     S: Z433 OK RENAME completed\n     C: Z434 LIST \"\" *\n     S: * LIST () \".\" INBOX\n     S: * LIST () \".\" INBOX.bar\n     S: * LIST () \".\" old-mail\n     S: Z434 OK LIST completed\n   Note that renaming a mailbox doesn't update subscription information\n   on the original name.  To keep subscription information in sync, the\n   following sequence of commands can be used:\n     C: 1001 RENAME X Y\n     C: 1002 SUBSCRIBE Y\n     C: 1003 UNSUBSCRIBE X\n   Note that the above sequence of commands doesn't account for updating\n   the subscription for any child mailboxes of mailbox X.\n6.3.7.  SUBSCRIBE Command\n   Arguments:    mailbox\n   Responses:    no specific responses for this command\n   Result:       OK -  subscribe completed\n                 NO -  subscribe failure: can't subscribe to that name\n                 BAD -  command unknown or arguments invalid\n   The SUBSCRIBE command adds the specified mailbox name to the server's\n   set of \"active\" or \"subscribed\" mailboxes as returned by the LIST\n   (SUBSCRIBED) command.  This command returns a tagged OK response if\n   the subscription is successful or if the mailbox is already\n   subscribed.\n   A server MAY validate the mailbox argument to SUBSCRIBE to verify\n   that it exists.  However, it SHOULD NOT unilaterally remove an\n   existing mailbox name from the subscription list even if a mailbox by\n   that name no longer exists.\n      |  Note: This requirement is because a server site can choose to\n      |  routinely remove a mailbox with a well-known name (e.g.,\n      |  \"system-alerts\") after its contents expire, with the intention\n      |  of recreating it when new contents are appropriate.\n   Example:\n     C: A002 SUBSCRIBE #news.comp.mail.mime\n     S: A002 OK SUBSCRIBE completed\n6.3.8.  UNSUBSCRIBE Command\n   Arguments:    mailbox name\n   Responses:    no specific responses for this command\n   Result:       OK -  unsubscribe completed\n                 NO -  unsubscribe failure: can't unsubscribe that name\n                 BAD -  command unknown or arguments invalid\n   The UNSUBSCRIBE command removes the specified mailbox name from the\n   server's set of \"active\" or \"subscribed\" mailboxes as returned by the\n   LIST (SUBSCRIBED) command.  This command returns a tagged OK response\n   if the unsubscription is successful or if the mailbox is not\n   subscribed.\n   Example:\n     C: A002 UNSUBSCRIBE #news.comp.mail.mime\n     S: A002 OK UNSUBSCRIBE completed\n6.3.9.  LIST Command\n   Arguments (basic):\n                 reference name\n                 mailbox name with possible wildcards\n   Arguments (extended):\n                 selection options (OPTIONAL)\n                 reference name\n                 mailbox patterns\n                 return options (OPTIONAL)\n   Responses:    untagged responses: LIST\n   Result:       OK -  list completed\n                 NO -  list failure: can't list that reference or\n                    mailbox name\n                 BAD -  command unknown or arguments invalid\n   The LIST command returns a subset of mailbox names from the complete\n   set of all mailbox names available to the client.  Zero or more\n   untagged LIST responses are returned, containing the name attributes,\n   hierarchy delimiter, name, and possible extension information; see\n   the description of the LIST response (Section 7.3.1) for more detail.\n   The LIST command SHOULD return its data quickly, without undue delay.\n   For example, it should not go to excess trouble to calculate the\n   \\Marked or \\Unmarked status or perform other processing; if each name\n   requires 1 second of processing, then a list of 1200 names would take\n   20 minutes!\n   The extended LIST command, originally introduced in [RFC5258],\n   provides capabilities beyond that of the original IMAP LIST command.\n   The extended syntax is being used if one or more of the following\n   conditions is true:\n   1.  the first word after the command name begins with a parenthesis\n       (\"LIST selection options\");\n   2.  the second word after the command name begins with a parenthesis;\n       and\n   3.  the LIST command has more than 2 parameters (\"LIST return\n       options\").\n   An empty (\"\" string) reference name argument indicates that the\n   mailbox name is interpreted as by SELECT.  The returned mailbox names\n   MUST match the supplied mailbox name pattern(s).  A non-empty\n   reference name argument is the name of a mailbox or a level of\n   mailbox hierarchy, and it indicates the context in which the mailbox\n   name is interpreted.  Clients SHOULD use the empty reference\n   argument.\n   In the basic syntax only, an empty (\"\" string) mailbox name argument\n   is a special request to return the hierarchy delimiter and the root\n   name of the name given in the reference.  The value returned as the\n   root MAY be the empty string if the reference is non-rooted or is an\n   empty string.  In all cases, a hierarchy delimiter (or NIL if there\n   is no hierarchy) is returned.  This permits a client to get the\n   hierarchy delimiter (or find out that the mailbox names are flat)\n   even when no mailboxes by that name currently exist.\n   In the extended syntax, any mailbox name arguments that are empty\n   strings are ignored.  There is no special meaning for empty mailbox\n   names when the extended syntax is used.\n   The reference and mailbox name arguments are interpreted into a\n   canonical form that represents an unambiguous left-to-right\n   hierarchy.  The returned mailbox names will be in the interpreted\n   form, which we call a \"canonical LIST pattern\": the canonical pattern\n   constructed internally by the server from the reference and mailbox\n   name arguments.\n      Note: The interpretation of the reference argument is\n      implementation defined.  It depends on whether the server\n      implementation has a concept of the \"current working directory\"\n      and leading \"break out characters\", which override the current\n      working directory.\n      For example, on a server that exports a UNIX or NT file system,\n      the reference argument contains the current working directory, and\n      the mailbox name argument contains the name as interpreted in the\n      current working directory.\n      If a server implementation has no concept of break out characters,\n      the canonical form is normally the reference name appended with\n      the mailbox name.  Note that if the server implements the\n      namespace convention (Section 5.1.2.1), \"#\" is a break out\n      character and must be treated as such.\n      If the reference argument is not a level of mailbox hierarchy\n      (that is, it is a \\NoInferiors name), and/or the reference\n      argument does not end with the hierarchy delimiter, it is\n      interpreted as implementation dependent.  For example, a reference\n      of \"foo/bar\" and mailbox name of \"rag/baz\" could be interpreted as\n      \"foo/bar/rag/baz\", \"foo/barrag/baz\", or \"foo/rag/baz\".  A client\n      SHOULD NOT use such a reference argument except at the explicit\n      request of the user.  A hierarchical browser MUST NOT make any\n      assumptions about server interpretation of the reference unless\n      the reference is a level of mailbox hierarchy AND ends with the\n      hierarchy delimiter.\n   Any part of the reference argument that is included in the\n   interpreted form SHOULD prefix the interpreted form.  It SHOULD also\n   be in the same form as the reference name argument.  This rule\n   permits the client to determine if the returned mailbox name is in\n   the context of the reference argument or if something about the\n   mailbox argument overrode the reference argument.  Without this rule,\n   the client would have to have knowledge of the server's naming\n   semantics including what characters are \"breakouts\" that override a\n   naming context.\n   Here are some examples of how references and mailbox names might be\n   interpreted on a UNIX-based server:\n            +==============+==============+===================+\n            | Reference    | Mailbox Name | Interpretation    |\n            +==============+==============+===================+\n            | ~smith/Mail/ | foo.*        | ~smith/Mail/foo.* |\n            +--------------+--------------+-------------------+\n            | archive/     | %            | archive/%         |\n            +--------------+--------------+-------------------+\n            | #news.       | comp.mail.*  | #news.comp.mail.* |\n            +--------------+--------------+-------------------+\n            | ~smith/Mail/ | /usr/doc/foo | /usr/doc/foo      |\n            +--------------+--------------+-------------------+\n            | archive/     | ~fred/Mail/* | ~fred/Mail/*      |\n            +--------------+--------------+-------------------+\n                                  Table 1\n   The first three examples above demonstrate interpretations in the\n   context of the reference argument.  Note that \"~smith/Mail\" SHOULD\n   NOT be transformed into something like \"/u2/users/smith/Mail\", or it\n   would be impossible for the client to determine that the\n   interpretation was in the context of the reference.\n   The character \"*\" is a wildcard and matches zero or more characters\n   at this position.  The character \"%\" is similar to \"*\", but it does\n   not match a hierarchy delimiter.  If the \"%\" wildcard is the last\n   character of a mailbox name argument, matching levels of hierarchy\n   are also returned.  If these levels of hierarchy are not also\n   selectable mailboxes, they are returned with the \\Noselect mailbox\n   name attribute (see the description of the LIST response\n   (Section 7.3.1) for more details).\n   Any syntactically valid pattern that is not accepted by a server for\n   any reason MUST be silently ignored, i.e., it results in no LIST\n   responses, and the LIST command still returns a tagged OK response.\n   Selection options tell the server to limit the mailbox names that are\n   selected by the LIST operation.  If selection options are used, the\n   mailboxes returned are those that match both the list of canonical\n   LIST patterns and the selection options.  Unless a particular\n   selection option provides special rules, the selection options are\n   cumulative: a mailbox that matches the mailbox patterns is selected\n   only if it also matches all of the selection options.  (An example of\n   a selection option with special rules is the RECURSIVEMATCH option.)\n   Return options control what information is returned for each matched\n   mailbox.  Return options MUST NOT cause the server to report\n   information about additional mailbox names other than those that\n   match the canonical LIST patterns and selection options.  If no\n   return options are specified, the client is only expecting\n   information about mailbox attributes.  The server MAY return other\n   information about the matched mailboxes, and clients MUST be able to\n   handle that situation.\n   Initial selection options and return options are defined in the\n   following subsections, and new ones will also be defined in\n   extensions.  Initial options defined in this document MUST be\n   supported.  Each non-initial option will be enabled by a capability\n   string (one capability may enable multiple options), and a client\n   MUST NOT send an option for which the server has not advertised\n   support.  A server MUST respond to options it does not recognize with\n   a BAD response.  The client SHOULD NOT specify any option more than\n   once; however, if the client does this, the server MUST act as if it\n   received the option only once.  The order in which options are\n   specified by the client is not significant.\n   In general, each selection option except RECURSIVEMATCH will have a\n   corresponding return option with the same name.  The REMOTE selection\n   option is an anomaly in this regard and does not have a corresponding\n   return option.  That is because it expands, rather than restricts,\n   the set of mailboxes that are returned.  Future extensions to this\n   specification should keep this parallelism in mind and define a pair\n   of corresponding selection and return options.\n   Server implementations are permitted to \"hide\" otherwise accessible\n   mailboxes from the wildcard characters, by preventing certain\n   characters or names from matching a wildcard in certain situations.\n   For example, a UNIX-based server might restrict the interpretation of\n   \"*\" so that an initial \"/\" character does not match.\n   The special name INBOX is included in the output from LIST, if INBOX\n   is supported by this server for this user and if the uppercase string\n   \"INBOX\" matches the interpreted reference and mailbox name arguments\n   with wildcards as described above.  The criteria for omitting INBOX\n   is whether SELECT INBOX will return a failure; it is not relevant\n   whether the user's real INBOX resides on this or some other server.\n6.3.9.1.  LIST Selection Options\n   The selection options defined in this specification are as follows:\n   SUBSCRIBED\n      Causes the LIST command to list subscribed names rather than the\n      existing mailboxes.  This will often be a subset of the actual\n      mailboxes.  It's also possible for this list to contain the names\n      of mailboxes that don't exist.  In any case, the list MUST include\n      exactly those mailbox names that match the canonical list pattern\n      and are subscribed to.\n      This option defines a mailbox attribute, \"\\Subscribed\", that\n      indicates that a mailbox name is subscribed to.  The \"\\Subscribed\"\n      attribute MUST be supported and MUST be accurately computed when\n      the SUBSCRIBED selection option is specified.\n      Note that the SUBSCRIBED selection option implies the SUBSCRIBED\n      return option (see below).\n   REMOTE\n      Causes the LIST command to show remote mailboxes as well as local\n      ones, as described in [RFC2193].  This option is intended to\n      replace the RLIST command and, in conjunction with the SUBSCRIBED\n      selection option, the RLSUB command.  Servers that don't support\n      the concept of remote mailboxes can ignore this option.\n      This option defines a mailbox attribute, \"\\Remote\", that indicates\n      that a mailbox is a remote mailbox.  The \"\\Remote\" attribute MUST\n      be accurately computed when the REMOTE option is specified.\n      The REMOTE selection option has no interaction with other options.\n      Its effect is to tell the server to apply the other options, if\n      any, to remote mailboxes, in addition to local ones.  In\n      particular, it has no interaction with RECURSIVEMATCH (see below).\n      A request for (REMOTE RECURSIVEMATCH) is invalid, because a\n      request for (RECURSIVEMATCH) is also invalid.  A request for\n      (REMOTE RECURSIVEMATCH SUBSCRIBED) is asking for all subscribed\n      mailboxes, both local and remote.\n   RECURSIVEMATCH\n      Forces the server to return information about parent mailboxes\n      that don't match other selection options but have some\n      submailboxes that do.  Information about children is returned in\n      the CHILDINFO extended data item, as described in Section 6.3.9.6.\n      Note 1:  In order for a parent mailbox to be returned, it still\n         has to match the canonical LIST pattern.\n      Note 2:  When returning the CHILDINFO extended data item, it\n         doesn't matter whether or not the submailbox matches the\n         canonical LIST pattern.  See also Example 9 in Section 6.3.9.8.\n      The RECURSIVEMATCH option MUST NOT occur as the only selection\n      option (or only with REMOTE), as it only makes sense when other\n      selection options are also used.  The server MUST return a BAD\n      tagged response in such case.\n      Note that even if the RECURSIVEMATCH option is specified, the\n      client MUST still be able to handle cases when a CHILDINFO\n      extended data item is returned and there are no submailboxes that\n      meet the selection criteria of the subsequent LIST command, as\n      they can be deleted/renamed after the LIST response was sent but\n      before the client had a chance to access them.\n6.3.9.2.  LIST Return Options\n   The return options defined in this specification are as follows:\n   SUBSCRIBED\n      Causes the LIST command to return subscription state for all\n      matching mailbox names.  The \"\\Subscribed\" attribute MUST be\n      supported and MUST be accurately computed when the SUBSCRIBED\n      return option is specified.  Furthermore, all other mailbox\n      attributes MUST be accurately computed (this differs from the\n      behavior of the obsolete LSUB command from [RFC3501]).  Note that\n      the above requirements don't override the requirement for the LIST\n      command to return results quickly (see Section 6.3.9), i.e.,\n      server implementations need to compute results quickly and\n      accurately.  For example, server implementors might need to create\n      quick access indices.\n   CHILDREN\n      Requests mailbox child information as originally proposed in\n      [RFC3348].  See Section 6.3.9.5, below, for details.\n   STATUS\n      Requests STATUS response for each matching mailbox.\n      This option takes STATUS data items as parameters.  For each\n      selectable mailbox matching the list pattern and selection\n      options, the server MUST return an untagged LIST response followed\n      by an untagged STATUS response containing the information\n      requested in the STATUS return option, except for some cases\n      described below.\n      If an attempted STATUS for a listed mailbox fails because the\n      mailbox can't be selected (e.g., if the \"l\" Access Control List\n      (ACL) right [RFC4314] is granted to the mailbox and the \"r\" right\n      is not granted, or is due to a race condition between LIST and\n      STATUS changing the mailbox to \\NoSelect), the STATUS response\n      MUST NOT be returned, and the LIST response MUST include the\n      \\NoSelect attribute.  This means the server may have to buffer the\n      LIST reply until it has successfully looked up the necessary\n      STATUS information.\n      If the server runs into unexpected problems while trying to look\n      up the STATUS information, it MAY drop the corresponding STATUS\n      reply.  In such a situation, the LIST command would still return a\n      tagged OK reply.\n      See the note in the discussion of the STATUS command in\n      Section 6.3.11 for information about obtaining status on the\n      currently selected mailbox.\n6.3.9.3.  General Principles for Returning LIST Responses\n   This section outlines several principles that can be used by server\n   implementations of this document to decide whether a LIST response\n   should be returned, as well as how many responses and what kind of\n   information they may contain.\n   1.  At most, one LIST response should be returned for each mailbox\n       name that matches the canonical LIST pattern.  Server\n       implementors must not assume that clients will be able to\n       assemble mailbox attributes and other information returned in\n       multiple LIST responses.\n   2.  There are only two reasons for including a matching mailbox name\n       in the responses to the LIST command (note that the server is\n       allowed to return unsolicited responses at any time, and such\n       responses are not governed by this rule):\n       A.  The mailbox name also satisfies the selection criteria.\n       B.  The mailbox name doesn't satisfy the selection criteria, but\n           it has at least one descendant mailbox name that satisfies\n           the selection criteria and that doesn't match the canonical\n           LIST pattern.\n           For more information on this case, see the CHILDINFO extended\n           data item described in Section 6.3.9.6.  Note that the\n           CHILDINFO extended data item can only be returned when the\n           RECURSIVEMATCH selection option is specified.\n   3.  Attributes returned in the same LIST response are treated\n       additively.  For example, the following response\n        S: * LIST (\\Subscribed \\NonExistent) \"/\" \"Fruit/Peach\"\n       means that the \"Fruit/Peach\" mailbox doesn't exist, but it is\n       subscribed.\n6.3.9.4.  Additional LIST-Related Requirements on Clients\n   All clients MUST treat a LIST attribute with a stronger meaning as\n   implying any attribute that can be inferred from it.  (See\n   Section 7.3.1 for the list of currently defined attributes.)  For\n   example, the client must treat the presence of the \\NoInferiors\n   attribute as if the \\HasNoChildren attribute was also sent by the\n   server.\n   The following table summarizes inference rules.\n                +====================+===================+\n                | returned attribute | implied attribute |\n                +====================+===================+\n                |    \\NoInferiors    |   \\HasNoChildren  |\n                +--------------------+-------------------+\n                |    \\NonExistent    |     \\NoSelect     |\n                +--------------------+-------------------+\n                                 Table 2\n6.3.9.5.  The CHILDREN Return Option\n   The CHILDREN return option is simply an indication that the client\n   wants information about whether or not mailboxes contain child\n   mailboxes; a server MAY provide it even if the option is not\n   specified.\n   Many IMAP clients present the user with a hierarchical view of the\n   mailboxes that a user has access to.  Rather than initially\n   presenting the entire mailbox hierarchy to the user, it is often\n   preferable to show the user a collapsed outline list of the mailbox\n   hierarchy (particularly if there is a large number of mailboxes).\n   The user can then expand the collapsed outline hierarchy as needed.\n   It is common to include a visual clue (such as a ''+'') within the\n   collapsed hierarchy to indicate that there are child mailboxes under\n   a particular mailbox.  When the visual clue is clicked, the hierarchy\n   list is expanded to show the child mailboxes.  The CHILDREN return\n   option provides a mechanism for a client to efficiently determine\n   whether a particular mailbox has children, without issuing a LIST \"\"\n   * or a LIST \"\" % for each mailbox name.  The CHILDREN return option\n   defines two new attributes that MUST be returned within a LIST\n   response: \\HasChildren and \\HasNoChildren.  Although these attributes\n   MAY be returned in response to any LIST command, the CHILDREN return\n   option is provided to indicate that the client particularly wants\n   this information.  If the CHILDREN return option is present, the\n   server MUST return these attributes even if their computation is\n   expensive.\n   \\HasChildren\n        The presence of this attribute indicates that the mailbox has\n        child mailboxes.  A server SHOULD NOT set this attribute if\n        there are child mailboxes and the user does not have permission\n        to access any of them.  In this case, \\HasNoChildren SHOULD be\n        used.  In many cases, however, a server may not be able to\n        efficiently compute whether a user has access to any child\n        mailbox.  Note that even though the \\HasChildren attribute for a\n        mailbox must be correct at the time of processing the mailbox, a\n        client must be prepared to deal with a situation when a mailbox\n        is marked with the \\HasChildren attribute, but no child mailbox\n        appears in the response to the LIST command.  This might happen,\n        for example, due to child mailboxes being deleted or made\n        inaccessible to the user (using access control) by another\n        client before the server is able to list them.\n   \\HasNoChildren\n        The presence of this attribute indicates that the mailbox has NO\n        child mailboxes that are accessible to the currently\n        authenticated user.\n   It is an error for the server to return both a \\HasChildren and a\n   \\HasNoChildren attribute in the same LIST response.\n   Note: the \\HasNoChildren attribute should not be confused with the\n   \\NoInferiors attribute, which indicates that no child mailboxes exist\n   now and none can be created in the future.\n6.3.9.6.  CHILDINFO Extended Data Item\n   The CHILDINFO extended data item MUST NOT be returned unless the\n   client has specified the RECURSIVEMATCH selection option.\n   The CHILDINFO extended data item in a LIST response describes the\n   selection criteria that has caused it to be returned and indicates\n   that the mailbox has at least one descendant mailbox that matches the\n   selection criteria.\n   Note: Some servers allow for mailboxes to exist without requiring\n   their parent to exist.  For example, the mailbox \"Customers/ABC\" can\n   exist while the mailbox \"Customers\" does not.  As the CHILDINFO\n   extended data item is not allowed if the RECURSIVEMATCH selection\n   option is not specified, such servers SHOULD use the \"\\NonExistent\n   \\HasChildren\" attribute pair to signal to the client that there is a\n   descendant mailbox that matches the selection criteria.  See Example\n   11 in Section 6.3.9.8.\n   The returned selection criteria allows the client to distinguish a\n   solicited response from an unsolicited one, as well as to distinguish\n   among solicited responses caused by multiple pipelined LIST commands\n   that specify different criteria.\n   Servers SHOULD only return a non-matching mailbox name along with\n   CHILDINFO if at least one matching child is not also being returned.\n   That is, servers SHOULD suppress redundant CHILDINFO responses.\n   Examples 8 and 10 in Section 6.3.9.8 demonstrate the difference\n   between the present CHILDINFO extended data item and the\n   \"\\HasChildren\" attribute.\n   The following table summarizes interaction between the \"\\NonExistent\"\n   attribute and CHILDINFO (the first column indicates whether the\n   parent mailbox exists):\n     +========+===========+====================+=====================+\n     | Exists | Meets the |  Has a child that  | Returned IMAP4rev2/ |\n     |        | selection |     meets the      |    LIST-EXTENDED    |\n     |        |  criteria | selection criteria |    attributes and   |\n     |        |           |                    |      CHILDINFO      |\n     +========+===========+====================+=====================+\n     |   no   |     no    |         no         |   no LIST response  |\n     |        |           |                    |       returned      |\n     +--------+-----------+--------------------+---------------------+\n     |  yes   |     no    |         no         |   no LIST response  |\n     |        |           |                    |       returned      |\n     +--------+-----------+--------------------+---------------------+\n     |   no   |    yes    |         no         |    (\\NonExistent    |\n     |        |           |                    |       <attr>)       |\n     +--------+-----------+--------------------+---------------------+\n     |  yes   |    yes    |         no         |       (<attr>)      |\n     +--------+-----------+--------------------+---------------------+\n     |   no   |     no    |        yes         |   (\\NonExistent) +  |\n     |        |           |                    |      CHILDINFO      |\n     +--------+-----------+--------------------+---------------------+\n     |  yes   |     no    |        yes         |    () + CHILDINFO   |\n     +--------+-----------+--------------------+---------------------+\n     |   no   |    yes    |        yes         |    (\\NonExistent    |\n     |        |           |                    | <attr>) + CHILDINFO |\n     +--------+-----------+--------------------+---------------------+\n     |  yes   |    yes    |        yes         |      (<attr>) +     |\n     |        |           |                    |      CHILDINFO      |\n     +--------+-----------+--------------------+---------------------+\n                                  Table 3\n   where <attr> is one or more attributes that correspond to the\n   selection criteria; for example, for the SUBSCRIBED option, the\n   <attr> is \\Subscribed.\n6.3.9.7.  OLDNAME Extended Data Item\n   The OLDNAME extended data item is included when a mailbox name is\n   created (with the CREATE command), renamed (with the RENAME command),\n   or deleted (with the DELETE command).  (When a mailbox is deleted,\n   the \"\\NonExistent\" attribute is also included.)  IMAP extensions can\n   specify other conditions when the OLDNAME extended data item should\n   be included.\n   If the server allows denormalized mailbox names (see Section 5.1) in\n   SELECT/EXAMINE, CREATE, RENAME, or DELETE, it SHOULD return an\n   unsolicited LIST response that includes the OLDNAME extended data\n   item, whenever the supplied mailbox name differs from the resulting\n   normalized mailbox name.  From the client point of view, this is\n   indistinguishable from another user renaming or deleting the mailbox,\n   as specified in the previous paragraph.\n   A deleted mailbox can be announced as follows:\n     S: * LIST (\\NonExistent) \".\" \"INBOX.DeletedMailbox\"\n   Example of a renamed mailbox:\n     S: * LIST () \"/\" \"NewMailbox\" (\"OLDNAME\" (\"OldMailbox\"))\n6.3.9.8.  LIST Command Examples\n   This example shows some uses of the basic LIST command:\n   Example:\n     C: A101 LIST \"\" \"\"\n     S: * LIST (\\Noselect) \"/\" \"\"\n     S: A101 OK LIST Completed\n     C: A102 LIST #news.comp.mail.misc \"\"\n     S: * LIST (\\Noselect) \".\" #news.\n     S: A102 OK LIST Completed\n     C: A103 LIST /usr/staff/jones \"\"\n     S: * LIST (\\Noselect) \"/\" /\n     S: A103 OK LIST Completed\n     C: A202 LIST ~/Mail/ %\n     S: * LIST (\\Noselect) \"/\" ~/Mail/foo\n     S: * LIST () \"/\" ~/Mail/meetings\n     S: A202 OK LIST completed\n   Extended examples:\n   1:   The first example shows the complete local hierarchy that will\n        be used for the other examples.\n        C: A01 LIST \"\" \"*\"\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST () \"/\" \"Fruit\"\n        S: * LIST () \"/\" \"Fruit/Apple\"\n        S: * LIST () \"/\" \"Fruit/Banana\"\n        S: * LIST () \"/\" \"Tofu\"\n        S: * LIST () \"/\" \"Vegetable\"\n        S: * LIST () \"/\" \"Vegetable/Broccoli\"\n        S: * LIST () \"/\" \"Vegetable/Corn\"\n        S: A01 OK done\n   2:   In the next example, we will see the subscribed mailboxes.  This\n        is similar to, but not equivalent with, the now deprecated <LSUB\n        \"\" \"*\"> (see [RFC3501] for more details on the LSUB command).\n        Note that the mailbox called \"Fruit/Peach\" is subscribed to, but\n        it does not actually exist (perhaps it was deleted while still\n        subscribed).  The \"Fruit\" mailbox is not subscribed to, but it\n        has two subscribed children.  The \"Vegetable\" mailbox is\n        subscribed and has two children; one of them is subscribed as\n        well.\n        C: A02 LIST (SUBSCRIBED) \"\" \"*\"\n        S: * LIST (\\Marked \\NoInferiors \\Subscribed) \"/\" \"inbox\"\n        S: * LIST (\\Subscribed) \"/\" \"Fruit/Banana\"\n        S: * LIST (\\Subscribed \\NonExistent) \"/\" \"Fruit/Peach\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable/Broccoli\"\n        S: A02 OK done\n   3:   The next example shows the use of the CHILDREN option.  The\n        client, without having to list the second level of hierarchy,\n        now knows which of the top-level mailboxes have submailboxes\n        (children) and which do not.  Note that it's not necessary for\n        the server to return the \\HasNoChildren attribute for the inbox,\n        because the \\NoInferiors attribute already implies that and has\n        a stronger meaning.\n        C: A03 LIST () \"\" \"%\" RETURN (CHILDREN)\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST (\\HasChildren) \"/\" \"Fruit\"\n        S: * LIST (\\HasNoChildren) \"/\" \"Tofu\"\n        S: * LIST (\\HasChildren) \"/\" \"Vegetable\"\n        S: A03 OK done\n   4:   In this example, we see more mailboxes that reside on another\n        server.  This is similar to the command <RLIST \"\" \"%\">.\n        C: A04 LIST (REMOTE) \"\" \"%\" RETURN (CHILDREN)\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST (\\HasChildren) \"/\" \"Fruit\"\n        S: * LIST (\\HasNoChildren) \"/\" \"Tofu\"\n        S: * LIST (\\HasChildren) \"/\" \"Vegetable\"\n        S: * LIST (\\Remote \\HasNoChildren) \"/\" \"Bread\"\n        S: * LIST (\\HasChildren \\Remote) \"/\" \"Meat\"\n        S: A04 OK done\n   5:   The following example also requests the server to include\n        mailboxes that reside on another server.  The server returns\n        information about all mailboxes that are subscribed.  This is\n        similar to the command <RLSUB \"\" \"*\"> (see [RFC2193] for more\n        details on RLSUB).  We also see the use of two selection\n        options.\n        C: A05 LIST (REMOTE SUBSCRIBED) \"\" \"*\"\n        S: * LIST (\\Marked \\NoInferiors \\Subscribed) \"/\" \"inbox\"\n        S: * LIST (\\Subscribed) \"/\" \"Fruit/Banana\"\n        S: * LIST (\\Subscribed \\NonExistent) \"/\" \"Fruit/Peach\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable/Broccoli\"\n        S: * LIST (\\Remote \\Subscribed) \"/\" \"Bread\"\n        S: A05 OK done\n   6:   The following example requests the server to include mailboxes\n        that reside on another server.  The server is asked to return\n        subscription information for all returned mailboxes.  This is\n        different from the example above.\n        Note that the output of this command is not a superset of the\n        output in the previous example, as it doesn't include a LIST\n        response for the non-existent \"Fruit/Peach\".\n        C: A06 LIST (REMOTE) \"\" \"*\" RETURN (SUBSCRIBED)\n        S: * LIST (\\Marked \\NoInferiors \\Subscribed) \"/\" \"inbox\"\n        S: * LIST () \"/\" \"Fruit\"\n        S: * LIST () \"/\" \"Fruit/Apple\"\n        S: * LIST (\\Subscribed) \"/\" \"Fruit/Banana\"\n        S: * LIST () \"/\" \"Tofu\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable\"\n        S: * LIST (\\Subscribed) \"/\" \"Vegetable/Broccoli\"\n        S: * LIST () \"/\" \"Vegetable/Corn\"\n        S: * LIST (\\Remote \\Subscribed) \"/\" \"Bread\"\n        S: * LIST (\\Remote) \"/\" \"Meat\"\n        S: A06 OK done\n   7:   The following example demonstrates the difference between the\n        \\HasChildren attribute and the CHILDINFO extended data item.\n        Let's assume there is the following hierarchy:\n        C: C01 LIST \"\" \"*\"\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST () \"/\" \"Foo\"\n        S: * LIST () \"/\" \"Foo/Bar\"\n        S: * LIST () \"/\" \"Foo/Baz\"\n        S: * LIST () \"/\" \"Moo\"\n        S: C01 OK done\n        If the client asks RETURN (CHILDREN), it will get this:\n        C: CA3 LIST \"\" \"%\" RETURN (CHILDREN)\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST (\\HasChildren) \"/\" \"Foo\"\n        S: * LIST (\\HasNoChildren) \"/\" \"Moo\"\n        S: CA3 OK done\n        A)  Let's also assume that the mailbox \"Foo/Baz\" is the only\n            subscribed mailbox.  Then we get this result:\n             C: C02 LIST (SUBSCRIBED) \"\" \"*\"\n             S: * LIST (\\Subscribed) \"/\" \"Foo/Baz\"\n             S: C02 OK done\n            Now, if the client issues <LIST (SUBSCRIBED) \"\" \"%\">, the\n            server will return no mailboxes (as the mailboxes \"Moo\",\n            \"Foo\", and \"Inbox\" are NOT subscribed).  However, if the\n            client issues this:\n             C: C04 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\"\n             S: * LIST () \"/\" \"Foo\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n             S: C04 OK done\n            (that is, the mailbox \"Foo\" is not subscribed, but it has a\n            child that is), then A1 or A2 occurs.\n            A1)  If the mailbox \"Foo\" had also been subscribed, the last\n                 command would return this:\n                 C: C04 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\"\n                 S: * LIST (\\Subscribed) \"/\" \"Foo\" (\"CHILDINFO\"\n                     (\"SUBSCRIBED\"))\n                 S: C04 OK done\n                 or even this:\n                 C: C04 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\"\n                 S: * LIST (\\Subscribed \\HasChildren) \"/\" \"Foo\"\n                     (\"CHILDINFO\" (\"SUBSCRIBED\"))\n                 S: C04 OK done\n            A2)  If we assume instead that the mailbox \"Foo\" is not part\n                 of the original hierarchy and is not subscribed, the\n                 last command will give this result:\n                 C: C04 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\"\n                 S: * LIST (\\NonExistent) \"/\" \"Foo\" (\"CHILDINFO\"\n                     (\"SUBSCRIBED\"))\n                 S: C04 OK done\n        B)  Now, let's assume that no mailbox is subscribed.  In this\n            case, the command <LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\">\n            will return no responses, as there are no subscribed\n            children (even though \"Foo\" has children).\n        C)  And finally, suppose that only the mailboxes \"Foo\" and \"Moo\"\n            are subscribed.  In that case, we see this result:\n             C: C04 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" \"%\" RETURN\n                 (CHILDREN)\n             S: * LIST (\\HasChildren \\Subscribed) \"/\" \"Foo\"\n             S: * LIST (\\HasNoChildren \\Subscribed) \"/\" \"Moo\"\n             S: C04 OK done\n            (which means that the mailbox \"Foo\" has children, but none\n            of them is subscribed).\n   8:   The following example demonstrates that the CHILDINFO extended\n        data item is returned whether or not child mailboxes match the\n        canonical LIST pattern.\n        Let's assume there is the following hierarchy:\n        C: D01 LIST \"\" \"*\"\n        S: * LIST (\\Marked \\NoInferiors) \"/\" \"inbox\"\n        S: * LIST () \"/\" \"foo2\"\n        S: * LIST () \"/\" \"foo2/bar1\"\n        S: * LIST () \"/\" \"foo2/bar2\"\n        S: * LIST () \"/\" \"baz2\"\n        S: * LIST () \"/\" \"baz2/bar2\"\n        S: * LIST () \"/\" \"baz2/bar22\"\n        S: * LIST () \"/\" \"baz2/bar222\"\n        S: * LIST () \"/\" \"eps2\"\n        S: * LIST () \"/\" \"eps2/mamba\"\n        S: * LIST () \"/\" \"qux2/bar2\"\n        S: D01 OK done\n        And that the following mailboxes are subscribed:\n        C: D02 LIST (SUBSCRIBED) \"\" \"*\"\n        S: * LIST (\\Subscribed) \"/\" \"foo2/bar1\"\n        S: * LIST (\\Subscribed) \"/\" \"foo2/bar2\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar2\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar22\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar222\"\n        S: * LIST (\\Subscribed) \"/\" \"eps2\"\n        S: * LIST (\\Subscribed) \"/\" \"eps2/mamba\"\n        S: * LIST (\\Subscribed) \"/\" \"qux2/bar2\"\n        S: D02 OK done\n        The client issues the following command first:\n        C: D03 LIST (RECURSIVEMATCH SUBSCRIBED) \"\" \"*2\"\n        S: * LIST () \"/\" \"foo2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\Subscribed) \"/\" \"foo2/bar2\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar2\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar22\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar222\"\n        S: * LIST (\\Subscribed) \"/\" \"eps2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\Subscribed) \"/\" \"qux2/bar2\"\n        S: D03 OK done\n        and the server may also include the following (but this would\n        violate a restriction in Section 6.3.9.6, because CHILDINFO is\n        redundant):\n        S: * LIST () \"/\" \"baz2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\NonExistent) \"/\" \"qux2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        The CHILDINFO extended data item is returned for mailboxes\n        \"foo2\", \"baz2\", and \"eps2\" because all of them have subscribed\n        children, even though for the mailbox \"foo2\", only one of the\n        two subscribed children matches the pattern; for the mailbox\n        \"baz2\", all of the subscribed children match the pattern; and\n        for the mailbox \"eps2\", none of the subscribed children match\n        the pattern.\n        Note that if the client issues the following:\n        C: D03 LIST (RECURSIVEMATCH SUBSCRIBED) \"\" \"*\"\n        S: * LIST () \"/\" \"foo2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\Subscribed) \"/\" \"foo2/bar1\"\n        S: * LIST (\\Subscribed) \"/\" \"foo2/bar2\"\n        S: * LIST () \"/\" \"baz2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar2\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar22\"\n        S: * LIST (\\Subscribed) \"/\" \"baz2/bar222\"\n        S: * LIST (\\Subscribed) \"/\" \"eps2\" (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: * LIST (\\Subscribed) \"/\" \"eps2/mamba\"\n        S: * LIST (\\Subscribed) \"/\" \"qux2/bar2\"\n        S: D03 OK done\n        the LIST responses for mailboxes \"foo2\", \"baz2\", and \"eps2\"\n        still have the CHILDINFO extended data item, even though this\n        information is redundant and the client can determine it by\n        itself.\n   9:   The following example shows usage of an extended syntax for the\n        mailbox pattern.  It also demonstrates that the presence of the\n        CHILDINFO extended data item doesn't necessarily imply\n        \\HasChildren.\n        C: a1 LIST \"\" (\"foo\")\n        S: * LIST () \"/\" foo\n        S: a1 OK done\n        C: a2 LIST (SUBSCRIBED) \"\" \"foo/*\"\n        S: * LIST (\\Subscribed \\NonExistent) \"/\" foo/bar\n        S: a2 OK done\n        C: a3 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" foo RETURN (CHILDREN)\n        S: * LIST (\\HasNoChildren) \"/\" foo (\"CHILDINFO\" (\"SUBSCRIBED\"))\n        S: a3 OK done\n   10:  The following example shows how a server that supports missing\n        mailbox hierarchy elements can signal to a client that didn't\n        specify the RECURSIVEMATCH selection option that there is a\n        child mailbox that matches the selection criteria.\n        C: a1 LIST (REMOTE) \"\" *\n        S: * LIST () \"/\" music/rock\n        S: * LIST (\\Remote) \"/\" also/jazz\n        S: a1 OK done\n        C: a2 LIST () \"\" %\n        S: * LIST (\\NonExistent \\HasChildren) \"/\" music\n        S: a2 OK done\n        C: a3 LIST (REMOTE) \"\" %\n        S: * LIST (\\NonExistent \\HasChildren) \"/\" music\n        S: * LIST (\\NonExistent \\HasChildren) \"/\" also\n        S: a3 OK done\n        C: a3.1 LIST \"\" (% music/rock)\n        S: * LIST () \"/\" music/rock\n        S: a3.1 OK done\n        Because \"music/rock\" is the only mailbox under \"music\", there's\n        no need for the server to also return \"music\".  However, clients\n        must handle both cases.\n   11:  The following examples show use of the STATUS return option.\n        C: A01 LIST \"\" % RETURN (STATUS (MESSAGES UNSEEN))\n        S: * LIST () \".\"  \"INBOX\"\n        S: * STATUS \"INBOX\" (MESSAGES 17 UNSEEN 16)\n        S: * LIST () \".\" \"foo\"\n        S: * STATUS \"foo\" (MESSAGES 30 UNSEEN 29)\n        S: * LIST (\\NoSelect) \".\" \"bar\"\n        S: A01 OK List completed.\n        The \"bar\" mailbox isn't selectable, so it has no STATUS reply.\n        C: A02 LIST (SUBSCRIBED RECURSIVEMATCH) \"\" % RETURN (STATUS\n             (MESSAGES))\n        S: * LIST (\\Subscribed) \".\"  \"INBOX\"\n        S: * STATUS \"INBOX\" (MESSAGES 17)\n        S: * LIST () \".\" \"foo\" (CHILDINFO (\"SUBSCRIBED\"))\n        S: A02 OK List completed.\n        The LIST reply for \"foo\" is returned because it has matching\n        children, but no STATUS reply is returned because \"foo\" itself\n        doesn't match the selection criteria.\n6.3.10.  NAMESPACE Command\n   Arguments:    none\n   Responses:    REQUIRED untagged responses:  NAMESPACE\n   Result:       OK -  command completed\n                 NO -  Can't complete the command\n                 BAD -  arguments invalid\n   The NAMESPACE command causes a single untagged NAMESPACE response to\n   be returned.  The untagged NAMESPACE response contains the prefix and\n   hierarchy delimiter to the server's Personal Namespace(s), Other\n   Users' Namespace(s), and Shared Namespace(s) that the server wishes\n   to expose.  The response will contain a NIL for any namespace class\n   that is not available.  The namespace-response-extensions ABNF non-\n   terminal is defined for extensibility and MAY be included in the\n   NAMESPACE response.\n   Example 1:\n   In this example, a server supports a single Personal Namespace.  No\n   leading prefix is used on personal mailboxes, and \"/\" is the\n   hierarchy delimiter.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) NIL NIL\n     S: A001 OK NAMESPACE command completed\n   Example 2:\n   A user logged on anonymously to a server.  No personal mailboxes are\n   associated with the anonymous user, and the user does not have access\n   to the Other Users' Namespace.  No prefix is required to access\n   shared mailboxes, and the hierarchy delimiter is \".\"\n     C: A001 NAMESPACE\n     S: * NAMESPACE NIL NIL ((\"\" \".\"))\n     S: A001 OK NAMESPACE command completed\n   Example 3:\n   A server that contains a Personal Namespace and a single Shared\n   Namespace.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) NIL ((\"Public Folders/\" \"/\"))\n     S: A001 OK NAMESPACE command completed\n   Example 4:\n   A server that contains a Personal Namespace, Other Users' Namespace,\n   and multiple Shared Namespaces.  Note that the hierarchy delimiter\n   used within each namespace can be different.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) ((\"~\" \"/\")) ((\"#shared/\" \"/\")\n         (\"#public/\" \"/\")(\"#ftp/\" \"/\")(\"#news.\" \".\"))\n     S: A001 OK NAMESPACE command completed\n   The prefix string allows a client to do things such as automatically\n   create personal mailboxes or LIST all available mailboxes within a\n   namespace.\n   Example 5:\n   A server that supports only the Personal Namespace, with a leading\n   prefix of INBOX to personal mailboxes and a hierarchy delimiter of\n   \".\".\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"INBOX.\" \".\")) NIL  NIL\n     S: A001 OK NAMESPACE command completed\n   Automatically create a mailbox to store sent items.\n     C: A002 CREATE \"INBOX.Sent Mail\"\n     S: A002 OK CREATE command completed\n   Although a server will typically support only a single Personal\n   Namespace, and a single Other User's Namespace, circumstances exist\n   where there MAY be multiples of these, and a client MUST be prepared\n   for them.  If a client is configured such that it is required to\n   create a certain mailbox, there can be circumstances where it is\n   unclear which Personal Namespaces it should create the mailbox in.\n   In these situations, a client SHOULD let the user select which\n   namespaces to create the mailbox in, or just use the first Personal\n   Namespace.\n   Example 6:\n   In this example, a server supports two Personal Namespaces.  In\n   addition to the regular Personal Namespace, the user has an\n   additional Personal Namespace that allows access to mailboxes in an\n   MH format mailstore.\n   The client is configured to save a copy of all mail sent by the user\n   into a mailbox with the \\Sent attribute (see Section 7.3.1).\n   Furthermore, after a message is deleted from a mailbox, the client is\n   configured to move that message to a mailbox with the \\Trash\n   attribute.  The server signals with the \\NonExistent mailbox\n   attribute that the corresponding mailboxes don't exist yet and that\n   it is possible to create them.  Once created, they could be used for\n   \\Sent or \\Trash purposes, and the server will no longer include the\n   \\NonExistent mailbox attribute for them.\n   Note that this example demonstrates how some extension parameters can\n   be passed to further describe the #mh namespace.  See the fictitious\n   \"X-PARAM\" extension parameter.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")(\"#mh/\" \"/\" \"X-PARAM\"\n         (\"FLAG1\" \"FLAG2\"))) NIL NIL\n     S: A001 OK NAMESPACE command completed\n     C: A002 LIST (SPECIAL-USE) \"\" \"*\"\n     S: * LIST (\\NonExistent \\Archive) \"/\" Archives\n     S: * LIST (\\NonExistent \\Drafts) \"/\" Drafts\n     S: * LIST (\\NonExistent \\Junk) \"/\" Junk\n     S: * LIST (\\NonExistent \\Sent) \"/\" \"Sent Mail\"\n     S: * LIST (\\NonExistent \\Trash) \"/\" \"Deleted Items\"\n     S: A002 OK LIST Completed\n     C: A003 LIST (SPECIAL-USE) \"#mh/\" \"*\"\n     S: * LIST (\\NonExistent \\Archive) \"/\" \"#mh/Archives\"\n     S: * LIST (\\NonExistent \\Drafts) \"/\" \"#mh/Drafts\"\n     S: * LIST (\\NonExistent \\Junk) \"/\" \"#mh/Junk\"\n     S: * LIST (\\NonExistent \\Sent) \"/\" \"#mh/Sent Mail\"\n     S: * LIST (\\NonExistent \\Trash) \"/\" \"#mh/Deleted Items\"\n     S: A003 OK LIST Completed\n   It is desired to keep only one copy of sent mail.  It is unclear\n   which Personal Namespace the client should use to create the 'Sent\n   Mail' mailbox.  The user is prompted to select a namespace, and only\n   one 'Sent Mail' mailbox is created.\n     C: A004 CREATE \"Sent Mail\"\n     S: A004 OK CREATE command completed\n   The client is designed so that it keeps two 'Deleted Items'\n   mailboxes, one for each namespace.\n     C: A005 CREATE \"Delete Items\"\n     S: A005 OK CREATE command completed\n     C: A006 CREATE \"#mh/Deleted Items\"\n     S: A006 OK CREATE command completed\n   The next level of hierarchy following the Other Users' Namespace\n   prefix SHOULD consist of <username>, where <username> is a user name\n   as per the LOGIN or AUTHENTICATE command.\n   A client can construct a LIST command by appending a \"%\" to the Other\n   Users' Namespace prefix to discover the Personal Namespaces of other\n   users that are available to the currently authenticated user.\n   In response to such a LIST command, a server SHOULD NOT return user\n   names that have not granted access to their personal mailboxes to the\n   user in question.\n   A server MAY return a LIST response containing only the names of\n   users that have explicitly granted access to the user in question.\n   Alternatively, a server MAY return NO to such a LIST command,\n   requiring that a user name be included with the Other Users'\n   Namespace prefix before listing any other user's mailboxes.\n   Example 7:\n   A server that supports providing a list of other user's mailboxes\n   that are accessible to the currently logged on user.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) ((\"Other Users/\" \"/\")) NIL\n     S: A001 OK NAMESPACE command completed\n     C: A002 LIST \"\" \"Other Users/%\"\n     S: * LIST () \"/\" \"Other Users/Mike\"\n     S: * LIST () \"/\" \"Other Users/Karen\"\n     S: * LIST () \"/\" \"Other Users/Matthew\"\n     S: * LIST () \"/\" \"Other Users/Tesa\"\n     S: A002 OK LIST command completed\n   Example 8:\n   A server that does not support providing a list of other user's\n   mailboxes that are accessible to the currently logged on user.  The\n   mailboxes are listable if the client includes the name of the other\n   user with the Other Users' Namespace prefix.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) ((\"#Users/\" \"/\")) NIL\n     S: A001 OK NAMESPACE command completed\n   In this example, the currently logged on user has access to the\n   Personal Namespace of user Mike, but the server chose to suppress\n   this information in the LIST response.  However, by appending the\n   user name Mike (received through user input) to the Other Users'\n   Namespace prefix, the client is able to get a listing of the personal\n   mailboxes of user Mike.\n     C: A002 LIST \"\" \"#Users/%\"\n     S: A002 NO The requested item could not be found.\n     C: A003 LIST \"\" \"#Users/Mike/%\"\n     S: * LIST () \"/\" \"#Users/Mike/INBOX\"\n     S: * LIST () \"/\" \"#Users/Mike/Foo\"\n     S: A003 OK LIST command completed.\n   A prefix string might not contain a hierarchy delimiter, because in\n   some cases, it is not needed as part of the prefix.\n   Example 9:\n   A server that allows access to the Other Users' Namespace by\n   prefixing the others' mailboxes with a '~' followed by <username>,\n   where <username> is a user name as per the LOGIN or AUTHENTICATE\n   command.\n     C: A001 NAMESPACE\n     S: * NAMESPACE ((\"\" \"/\")) ((\"~\" \"/\")) NIL\n     S: A001 OK NAMESPACE command completed\n   List the mailboxes for user mark\n     C: A002 LIST \"\" \"~mark/%\"\n     S: * LIST () \"/\" \"~mark/INBOX\"\n     S: * LIST () \"/\" \"~mark/foo\"\n     S: A002 OK LIST command completed\n6.3.11.  STATUS Command\n   Arguments:    mailbox name\n                 status data item names\n   Responses:    REQUIRED untagged responses:  STATUS\n   Result:       OK -  status completed\n                 NO -  status failure: no status for that name\n                 BAD -  command unknown or arguments invalid\n   The STATUS command requests the status of the indicated mailbox.  It\n   does not change the currently selected mailbox, nor does it affect\n   the state of any messages in the queried mailbox.\n   The STATUS command provides an alternative to opening a second\n   IMAP4rev2 connection and doing an EXAMINE command on a mailbox to\n   query that mailbox's status without deselecting the current mailbox\n   in the first IMAP4rev2 connection.\n   Unlike the LIST command, the STATUS command is not guaranteed to be\n   fast in its response.  Under certain circumstances, it can be quite\n   slow.  In some implementations, the server is obliged to open the\n   mailbox as \"read-only\" internally to obtain certain status\n   information.  Also unlike the LIST command, the STATUS command does\n   not accept wildcards.\n      Note: The STATUS command is intended to access the status of\n      mailboxes other than the currently selected mailbox.  Because the\n      STATUS command can cause the mailbox to be opened internally, and\n      because this information is available by other means on the\n      selected mailbox, the STATUS command SHOULD NOT be used on the\n      currently selected mailbox.  However, servers MUST be able to\n      execute the STATUS command on the selected mailbox.  (This might\n      also implicitly happen when the STATUS return option is used in a\n      LIST command.)\n      The STATUS command MUST NOT be used as a \"check for new messages\n      in the selected mailbox\" operation (refer to Sections 7 and 7.4.1\n      for more information about the proper method for new message\n      checking).\n      STATUS SIZE (see below) can take a significant amount of time,\n      depending upon server implementation.  Clients should use STATUS\n      SIZE cautiously.\n   The currently defined status data items that can be requested are:\n   MESSAGES\n      The number of messages in the mailbox.\n   UIDNEXT\n      The next unique identifier value of the mailbox.  Refer to\n      Section 2.3.1.1 for more information.\n   UIDVALIDITY\n      The unique identifier validity value of the mailbox.  Refer to\n      Section 2.3.1.1 for more information.\n   UNSEEN\n      The number of messages that do not have the \\Seen flag set.\n   DELETED\n      The number of messages that have the \\Deleted flag set.\n   SIZE\n      The total size of the mailbox in octets.  This is not strictly\n      required to be an exact value, but it MUST be equal to or greater\n      than the sum of the values of the RFC822.SIZE FETCH message data\n      items (see Section 6.4.5) of all messages in the mailbox.\n   Example:\n     C: A042 STATUS blurdybloop (UIDNEXT MESSAGES)\n     S: * STATUS blurdybloop (MESSAGES 231 UIDNEXT 44292)\n     S: A042 OK STATUS completed\n6.3.12.  APPEND Command\n   Arguments:    mailbox name\n                 OPTIONAL flag parenthesized list\n                 OPTIONAL date/time string\n                 message literal\n   Responses:    OPTIONAL untagged response:  LIST\n   Result:       OK -  append completed\n                 NO -  append error: can't append to that mailbox, error\n                    in flags or date/time or message text\n                 BAD -  command unknown or arguments invalid\n   The APPEND command appends the literal argument as a new message to\n   the end of the specified destination mailbox.  This argument SHOULD\n   be in the format of an [RFC5322] or [I18N-HDRS] message.  8-bit\n   characters are permitted in the message.  A server implementation\n   that is unable to preserve 8-bit data properly MUST be able to\n   reversibly convert 8-bit APPEND data to 7 bits using a [MIME-IMB]\n   content transfer encoding.\n      Note: There may be exceptions, such as draft messages, in which\n      required [RFC5322] header fields are omitted in the message\n      literal argument to APPEND.  The full implications of doing so\n      must be understood and carefully weighed.\n   If a flag parenthesized list is specified, the flags SHOULD be set in\n   the resulting message; otherwise, the flag list of the resulting\n   message is set to \"empty\" by default.\n   If a date-time is specified, the internal date SHOULD be set in the\n   resulting message; otherwise, the internal date of the resulting\n   message is set to the current date and time by default.\n   If the append is unsuccessful for any reason, the mailbox MUST be\n   restored to its state before the APPEND attempt (other than possibly\n   keeping the changed mailbox's UIDNEXT value); no partial appending is\n   permitted.\n   If the destination mailbox does not exist, a server MUST return an\n   error and MUST NOT automatically create the mailbox.  Unless it is\n   certain that the destination mailbox cannot be created, the server\n   MUST send the response code \"[TRYCREATE]\" as the prefix of the text\n   of the tagged NO response.  This gives a hint to the client that it\n   can attempt a CREATE command and retry the APPEND if the CREATE is\n   successful.\n   On successful completion of an APPEND, the server returns an\n   APPENDUID response code (see Section 7.1), unless otherwise specified\n   below.\n   In the case of a mailbox that has permissions set so that the client\n   can APPEND to the mailbox, but not SELECT or EXAMINE it, the server\n   MUST NOT send an APPENDUID response code as it would disclose\n   information about the mailbox.\n   In the case of a mailbox that has UIDNOTSTICKY status (see\n   Section 7.1), the server MAY omit the APPENDUID response code as it\n   is not meaningful.\n   If the mailbox is currently selected, normal new message actions\n   SHOULD occur.  Specifically, the server SHOULD notify the client\n   immediately via an untagged EXISTS response.  If the server does not\n   do so, the client MAY issue a NOOP command after one or more APPEND\n   commands.\n   If the server decides to convert (normalize) the mailbox name, it\n   SHOULD return an untagged LIST with an OLDNAME extended data item,\n   with the OLDNAME value being the supplied mailbox name and the name\n   parameter being the normalized mailbox name.  (See Section 6.3.9.7\n   for more details.)\n   Example:\n     C: A003 APPEND saved-messages (\\Seen) {326}\n     S: + Ready for literal data\n     C: Date: Mon, 7 Feb 1994 21:52:25 -0800 (PST)\n     C: From: Fred Foobar <foobar@Blurdybloop.example>\n     C: Subject: afternoon meeting\n     C: To: mooch@owatagu.siam.edu.example\n     C: Message-Id: <B27397-0100000@Blurdybloop.example>\n     C: MIME-Version: 1.0\n     C: Content-Type: TEXT/PLAIN; CHARSET=US-ASCII\n     C:\n     C: Hello Joe, do you think we can meet at 3:30 tomorrow?\n     C:\n     S: A003 OK APPEND completed\n   Example:\n     C: A003 APPEND saved-messages (\\Seen) {297+}\n     C: Date: Mon, 7 Feb 1994 21:52:25 -0800 (PST)\n     C: From: Fred Foobar <foobar@example.com>\n     C: Subject: afternoon meeting\n     C: To: mooch@example.com\n     C: Message-Id: <B27397-0100000@example.com>\n     C: MIME-Version: 1.0\n     C: Content-Type: TEXT/PLAIN; CHARSET=US-ASCII\n     C:\n     C: Hello Joe, do you think we can meet at 3:30 tomorrow?\n     C:\n     S: A003 OK [APPENDUID 38505 3955] APPEND completed\n     C: A004 COPY 2:4 meeting\n     S: A004 OK [COPYUID 38505 304,319:320 3956:3958] Done\n     C: A005 UID COPY 305:310 meeting\n     S: A005 OK No matching messages, so nothing copied\n     C: A006 COPY 2 funny\n     S: A006 OK Done\n     C: A007 SELECT funny\n     S: * 1 EXISTS\n     S: * OK [UIDVALIDITY 3857529045] Validity session-only\n     S: * OK [UIDNEXT 2] Predicted next UID\n     S: * NO [UIDNOTSTICKY] Non-persistent UIDs\n     S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n     S: * OK [PERMANENTFLAGS (\\Deleted \\Seen)] Limited\n     S: * LIST () \".\" funny\n     S: A007 OK [READ-WRITE] SELECT completed\n   In this example, A003 and A004 demonstrate successful appending and\n   copying to a mailbox that returns the UIDs assigned to the messages.\n   A005 is an example in which no messages were copied; this is because\n   in A003, we see that message 2 had UID 304, and message 3 had UID\n   319; therefore, UIDs 305 through 310 do not exist (refer to\n   Section 2.3.1.1 for further explanation).  A006 is an example of a\n   message being copied that did not return a COPYUID; and, as expected,\n   A007 shows that the mail store containing that mailbox does not\n   support persistent UIDs.\n      |  Note: The APPEND command is not used for message delivery,\n      |  because it does not provide a mechanism to transfer [SMTP]\n      |  envelope information.\n6.3.13.  IDLE Command\n   Arguments:    none\n   Responses:    continuation data will be requested; the client sends\n                 the continuation data \"DONE\" to end the command\n   Result:       OK -  IDLE completed after client sent \"DONE\"\n                 NO -  failure: the server will not allow the IDLE\n                    command at this time\n                 BAD -  command unknown or arguments invalid\n   Without the IDLE command, a client would need to poll the server for\n   changes to the selected mailbox (new mail, deletions, and flag\n   changes).  It's often more desirable to have the server transmit\n   updates to the client in real time.  This allows a user to see new\n   mail immediately.  The IDLE command allows a client to tell the\n   server that it's ready to accept such real-time updates.\n   The IDLE command is sent from the client to the server when the\n   client is ready to accept unsolicited update messages.  The server\n   requests a response to the IDLE command using the continuation (\"+\")\n   response.  The IDLE command remains active until the client responds\n   to the continuation, and as long as an IDLE command is active, the\n   server is now free to send untagged EXISTS, EXPUNGE, FETCH, and other\n   responses at any time.  If the server chooses to send unsolicited\n   FETCH responses, they MUST include a UID FETCH item.\n   The IDLE command is terminated by the receipt of a \"DONE\"\n   continuation from the client; such response satisfies the server's\n   continuation request.  At that point, the server MAY send any\n   remaining queued untagged responses and then MUST immediately send\n   the tagged response to the IDLE command and prepare to process other\n   commands.  As for other commands, the processing of any new command\n   may cause the sending of unsolicited untagged responses, subject to\n   the ambiguity limitations.  The client MUST NOT send a command while\n   the server is waiting for the DONE, since the server will not be able\n   to distinguish a command from a continuation.\n   The server MAY consider a client inactive if it has an IDLE command\n   running, and if such a server has an inactivity timeout, it MAY log\n   the client off implicitly at the end of its timeout period.  Because\n   of that, clients using IDLE are advised to terminate IDLE and reissue\n   it at least every 29 minutes to avoid being logged off.  This still\n   allows a client to receive immediate mailbox updates even though it\n   need only \"poll\" at half hour intervals.\n   Example:\n     C: A001 SELECT INBOX\n     S: * FLAGS (\\Deleted \\Seen \\Flagged)\n     S: * OK [PERMANENTFLAGS (\\Deleted \\Seen \\Flagged)] Limited\n     S: * 3 EXISTS\n     S: * OK [UIDVALIDITY 1]\n     S: * OK [UIDNEXT 1]\n     S: * LIST () \"/\" INBOX\n     S: A001 OK [READ-WRITE] SELECT completed\n     C: A002 IDLE\n     S: + idling\n     ...time passes; new mail arrives...\n     S: * 4 EXISTS\n     C: DONE\n     S: A002 OK IDLE terminated\n     ...another client expunges message 2 now...\n     C: A003 FETCH 4 ALL\n     S: * 4 FETCH (...)\n     S: A003 OK FETCH completed\n     C: A004 IDLE\n     S: * 2 EXPUNGE\n     S: * 3 EXISTS\n     S: + idling\n     ...time passes; another client expunges message 3...\n     S: * 3 EXPUNGE\n     S: * 2 EXISTS\n     ...time passes; new mail arrives...\n     S: * 3 EXISTS\n     C: DONE\n     S: A004 OK IDLE terminated\n     C: A005 FETCH 3 ALL\n     S: * 3 FETCH (...)\n     S: A005 OK FETCH completed\n     C: A006 IDLE\n6.4.  Client Commands - Selected State\n   In the selected state, commands that manipulate messages in a mailbox\n   are permitted.\n   In addition to the universal commands (CAPABILITY, NOOP, and LOGOUT),\n   and the authenticated state commands (SELECT, EXAMINE, NAMESPACE,\n   CREATE, DELETE, RENAME, SUBSCRIBE, UNSUBSCRIBE, LIST, STATUS, and\n   APPEND), the following commands are valid in the selected state:\n   CLOSE, UNSELECT, EXPUNGE, SEARCH, FETCH, STORE, COPY, MOVE, and UID.\n6.4.1.  CLOSE Command\n   Arguments:    none\n   Responses:    no specific responses for this command\n   Result:       OK -  close completed, now in authenticated state\n                 BAD -  command unknown or arguments invalid\n   The CLOSE command permanently removes all messages that have the\n   \\Deleted flag set from the currently selected mailbox, and it returns\n   to the authenticated state from the selected state.  No untagged\n   EXPUNGE responses are sent.\n   No messages are removed, and no error is given, if the mailbox is\n   selected by an EXAMINE command or is otherwise selected as read-only.\n   Even if a mailbox is selected, a SELECT, EXAMINE, or LOGOUT command\n   MAY be issued without previously issuing a CLOSE command.  The\n   SELECT, EXAMINE, and LOGOUT commands implicitly close the currently\n   selected mailbox without doing an expunge.  However, when many\n   messages are deleted, a CLOSE-LOGOUT or CLOSE-SELECT sequence is\n   considerably faster than an EXPUNGE-LOGOUT or EXPUNGE-SELECT because\n   no untagged EXPUNGE responses (which the client would probably\n   ignore) are sent.\n   Example:\n     C: A341 CLOSE\n     S: A341 OK CLOSE completed\n6.4.2.  UNSELECT Command\n   Arguments:    none\n   Responses:    no specific responses for this command\n   Result:       OK -  unselect completed, now in authenticated state\n                 BAD -  no mailbox selected, or argument supplied but\n                    none permitted\n   The UNSELECT command frees a session's resources associated with the\n   selected mailbox and returns the server to the authenticated state.\n   This command performs the same actions as CLOSE, except that no\n   messages are permanently removed from the currently selected mailbox.\n   Example:\n     C: A342 UNSELECT\n     S: A342 OK Unselect completed\n6.4.3.  EXPUNGE Command\n   Arguments:    none\n   Responses:    untagged responses:  EXPUNGE\n   Result:       OK -  expunge completed\n                 NO -  expunge failure: can't expunge (e.g., permission\n                    denied)\n                 BAD -  command unknown or arguments invalid\n   The EXPUNGE command permanently removes all messages that have the\n   \\Deleted flag set from the currently selected mailbox.  Before\n   returning an OK to the client, an untagged EXPUNGE response is sent\n   for each message that is removed.\n   Example:\n     C: A202 EXPUNGE\n     S: * 3 EXPUNGE\n     S: * 3 EXPUNGE\n     S: * 5 EXPUNGE\n     S: * 8 EXPUNGE\n     S: A202 OK EXPUNGE completed\n   Note: In this example, messages 3, 4, 7, and 11 had the \\Deleted flag\n   set.  See the description of the EXPUNGE response (Section 7.5.1) for\n   further explanation.\n6.4.4.  SEARCH Command\n   Arguments:    OPTIONAL result specifier\n                 OPTIONAL [CHARSET] specification\n                 searching criteria (one or more)\n   Responses:    OPTIONAL untagged response:  ESEARCH\n   Result:       OK -  search completed\n                 NO -  search error: can't search that [CHARSET] or\n                    criteria\n                 BAD -  command unknown or arguments invalid\n   The SEARCH command searches the mailbox for messages that match the\n   given searching criteria.\n   The SEARCH command may contain result options.  Result options\n   control what kind of information is returned about messages matching\n   the search criteria in an untagged ESEARCH response.  If no result\n   option is specified or empty list of options is specified as \"()\",\n   ALL is assumed (see below).  The order of individual options is\n   arbitrary.  Individual options may contain parameters enclosed in\n   parentheses.  (However, if an option has a mandatory parameter, which\n   can always be represented as a number or a sequence-set, the option\n   parameter does not need the enclosing parentheses.  See \"Formal\n   Syntax\" (Section 9) for more details.)  If an option has parameters,\n   they consist of atoms and/or strings and/or lists in a specific\n   order.  Any options not defined by extensions that the server\n   supports MUST be rejected with a BAD response.\n   Note that IMAP4rev1 used SEARCH responses [RFC3501] instead of\n   ESEARCH responses.  Clients that support only IMAP4rev2 MUST ignore\n   SEARCH responses.\n   This document specifies the following result options:\n   MIN\n      Return the lowest message number/UID that satisfies the SEARCH\n      criteria.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the MIN result option in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   MAX\n      Return the highest message number/UID that satisfies the SEARCH\n      criteria.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the MAX result option in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   ALL\n      Return all message numbers/UIDs that satisfy the SEARCH criteria\n      using the sequence-set syntax.  Note that the client MUST NOT\n      assume that messages/UIDs will be listed in any particular order.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the ALL result option in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   COUNT\n      Return the number of messages that satisfy the SEARCH criteria.\n      This result option MUST always be included in the ESEARCH\n      response.\n   SAVE\n      This option tells the server to remember the result of the SEARCH\n      or UID SEARCH command (as well as any command based on SEARCH,\n      e.g., SORT and THREAD [RFC5256]) and store it in an internal\n      variable that we will reference as the \"search result variable\".\n      The client can use the \"$\" marker to reference the content of this\n      internal variable.  The \"$\" marker can be used instead of message\n      sequence or UID sequence in order to indicate that the server\n      should substitute it with the list of messages from the search\n      result variable.  Thus, the client can use the result of the\n      latest remembered SEARCH command as a parameter to another\n      command.  See Section 6.4.4.1 for details on how the value of the\n      search result variable is determined, how it is affected by other\n      commands executed, and how the SAVE return option interacts with\n      other return options.\n      In absence of any other SEARCH result option, the SAVE result\n      option also suppresses any ESEARCH response that would have been\n      otherwise returned by the SEARCH command.\n   Note: future extensions to this document can allow servers to return\n   multiple ESEARCH responses for a single extended SEARCH command.\n   However, all options specified above MUST result in a single ESEARCH\n   response if used by themselves or in combination.  This guarantee\n   simplifies processing in IMAP4rev2 clients.  Future SEARCH extensions\n   that relax this restriction will have to describe how results from\n   multiple ESEARCH responses are to be combined.\n   Searching criteria consist of one or more search keys.\n   When multiple keys are specified, the result is the intersection (AND\n   function) of all the messages that match those keys.  For example,\n   the criteria DELETED FROM \"SMITH\" SINCE 1-Feb-1994 refers to all\n   deleted messages from Smith with INTERNALDATE greater than February\n   1, 1994.  A search key can also be a parenthesized list of one or\n   more search keys (e.g., for use with the OR and NOT keys).\n   Server implementations MAY exclude [MIME-IMB] body parts with\n   terminal content media types other than TEXT and MESSAGE from\n   consideration in SEARCH matching.\n   The OPTIONAL [CHARSET] specification consists of the word \"CHARSET\"\n   followed by the name of a character set from the registry\n   [CHARSET-REG].  It indicates the [CHARSET] of the strings that appear\n   in the search criteria.  [MIME-IMB] content transfer encodings and\n   [MIME-HDRS] strings in [RFC5322]/[MIME-IMB] headers MUST be decoded\n   before comparing text.  Servers MUST support US-ASCII and UTF-8\n   charsets; other CHARSETs MAY be supported.  Clients SHOULD use UTF-8.\n   Note that if CHARSET is not provided, IMAP4rev2 servers MUST assume\n   UTF-8, so selecting CHARSET UTF-8 is redundant.  It is permitted for\n   improved compatibility with existing IMAP4rev1 clients.\n   If the server does not support the specified [CHARSET], it MUST\n   return a tagged NO response (not a BAD).  This response SHOULD\n   contain the BADCHARSET response code, which MAY list the CHARSETs\n   supported by the server.\n   In all search keys that use strings, and unless otherwise specified,\n   a message matches the key if the string is a substring of the\n   associated text.  The matching SHOULD be case insensitive for\n   characters within the ASCII range.  Consider using [IMAP-I18N] for\n   language-sensitive, case-insensitive searching.  Note that the empty\n   string is a substring; this is useful when performing a HEADER search\n   in order to test for a header field presence in the message.\n   The defined search keys are as follows.  Refer to \"Formal Syntax\"\n   (Section 9) for the precise syntactic definitions of the arguments.\n   <sequence set>\n      Messages with message sequence numbers corresponding to the\n      specified message sequence number set.\n   ALL\n      All messages in the mailbox; the default initial key for ANDing.\n   ANSWERED\n      Messages with the \\Answered flag set.\n   BCC <string>\n      Messages that contain the specified string in the envelope\n      structure's Blind Carbon Copy (BCC) field.\n   BEFORE <date>\n      Messages whose internal date (disregarding time and timezone) is\n      earlier than the specified date.\n   BODY <string>\n      Messages that contain the specified string in the body of the\n      message.  Unlike TEXT (see below), this doesn't match any header\n      fields.  Servers are allowed to implement flexible matching for\n      this search key, for example, by matching \"swim\" to both \"swam\"\n      and \"swum\" in English language text or only performing full word\n      matching (where \"swim\" will not match \"swimming\").\n   CC <string>\n      Messages that contain the specified string in the envelope\n      structure's CC field.\n   DELETED\n      Messages with the \\Deleted flag set.\n   DRAFT\n      Messages with the \\Draft flag set.\n   FLAGGED\n      Messages with the \\Flagged flag set.\n   FROM <string>\n      Messages that contain the specified string in the envelope\n      structure's FROM field.\n   HEADER <field-name> <string>\n      Messages that have a header field with the specified field-name\n      (as defined in [RFC5322]) and that contain the specified string in\n      the text of the header field (what comes after the colon).  If the\n      string to search is zero-length, this matches all messages that\n      have a header field with the specified field-name regardless of\n      the contents.  Servers should use a substring search for this\n      SEARCH item, as clients can use it for automatic processing not\n      initiated by end users.  For example, this can be used when\n      searching for Message-ID or Content-Type header field values that\n      need to be exact or for searches in header fields that the IMAP\n      server might not know anything about.\n   KEYWORD <flag>\n      Messages with the specified keyword flag set.\n   LARGER <n>\n      Messages with an RFC822.SIZE larger than the specified number of\n      octets.\n   NOT <search-key>\n      Messages that do not match the specified search key.\n   ON <date>\n      Messages whose internal date (disregarding time and timezone) is\n      within the specified date.\n   OR <search-key1> <search-key2>\n      Messages that match either search key.\n   SEEN\n      Messages that have the \\Seen flag set.\n   SENTBEFORE <date>\n      Messages whose [RFC5322] Date: header field (disregarding time and\n      timezone) is earlier than the specified date.\n   SENTON <date>\n      Messages whose [RFC5322] Date: header field (disregarding time and\n      timezone) is within the specified date.\n   SENTSINCE <date>\n      Messages whose [RFC5322] Date: header field (disregarding time and\n      timezone) is within or later than the specified date.\n   SINCE <date>\n      Messages whose internal date (disregarding time and timezone) is\n      within or later than the specified date.\n   SMALLER <n>\n      Messages with an RFC822.SIZE smaller than the specified number of\n      octets.\n   SUBJECT <string>\n      Messages that contain the specified string in the envelope\n      structure's SUBJECT field.\n   TEXT <string>\n      Messages that contain the specified string in the header\n      (including MIME header fields) or body of the message.  Servers\n      are allowed to implement flexible matching for this search key,\n      for example, matching \"swim\" to both \"swam\" and \"swum\" in English\n      language text or only performing full-word matching (where \"swim\"\n      will not match \"swimming\").\n   TO <string>\n      Messages that contain the specified string in the envelope\n      structure's TO field.\n   UID <sequence set>\n      Messages with unique identifiers corresponding to the specified\n      unique identifier set.  Sequence-set ranges are permitted.\n   UNANSWERED\n      Messages that do not have the \\Answered flag set.\n   UNDELETED\n      Messages that do not have the \\Deleted flag set.\n   UNDRAFT\n      Messages that do not have the \\Draft flag set.\n   UNFLAGGED\n      Messages that do not have the \\Flagged flag set.\n   UNKEYWORD <flag>\n      Messages that do not have the specified keyword flag set.\n   UNSEEN\n      Messages that do not have the \\Seen flag set.\n   Example:\n     C: A282 SEARCH RETURN (MIN COUNT) FLAGGED\n         SINCE 1-Feb-1994 NOT FROM \"Smith\"\n     S: * ESEARCH (TAG \"A282\") MIN 2 COUNT 3\n     S: A282 OK SEARCH completed\n   Example:\n     C: A283 SEARCH RETURN () FLAGGED\n         SINCE 1-Feb-1994 NOT FROM \"Smith\"\n     S: * ESEARCH (TAG \"A283\") ALL 2,10:11\n     S: A283 OK SEARCH completed\n   Example:\n     C: A284 SEARCH TEXT \"string not in mailbox\"\n     S: * ESEARCH (TAG \"A284\")\n     S: A284 OK SEARCH completed\n     C: A285 SEARCH CHARSET UTF-8 TEXT {12}\n     S: + Ready for literal text\n     C: \u043e\u0442\u043f\u0443\u0441\u043a\n     S: * ESEARCH (TAG \"A285\") ALL 43\n     S: A285 OK SEARCH completed\n   The following example demonstrates finding the first unseen message\n   in the mailbox:\n   Example:\n     C: A284 SEARCH RETURN (MIN) UNSEEN\n     S: * ESEARCH (TAG \"A284\") MIN 4\n     S: A284 OK SEARCH completed\n   The following example demonstrates that if the ESEARCH UID indicator\n   is present, all data in the ESEARCH response is referring to UIDs;\n   for example, the MIN result specifier will be followed by a UID.\n   Example:\n     C: A285 UID SEARCH RETURN (MIN MAX) 1:5000\n     S: * ESEARCH (TAG \"A285\") UID MIN 7 MAX 3800\n     S: A285 OK SEARCH completed\n   The following example demonstrates returning the number of deleted\n   messages:\n   Example:\n     C: A286 SEARCH RETURN (COUNT) DELETED\n     S: * ESEARCH (TAG \"A286\") COUNT 15\n     S: A286 OK SEARCH completed\n6.4.4.1.  SAVE Result Option and SEARCH Result Variable\n   Upon successful completion of a SELECT or an EXAMINE command (after\n   the tagged OK response), the current search result variable is reset\n   to the empty sequence.\n   A successful SEARCH command with the SAVE result option sets the\n   value of the search result variable to the list of messages found in\n   the SEARCH command.  For example, if no messages were found, the\n   search result variable will contain the empty sequence.\n   Any of the following SEARCH commands MUST NOT change the search\n   result variable:\n      a SEARCH command that caused the server to return the BAD tagged\n      response,\n      a SEARCH command with no SAVE result option that caused the server\n      to return NO tagged response, and\n      a successful SEARCH command with no SAVE result option.\n   A SEARCH command with the SAVE result option that caused the server\n   to return the NO tagged response sets the value of the search result\n   variable to the empty sequence.\n   When a message listed in the search result variable is EXPUNGEd, it\n   is automatically removed from the list.  Implementors are reminded\n   that if the server stores the list as a list of message numbers, it\n   MUST automatically adjust them when notifying the client about\n   expunged messages, as described in Section 7.5.1.\n   If the server decides to send a new UIDVALIDITY value while the\n   mailbox is opened, it causes the resetting of the search variable to\n   the empty sequence.\n   Note that even if the \"$\" marker contains the empty sequence of\n   messages, it must be treated by all commands accepting message sets\n   as parameters as a valid, but non-matching, list of messages.  For\n   example, the \"FETCH $\" command would return a tagged OK response and\n   no FETCH responses.  See also Example 5 in Section 6.4.4.4.\n   The SAVE result option doesn't change whether the server would return\n   items corresponding to MIN, MAX, ALL, or COUNT result options.\n   When the SAVE result option is combined with the MIN or MAX result\n   option, and both ALL and COUNT result options are absent, the\n   corresponding MIN/MAX is returned (if the search result is not\n   empty), but the \"$\" marker would contain a single message as returned\n   in the MIN/MAX return item.\n   If the SAVE result option is combined with both MIN and MAX result\n   options, and both ALL and COUNT result options are absent, the \"$\"\n   marker would contain zero messages, one message, or two messages as\n   returned in the MIN/MAX return items.\n   If the SAVE result option is combined with the ALL and/or COUNT\n   result option(s), the \"$\" marker would always contain all messages\n   found by the SEARCH or UID SEARCH command.\n   The following table summarizes the additional requirement on ESEARCH\n   server implementations described in this section.\n           +==============================+====================+\n           | Combination of Result Option |  \"$\" Marker Value  |\n           +==============================+====================+\n           |           SAVE MIN           |        MIN         |\n           +------------------------------+--------------------+\n           |           SAVE MAX           |        MAX         |\n           +------------------------------+--------------------+\n           |         SAVE MIN MAX         |     MIN & MAX      |\n           +------------------------------+--------------------+\n           |          SAVE * [m]          | all found messages |\n           +------------------------------+--------------------+\n                                  Table 4\n   where '*' means \"ALL\" and/or \"COUNT\", and '[m]' means optional \"MIN\"\n   and/or \"MAX\"\n   Implementation note: server implementors should note that \"$\" can\n   reference IMAP message sequences or UID sequences, depending on the\n   context where it is used.  For example, the \"$\" marker can be set as\n   a result of a SEARCH (SAVE) command and used as a parameter to a UID\n   FETCH command (which accepts a UID sequence, not a message sequence),\n   or the \"$\" marker can be set as a result of a UID SEARCH (SAVE)\n   command and used as a parameter to a FETCH command (which accepts a\n   message sequence, not a UID sequence).  Server implementations need\n   to automatically map the \"$\" marker value to message numbers or UIDs,\n   depending on the context where the \"$\" marker is used.\n6.4.4.2.  Multiple Commands in Progress\n   Use of a SEARCH RETURN (SAVE) command followed by a command using the\n   \"$\" marker creates direct dependency between the two commands.  As\n   directed by Section 5.5, a server MUST execute the two commands in\n   the order they were received.\n   A client MAY pipeline a SEARCH RETURN (SAVE) command with one or more\n   commands using the \"$\" marker, as long as this doesn't create an\n   ambiguity, as described in Section 5.5.  Examples 7-9 in\n   Section 6.4.4.4 explain this in more details.\n6.4.4.3.  Refusing to Save Search Results\n   In some cases, the server MAY refuse to save a SEARCH (SAVE) result,\n   for example, if an internal limit on the number of saved results is\n   reached.  In this case, the server MUST return a tagged NO response\n   containing the NOTSAVED response code and set the search result\n   variable to the empty sequence, as described in Section 6.4.4.1.\n6.4.4.4.  Examples Showing Use of the SAVE Result Option\n   Only in this section: explanatory comments in examples that start\n   with // are not part of the protocol.\n   1.  The following example demonstrates how the client can use the\n       result of a SEARCH command to FETCH headers of interesting\n       messages:\n       Example 1:\n        C: A282 SEARCH RETURN (SAVE) FLAGGED SINCE 1-Feb-1994\n            NOT FROM \"Smith\"\n        S: A282 OK SEARCH completed, result saved\n        C: A283 FETCH $ (UID INTERNALDATE FLAGS BODY.PEEK[HEADER])\n        S: * 2 FETCH (UID 14 ...\n        S: * 84 FETCH (UID 100 ...\n        S: * 882 FETCH (UID 1115 ...\n        S: A283 OK completed\n       The client can also pipeline the two commands:\n       Example 2:\n        C: A282 SEARCH RETURN (SAVE) FLAGGED SINCE 1-Feb-1994\n            NOT FROM \"Smith\"\n        C: A283 FETCH $ (UID INTERNALDATE FLAGS BODY.PEEK[HEADER])\n        S: A282 OK SEARCH completed\n        S: * 2 FETCH (UID 14 ...\n        S: * 84 FETCH (UID 100 ...\n        S: * 882 FETCH (UID 1115 ...\n        S: A283 OK completed\n   2.  The following example demonstrates that the result of one SEARCH\n       command can be used as input to another SEARCH command:\n       Example 3:\n        C: A300 SEARCH RETURN (SAVE) SINCE 1-Jan-2004\n            NOT FROM \"Smith\"\n        S: A300 OK SEARCH completed\n        C: A301 UID SEARCH UID $ SMALLER 4096\n        S: * ESEARCH (TAG \"A301\") UID ALL 17,900,901\n        S: A301 OK completed\n       Note that the second command in Example 3 can be replaced with:\n        C: A301 UID SEARCH $ SMALLER 4096\n       and the result of the command would be the same.\n   3.  The following example shows that the \"$\" marker can be combined\n       with other message numbers using the OR SEARCH criterion.\n       Example 4:\n        C: P282 SEARCH RETURN (SAVE) SINCE 1-Feb-1994\n            NOT FROM \"Smith\"\n        S: P282 OK SEARCH completed\n        C: P283 SEARCH CHARSET UTF-8 (OR $ 1,3000:3021) TEXT {8+}\n        C: \u043c\u0430\u0442\u044c\n        S: * ESEARCH (TAG \"P283\") ALL 882,1102,3003,3005:3006\n        S: P283 OK completed\n   4.  The following example demonstrates that a failed SEARCH sets the\n       search result variable to the empty list.  The server doesn't\n       implement the KOI8-R charset.\n       Example 5:\n        C: B282 SEARCH RETURN (SAVE) SINCE 1-Feb-1994\n            NOT FROM \"Smith\"\n        S: B282 OK SEARCH completed\n        C: B283 SEARCH RETURN (SAVE) CHARSET KOI8-R\n            (OR $ 1,3000:3021) TEXT {4}\n        C: XXXX\n        S: B283 NO [BADCHARSET UTF-8] KOI8-R is not supported\n       //After this command, the saved result variable contains\n       //no messages.  A client that wants to reissue the B283\n       //SEARCH command with another CHARSET would have to reissue\n       //the B282 command as well.  One possible workaround for\n       //this is to include the desired CHARSET parameter\n       //in the earliest SEARCH RETURN (SAVE) command in a\n       //sequence of related SEARCH commands, to cause\n       //the earliest SEARCH in the sequence to fail.\n       //A better approach might be to always use CHARSET UTF-8\n       //instead.\n       Note: Since this document format is restricted to 7-bit ASCII\n       text, it is not possible to show actual KOI8-R data.  The \"XXXX\"\n       is a placeholder for what would be 4 octets of 8-bit data in an\n       actual transaction.\n   5.  The following example demonstrates that it is not an error to use\n       the \"$\" marker when it contains no messages.\n       Example 6:\n        C: E282 SEARCH RETURN (SAVE) SINCE 28-Oct-2006\n            NOT FROM \"Eric\"\n        C: E283 COPY $ \"Other Messages\"\n       //The \"$\" contains no messages\n        S: E282 OK SEARCH completed\n        S: E283 OK COPY completed, nothing copied\n       Example 7:\n        C: F282 SEARCH RETURN (SAVE) KEYWORD $Junk\n        C: F283 COPY $ \"Junk\"\n        C: F284 STORE $ +FLAGS.Silent (\\Deleted)\n        S: F282 OK SEARCH completed\n        S: F283 OK COPY completed\n        S: F284 OK STORE completed\n       Example 8:\n        C: G282 SEARCH RETURN (SAVE) KEYWORD $Junk\n        C: G283 SEARCH RETURN (ALL) SINCE 28-Oct-2006\n            FROM \"Eric\"\n       // The server can execute the two SEARCH commands\n       // in any order, as they don't have any dependency.\n       // For example, it may return:\n        S: * ESEARCH (TAG \"G283\") ALL 3:15,27,29:103\n        S: G283 OK SEARCH completed\n        S: G282 OK SEARCH completed\n       The following example demonstrates that the result of the second\n       SEARCH RETURN (SAVE) always overrides the result of the first.\n       Example 9:\n        C: H282 SEARCH RETURN (SAVE) KEYWORD $Junk\n        C: H283 SEARCH RETURN (SAVE) SINCE 28-Oct-2006\n            FROM \"Eric\"\n        S: H282 OK SEARCH completed\n        S: H283 OK SEARCH completed\n       // At this point \"$\" would contain results of H283\n       The following example demonstrates behavioral difference for\n       different combinations of ESEARCH result options.\n       Example 10:\n        C: C282 SEARCH RETURN (ALL) SINCE 12-Feb-2006\n            NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C283\") ALL 2,10:15,21\n      //$ value hasn't changed\n        S: C282 OK SEARCH completed\n        C: C283 SEARCH RETURN (ALL SAVE) SINCE 12-Feb-2006\n            NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C283\") ALL 2,10:15,21\n      //$ value is 2,10:15,21\n        S: C283 OK SEARCH completed\n        C: C284 SEARCH RETURN (SAVE MIN) SINCE 12-Feb-2006\n            NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C284\") MIN 2\n      //$ value is 2\n        S: C284 OK SEARCH completed\n        C: C285 SEARCH RETURN (MAX SAVE MIN) SINCE\n            12-Feb-2006 NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C285\") MIN 2 MAX 21\n      //$ value is 2,21\n        S: C285 OK SEARCH completed\n        C: C286 SEARCH RETURN (MAX SAVE MIN COUNT)\n            SINCE 12-Feb-2006 NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C286\") MIN 2 MAX 21 COUNT 8\n      //$ value is 2,10:15,21\n        S: C286 OK SEARCH completed\n        C: C286 SEARCH RETURN (ALL SAVE MIN) SINCE\n            12-Feb-2006 NOT FROM \"Smith\"\n        S: * ESEARCH (TAG \"C286\") MIN 2 ALL 2,10:15,21\n      //$ value is 2,10:15,21\n        S: C286 OK SEARCH completed\n6.4.5.  FETCH Command\n   Arguments:    sequence set\n                 message data item names or macro\n   Responses:    untagged responses:  FETCH\n   Result:       OK -  fetch completed\n                 NO -  fetch error: can't fetch that data\n                 BAD -  command unknown or arguments invalid\n   The FETCH command retrieves data associated with a message in the\n   mailbox.  The data items to be fetched can be either a single atom or\n   a parenthesized list.\n   Most data items, identified in the formal syntax (Section 9) under\n   the msg-att-static rule, are static and MUST NOT change for any\n   particular message.  Other data items, identified in the formal\n   syntax under the msg-att-dynamic rule, MAY change either as a result\n   of a STORE command or due to external events.\n      For example, if a client receives an ENVELOPE for a message when\n      it already knows the envelope, it can safely ignore the newly\n      transmitted envelope.\n   There are three macros that specify commonly used sets of data items\n   and can be used instead of data items.  A macro must be used by\n   itself and not in conjunction with other macros or data items.\n   ALL\n      Macro equivalent to: (FLAGS INTERNALDATE RFC822.SIZE ENVELOPE)\n   FAST\n      Macro equivalent to: (FLAGS INTERNALDATE RFC822.SIZE)\n   FULL\n      Macro equivalent to: (FLAGS INTERNALDATE RFC822.SIZE ENVELOPE\n      BODY)\n   Several data items reference \"section\" or \"section-binary\".  See\n   Section 6.4.5.1 for their detailed definition.\n   The currently defined data items that can be fetched are:\n   BINARY[<section-binary>]<<partial>>\n      Requests that the specified section be transmitted after\n      performing decoding of the section's Content-Transfer-Encoding.\n      The <partial> argument, if present, requests that a subset of the\n      data be returned.  The semantics of a partial FETCH BINARY command\n      are the same as for a partial FETCH BODY command, with the\n      exception that the <partial> arguments refer to the DECODED\n      section data.\n      Note that this data item can only be requested for leaf body\n      parts: those that have media types other than multipart/*,\n      message/rfc822, or message/global.\n   BINARY.PEEK[<section-binary>]<<partial>>\n      An alternate form of BINARY[<section-binary>] that does not\n      implicitly set the \\Seen flag.\n   BINARY.SIZE[<section-binary>]\n      Requests the decoded size of the section (i.e., the size to expect\n      in response to the corresponding FETCH BINARY request).\n      Note: client authors are cautioned that this might be an expensive\n      operation for some server implementations.  Needlessly issuing\n      this request could result in degraded performance due to servers\n      having to calculate the value every time the request is issued.\n      Note that this data item can only be requested for leaf body\n      parts: those that have media types other than multipart/*,\n      message/rfc822, or message/global.\n   BODY\n      Non-extensible form of BODYSTRUCTURE.\n   BODY[<section>]<<partial>>\n      The text of a particular body section.  If BODY[] is specified\n      (the section specification is omitted), the FETCH is requesting\n      the [RFC5322] expression of the entire message.\n      It is possible to fetch a substring of the designated text.  This\n      is done by appending an open angle bracket (\"<\"), the octet\n      position of the first desired octet, a period, the maximum number\n      of octets desired, and a close angle bracket (\">\") to the part\n      specifier.  If the starting octet is beyond the end of the text,\n      an empty string is returned.\n      Any partial fetch that attempts to read beyond the end of the text\n      is truncated as appropriate.  A partial fetch that starts at octet\n      0 is returned as a partial fetch, even if this truncation\n      happened.\n         Note: This means that BODY[]<0.2048> of a 1500-octet message\n         will return BODY[]<0> with a literal of size 1500, not BODY[].\n         Note: A substring fetch of a HEADER.FIELDS or HEADER.FIELDS.NOT\n         part specifier is calculated after subsetting the header.\n      The \\Seen flag is implicitly set; if this causes the flags to\n      change, they SHOULD be included as part of the FETCH responses.\n   BODY.PEEK[<section>]<<partial>>\n      An alternate form of BODY[<section>] that does not implicitly set\n      the \\Seen flag.\n   BODYSTRUCTURE\n      The [MIME-IMB] body structure of the message.  This is computed by\n      the server by parsing the [MIME-IMB] header fields in the\n      [RFC5322] header and [MIME-IMB] headers.  See Section 7.5.2 for\n      more details.\n   ENVELOPE\n      The envelope structure of the message.  This is computed by the\n      server by parsing the [RFC5322] header into the component parts,\n      defaulting various fields as necessary.  See Section 7.5.2 for\n      more details.\n   FLAGS\n      The flags that are set for this message.\n   INTERNALDATE\n      The internal date of the message.\n   RFC822.SIZE\n      The size of the message, as defined in Section 2.3.4.\n   UID\n      The unique identifier for the message.\n   Example:\n     C: A654 FETCH 2:4 (FLAGS BODY[HEADER.FIELDS (DATE FROM)])\n     S: * 2 FETCH ....\n     S: * 3 FETCH ....\n     S: * 4 FETCH ....\n     S: A654 OK FETCH completed\n6.4.5.1.  FETCH Section Specification\n   Several FETCH data items reference \"section\" or \"section-binary\".\n   The section specification is a set of zero or more part specifiers\n   delimited by periods.  A part specifier is either a part number or\n   one of the following: HEADER, HEADER.FIELDS, HEADER.FIELDS.NOT, MIME,\n   and TEXT.  (Non-numeric part specifiers have to be the last specifier\n   in a section specification.)  An empty section specification refers\n   to the entire message, including the header.\n   Every message has at least one part number.  Messages that do not use\n   MIME, and MIME messages that are not multipart and have no\n   encapsulated message within them, only have a part 1.\n   Multipart messages are assigned consecutive part numbers, as they\n   occur in the message.  If a particular part is of type message or\n   multipart, its parts MUST be indicated by a period followed by the\n   part number within that nested multipart part.\n   A part of type MESSAGE/RFC822 or MESSAGE/GLOBAL also has nested part\n   numbers, referring to parts of the MESSAGE part's body.\n   The HEADER, HEADER.FIELDS, HEADER.FIELDS.NOT, and TEXT part\n   specifiers can be the sole part specifier or can be prefixed by one\n   or more numeric part specifiers, provided that the numeric part\n   specifier refers to a part of type MESSAGE/RFC822 or MESSAGE/GLOBAL.\n   The MIME part specifier MUST be prefixed by one or more numeric part\n   specifiers.\n   The HEADER, HEADER.FIELDS, and HEADER.FIELDS.NOT part specifiers\n   refer to the [RFC5322] header of the message or of an encapsulated\n   [MIME-IMT] MESSAGE/RFC822 or MESSAGE/GLOBAL message.  HEADER.FIELDS\n   and HEADER.FIELDS.NOT are followed by a list of field-names (as\n   defined in [RFC5322]) and return a subset of the header.  The subset\n   returned by HEADER.FIELDS contains only those header fields with a\n   field-name that matches one of the names in the list; similarly, the\n   subset returned by HEADER.FIELDS.NOT contains only the header fields\n   with a non-matching field-name.  The field-matching is ASCII-range\n   case insensitive but is otherwise exact.  Subsetting does not exclude\n   the [RFC5322] delimiting blank line between the header and the body;\n   the blank line is included in all header fetches, except in the case\n   of a message that has no body and no blank line.\n   The MIME part specifier refers to the [MIME-IMB] header for this\n   part.\n   The TEXT part specifier refers to the text body of the message,\n   omitting the [RFC5322] header.\n   Here is an example of a complex message with some of its part\n   specifiers:\n     HEADER     ([RFC5322] header of the message)\n     TEXT       ([RFC5322] text body of the message) MULTIPART/MIXED\n     1          TEXT/PLAIN\n     2          APPLICATION/OCTET-STREAM\n     3          MESSAGE/RFC822\n     3.HEADER   ([RFC5322] header of the message)\n     3.TEXT     ([RFC5322] text body of the message) MULTIPART/MIXED\n     3.1        TEXT/PLAIN\n     3.2        APPLICATION/OCTET-STREAM\n     4          MULTIPART/MIXED\n     4.1        IMAGE/GIF\n     4.1.MIME   ([MIME-IMB] header for the IMAGE/GIF)\n     4.2        MESSAGE/RFC822\n     4.2.HEADER ([RFC5322] header of the message)\n     4.2.TEXT   ([RFC5322] text body of the message) MULTIPART/MIXED\n     4.2.1      TEXT/PLAIN\n     4.2.2      MULTIPART/ALTERNATIVE\n     4.2.2.1    TEXT/PLAIN\n     4.2.2.2    TEXT/RICHTEXT\n6.4.6.  STORE Command\n   Arguments:    sequence set\n                 message data item name\n                 value for message data item\n   Responses:    untagged responses:  FETCH\n   Result:       OK -  store completed\n                 NO -  store error: can't store that data\n                 BAD -  command unknown or arguments invalid\n   The STORE command alters data associated with a message in the\n   mailbox.  Normally, STORE will return the updated value of the data\n   with an untagged FETCH response.  A suffix of \".SILENT\" in the data\n   item name prevents the untagged FETCH, and the server SHOULD assume\n   that the client has determined the updated value itself or does not\n   care about the updated value.\n      Note: Regardless of whether or not the \".SILENT\" suffix was used,\n      the server SHOULD send an untagged FETCH response if a change to a\n      message's flags from an external source is observed.  The intent\n      is that the status of the flags is determinate without a race\n      condition.\n   The currently defined data items that can be stored are:\n   FLAGS <flag list>\n      Replace the flags for the message with the argument.  The new\n      value of the flags is returned as if a FETCH of those flags was\n      done.\n   FLAGS.SILENT <flag list>\n      Equivalent to FLAGS, but without returning a new value.\n   +FLAGS <flag list>\n      Add the argument to the flags for the message.  The new value of\n      the flags is returned as if a FETCH of those flags was done.\n   +FLAGS.SILENT <flag list>\n      Equivalent to +FLAGS, but without returning a new value.\n   -FLAGS <flag list>\n      Remove the argument from the flags for the message.  The new value\n      of the flags is returned as if a FETCH of those flags was done.\n   -FLAGS.SILENT <flag list>\n      Equivalent to -FLAGS, but without returning a new value.\n   Example:\n     C: A003 STORE 2:4 +FLAGS (\\Deleted)\n     S: * 2 FETCH (FLAGS (\\Deleted \\Seen))\n     S: * 3 FETCH (FLAGS (\\Deleted))\n     S: * 4 FETCH (FLAGS (\\Deleted \\Flagged \\Seen))\n     S: A003 OK STORE completed\n6.4.7.  COPY Command\n   Arguments:    sequence set\n                 mailbox name\n   Responses:    no specific responses for this command\n   Result:       OK -  copy completed\n                 NO -  copy error: can't copy those messages or to that\n                    name\n                 BAD -  command unknown or arguments invalid\n   The COPY command copies the specified message(s) to the end of the\n   specified destination mailbox.  The flags and internal date of the\n   message(s) SHOULD be preserved in the copy.\n   If the destination mailbox does not exist, a server MUST return an\n   error.  It MUST NOT automatically create the mailbox.  Unless it is\n   certain that the destination mailbox can not be created, the server\n   MUST send the response code \"[TRYCREATE]\" as the prefix of the text\n   of the tagged NO response.  This gives a hint to the client that it\n   can attempt a CREATE command and retry the COPY if the CREATE is\n   successful.\n   If the COPY command is unsuccessful for any reason, server\n   implementations MUST restore the destination mailbox to its state\n   before the COPY attempt (other than possibly incrementing UIDNEXT),\n   i.e., partial copy MUST NOT be done.\n   On successful completion of a COPY, the server returns a COPYUID\n   response code (see Section 7.1).  Two exceptions to this requirement\n   are listed below.\n   In the case of a mailbox that has permissions set so that the client\n   can COPY to the mailbox, but not SELECT or EXAMINE it, the server\n   MUST NOT send a COPYUID response code as it would disclose\n   information about the mailbox.\n   In the case of a mailbox that has UIDNOTSTICKY status (see\n   Section 7.1), the server MAY omit the COPYUID response code as it is\n   not meaningful.\n   Example:\n     C: A003 COPY 2:4 MEETING\n     S: A003 OK [COPYUID 38505 304,319:320 3956:3958] COPY completed\n6.4.8.  MOVE Command\n   Arguments:    sequence set\n                 mailbox name\n   Responses:    no specific responses for this command\n   Result:       OK -  move completed\n                 NO -  move error: can't move those messages or to that\n                    name\n                 BAD -  command unknown or arguments invalid\n   The MOVE command moves the specified message(s) to the end of the\n   specified destination mailbox.  The flags and internal date of the\n   message(s) SHOULD be preserved.\n   This means that a new message is created in the target mailbox with a\n   new UID, the original message is removed from the source mailbox, and\n   it appears to the client as a single action.  This has the same\n   effect for each message as this sequence:\n   1.  [UID] COPY\n   2.  [UID] STORE +FLAGS.SILENT \\DELETED\n   3.  UID EXPUNGE\n   Although the effect of the MOVE is the same as the preceding steps,\n   the semantics are not identical: the intermediate states produced by\n   those steps do not occur, and the response codes are different.  In\n   particular, though the COPY and EXPUNGE response codes will be\n   returned, response codes for a STORE MUST NOT be generated, and the\n   \\Deleted flag MUST NOT be set for any message.\n   Unlike the COPY command, MOVE of a set of messages might fail partway\n   through the set.  Regardless of whether the command is successful in\n   moving the entire set, each individual message MUST be either moved\n   or unaffected.  The server MUST leave each message in a state where\n   it is in at least one of the source or target mailboxes (no message\n   can be lost or orphaned).  The server SHOULD NOT leave any message in\n   both mailboxes (it would be bad for a partial failure to result in a\n   bunch of duplicate messages).  This is true even if the server\n   returns a tagged NO response to the command.\n   If the destination mailbox does not exist, a server MUST return an\n   error.  It MUST NOT automatically create the mailbox.  Unless it is\n   certain that the destination mailbox cannot be created, the server\n   MUST send the response code \"[TRYCREATE]\" as the prefix of the text\n   of the tagged NO response.  This gives a hint to the client that it\n   can attempt a CREATE command and retry the MOVE if the CREATE is\n   successful.\n   Because of the similarity of MOVE to COPY, extensions that affect\n   COPY affect MOVE in the same way.  Response codes listed in\n   Section 7.1, as well as those defined by extensions, are sent as\n   indicated for COPY.\n   Servers send COPYUID in response to a MOVE or a UID MOVE (see\n   Section 6.4.9) command.  For additional information about COPYUID,\n   see Section 7.1.  Note that there are several exceptions listed in\n   Section 6.4.7 that allow servers not to return COPYUID.\n   Servers are also REQUIRED to send the COPYUID response code in an\n   untagged OK before sending EXPUNGE or similar responses.  (Sending\n   COPYUID in the tagged OK, as described in Section 6.4.7, means that\n   clients first receive an EXPUNGE for a message and afterwards COPYUID\n   for the same message.  It can be unnecessarily difficult to process\n   that sequence usefully.)\n   An example:\n     C: a UID MOVE 42:69 foo\n     S: * OK [COPYUID 432432 42:69 1202:1229]\n     S: * 22 EXPUNGE\n     ...More EXPUNGE responses from the server...\n     S: a OK Done\n   Note that the server may send unrelated EXPUNGE responses as well, if\n   any happen to have been expunged at the same time; this is normal\n   IMAP operation.\n   Note that moving a message to the currently selected mailbox (that\n   is, where the source and target mailboxes are the same) is allowed\n   when copying the message to the currently selected mailbox is\n   allowed.\n   The server may send EXPUNGE responses before the tagged response, so\n   the client cannot safely send more commands with message sequence\n   number arguments while the server is processing MOVE.\n   MOVE and UID MOVE can be pipelined with other commands, but care has\n   to be taken.  Both commands modify sequence numbers and also allow\n   unrelated EXPUNGE responses.  The renumbering of other messages in\n   the source mailbox following any EXPUNGE response can be surprising\n   and makes it unsafe to pipeline any command that relies on message\n   sequence numbers after a MOVE or UID MOVE.  Similarly, MOVE cannot be\n   pipelined with a command that might cause message renumbering.  See\n   Section 5.5 for more information about ambiguities as well as\n   handling requirements for both clients and servers.\n6.4.9.  UID Command\n   Arguments:    command name\n                 command arguments\n   Responses:    untagged responses:  FETCH, ESEARCH, EXPUNGE\n   Result:       OK -  UID command completed\n                 NO -  UID command error\n                 BAD -  command unknown or arguments invalid\n   The UID command has three forms.  In the first form, it takes as its\n   arguments a COPY, MOVE, FETCH, or STORE command with arguments\n   appropriate for the associated command.  However, the numbers in the\n   sequence-set argument are unique identifiers instead of message\n   sequence numbers.  Sequence-set ranges are permitted, but there is no\n   guarantee that unique identifiers will be contiguous.\n   A non-existent unique identifier is ignored without any error message\n   generated.  Thus, it is possible for a UID FETCH command to return an\n   OK without any data or a UID COPY, UID MOVE, or UID STORE to return\n   an OK without performing any operations.\n   In the second form, the UID command takes an EXPUNGE command with an\n   extra parameter that specifies a sequence set of UIDs to operate on.\n   The UID EXPUNGE command permanently removes all messages that have\n   both the \\Deleted flag set and a UID that is included in the\n   specified sequence set from the currently selected mailbox.  If a\n   message either does not have the \\Deleted flag set or has a UID that\n   is not included in the specified sequence set, it is not affected.\n   UID EXPUNGE is particularly useful for disconnected use clients.  By\n   using UID EXPUNGE instead of EXPUNGE when resynchronizing with the\n   server, the client can ensure that it does not inadvertently remove\n   any messages that have been marked as \\Deleted by other clients\n   between the time that the client was last connected and the time the\n   client resynchronizes.\n   Example:\n     C: A003 UID EXPUNGE 3000:3002\n     S: * 3 EXPUNGE\n     S: * 3 EXPUNGE\n     S: * 3 EXPUNGE\n     S: A003 OK UID EXPUNGE completed\n   In the third form, the UID command takes a SEARCH command with SEARCH\n   command arguments.  The interpretation of the arguments is the same\n   as with SEARCH; however, the numbers returned in an ESEARCH response\n   for a UID SEARCH command are unique identifiers instead of message\n   sequence numbers.  Also, the corresponding ESEARCH response MUST\n   include the UID indicator.  For example, the command UID SEARCH 1:100\n   UID 443:557 returns the unique identifiers corresponding to the\n   intersection of two sequence sets, the message sequence number range\n   1:100, and the UID range 443:557.\n      Note: in the above example, the UID range 443:557 appears.  The\n      same comment about a non-existent unique identifier being ignored\n      without any error message also applies here.  Hence, even if\n      neither UID 443 or 557 exist, this range is valid and would\n      include an existing UID 495.\n      Also note that a UID range of 559:* always includes the UID of the\n      last message in the mailbox, even if 559 is higher than any\n      assigned UID value.  This is because the contents of a range are\n      independent of the order of the range endpoints.  Thus, any UID\n      range with * as one of the endpoints indicates at least one\n      message (the message with the highest numbered UID), unless the\n      mailbox is empty.\n   The number after the \"*\" in an untagged FETCH or EXPUNGE response is\n   always a message sequence number, not a unique identifier, even for a\n   UID command response.  However, server implementations MUST\n   implicitly include the UID message data item as part of any FETCH\n   response caused by a UID command, regardless of whether a UID was\n   specified as a message data item to the FETCH.\n   Note: The rule about including the UID message data item as part of a\n   FETCH response primarily applies to the UID FETCH and UID STORE\n   commands, including a UID FETCH command that does not include UID as\n   a message data item.  Although it is unlikely that the other UID\n   commands will cause an untagged FETCH, this rule applies to these\n   commands as well.\n   Example:\n     C: A999 UID FETCH 4827313:4828442 FLAGS\n     S: * 23 FETCH (FLAGS (\\Seen) UID 4827313)\n     S: * 24 FETCH (FLAGS (\\Seen) UID 4827943)\n     S: * 25 FETCH (FLAGS (\\Seen) UID 4828442)\n     S: A999 OK UID FETCH completed\n6.5.  Client Commands - Experimental/Expansion\n   Each command that is not part of this specification MUST have at\n   least one capability name (see Section 6.1.1) associated with it.\n   (Multiple commands can be associated with the same capability name.)\n   Server implementations MUST NOT send any added untagged responses\n   (not specified in this specification), unless the client requested it\n   by issuing the associated experimental command (specified in an\n   extension document) or the ENABLE command (Section 6.3.1).\n   The following example demonstrates how a client can check for the\n   presence of a fictitious XPIG-LATIN capability that adds the XPIG-\n   LATIN command and the XPIG-LATIN untagged response.  (Note that for\n   an extension, the command name and the capability name don't have to\n   be the same.)\n   Example:\n     C: a441 CAPABILITY\n     S: * CAPABILITY IMAP4rev2 XPIG-LATIN\n     S: a441 OK CAPABILITY completed\n     C: A442 XPIG-LATIN\n     S: * XPIG-LATIN ow-nay eaking-spay ig-pay atin-lay\n     S: A442 OK XPIG-LATIN ompleted-cay\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"NotAuthenticated\", \"Authenticated\", \"Selected\", \"Logout\"],\n  \"transitions\": [\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive LOGIN\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive SELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive EXAMINE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive CLOSE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive UNSELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Any\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive STARTTLS\",\n      \"action\": \"reply OK\",\n      \"to\": \"NotAuthenticated\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 7. Server Responses",
      "prompt": "\nYou will be given the section \"Section 7. Server Responses\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nServer responses are in three forms: status responses, server data,\n   and command continuation requests.  The information contained in a\n   server response, identified by \"Contents:\" in the response\n   descriptions below, is described by function, not by syntax.  The\n   precise syntax of server responses is described in \"Formal Syntax\"\n   (Section 9).\n   The client MUST be prepared to accept any response at all times.\n   Status responses can be tagged or untagged.  Tagged status responses\n   indicate the completion result (OK, NO, or BAD status) of a client\n   command and have a tag matching the command.\n   Some status responses, and all server data, are untagged.  An\n   untagged response is indicated by the token \"*\" instead of a tag.\n   Untagged status responses indicate server greeting or server status\n   that does not indicate the completion of a command (for example, an\n   impending system shutdown alert).  For historical reasons, untagged\n   server data responses are also called \"unsolicited data\", although\n   strictly speaking, only unilateral server data is truly\n   \"unsolicited\".\n   Certain server data MUST be remembered by the client when it is\n   received; this is noted in the description of that data.  Such data\n   conveys critical information that affects the interpretation of all\n   subsequent commands and responses (e.g., updates reflecting the\n   creation or destruction of messages).\n   Other server data SHOULD be remembered for later reference; if the\n   client does not need to remember the data, or if remembering the data\n   has no obvious purpose (e.g., a SEARCH response when no SEARCH\n   command is in progress), the data can be ignored.\n   An example of unilateral untagged server data occurs when the IMAP\n   connection is in the selected state.  In the selected state, the\n   server checks the mailbox for new messages as part of command\n   execution.  Normally, this is part of the execution of every command;\n   hence, a NOOP command suffices to check for new messages.  If new\n   messages are found, the server sends an untagged EXISTS response\n   reflecting the new size of the mailbox.  Server implementations that\n   offer multiple simultaneous access to the same mailbox SHOULD also\n   send appropriate unilateral untagged FETCH and EXPUNGE responses if\n   another agent changes the state of any message flags or expunges any\n   messages.\n   Command continuation request responses use the token \"+\" instead of a\n   tag.  These responses are sent by the server to indicate acceptance\n   of an incomplete client command and readiness for the remainder of\n   the command.\n7.1.  Server Responses - Generic Status Responses\n   Status responses are OK, NO, BAD, PREAUTH, and BYE.  OK, NO, and BAD\n   can be tagged or untagged.  PREAUTH and BYE are always untagged.\n   Status responses MAY include an OPTIONAL \"response code\".  A response\n   code consists of data inside square brackets in the form of an atom,\n   possibly followed by a space and arguments.  The response code\n   contains additional information or status codes for client software\n   beyond the OK/NO/BAD condition and are defined when there is a\n   specific action that a client can take based upon the additional\n   information.\n   The currently defined response codes are:\n   ALERT\n      The human-readable text contains a special alert that is presented\n      to the user in a fashion that calls the user's attention to the\n      message.  Content of ALERT response codes received on a connection\n      without TLS or SASL security-layer confidentiality SHOULD be\n      ignored by clients.  If displayed, such alerts MUST be clearly\n      marked as potentially suspicious.  (Note that some existing\n      clients are known to hyperlink returned text, which make them very\n      dangerous.)  Alerts received after successful establishment of a\n      TLS/SASL confidentiality layer MUST be presented to the user.\n   ALREADYEXISTS\n      The operation attempts to create something that already exists,\n      such as when a CREATE or RENAME command attempts to create a\n      mailbox and there is already one of that name.\n        C: o356 RENAME this that\n        S: o356 NO [ALREADYEXISTS] Mailbox \"that\" already exists\n   APPENDUID\n      Followed by the UIDVALIDITY of the destination mailbox and the UID\n      assigned to the appended message in the destination mailbox, it\n      indicates that the message has been appended to the destination\n      mailbox with that UID.\n      If the server also supports the [MULTIAPPEND] extension, and if\n      multiple messages were appended in the APPEND command, then the\n      second value is a UID set containing the UIDs assigned to the\n      appended messages, in the order they were transmitted in the\n      APPEND command.  This UID set may not contain extraneous UIDs or\n      the symbol \"*\".\n         Note: the UID set form of the APPENDUID response code MUST NOT\n         be used if only a single message was appended.  In particular,\n         a server MUST NOT send a range such as 123:123.  This is\n         because a client that does not support [MULTIAPPEND] expects\n         only a single UID and not a UID set.\n      UIDs are assigned in strictly ascending order in the mailbox\n      (refer to Section 2.3.1.1); note that a range of 12:10 is exactly\n      equivalent to 10:12 and refers to the sequence 10,11,12.\n      This response code is returned in a tagged OK response to the\n      APPEND command.\n   AUTHENTICATIONFAILED\n      Authentication failed for some reason on which the server is\n      unwilling to elaborate.  Typically, this includes \"unknown user\"\n      and \"bad password\".\n      This is the same as not sending any response code, except that\n      when a client sees AUTHENTICATIONFAILED, it knows that the problem\n      wasn't, e.g., UNAVAILABLE, so there's no point in trying the same\n      login/password again later.\n        C: b LOGIN \"fred\" \"foo\"\n        S: b NO [AUTHENTICATIONFAILED] Authentication failed\n   AUTHORIZATIONFAILED\n      Authentication succeeded in using the authentication identity, but\n      the server cannot or will not allow the authentication identity to\n      act as the requested authorization identity.  This is only\n      applicable when the authentication and authorization identities\n      are different.\n        C: c1 AUTHENTICATE PLAIN\n        [...]\n        S: c1 NO [AUTHORIZATIONFAILED] No such authorization-ID\n        C: c2 AUTHENTICATE PLAIN\n        [...]\n        S: c2 NO [AUTHORIZATIONFAILED] Authenticator is not an admin\n   BADCHARSET\n      Optionally followed by a parenthesized list of charsets.  A SEARCH\n      failed because the given charset is not supported by this\n      implementation.  If the optional list of charsets is given, this\n      lists the charsets that are supported by this implementation.\n   CANNOT\n      This operation violates some invariant of the server and can never\n      succeed.\n        C: l create \"///////\"\n        S: l NO [CANNOT] Adjacent slashes are not supported\n   CAPABILITY\n      Followed by a list of capabilities.  This can appear in the\n      initial OK or PREAUTH response to transmit an initial capabilities\n      list.  It can also appear in tagged responses to LOGIN or\n      AUTHENTICATE commands.  This makes it unnecessary for a client to\n      send a separate CAPABILITY command if it recognizes this response\n      code and there was no change to the TLS and/or authentication\n      state since it was received.\n   CLIENTBUG\n      The server has detected a client bug.  This can accompany any of\n      OK, NO, and BAD, depending on what the client bug is.\n        C: k1 select \"/archive/projects/experiment-iv\"\n        [...]\n        S: k1 OK [READ-ONLY] Done\n        C: k2 status \"/archive/projects/experiment-iv\" (messages)\n        [...]\n        S: k2 OK [CLIENTBUG] Done\n   CLOSED\n      The CLOSED response code has no parameters.  A server returns the\n      CLOSED response code when the currently selected mailbox is closed\n      implicitly using the SELECT or EXAMINE command on another mailbox.\n      The CLOSED response code serves as a boundary between responses\n      for the previously opened mailbox (which was closed) and the newly\n      selected mailbox; all responses before the CLOSED response code\n      relate to the mailbox that was closed, and all subsequent\n      responses relate to the newly opened mailbox.\n      There is no need to return the CLOSED response code on completion\n      of the CLOSE or the UNSELECT command (or similar), whose purpose\n      is to close the currently selected mailbox without opening a new\n      one.\n   CONTACTADMIN\n      The user should contact the system administrator or support desk.\n        C: e login \"fred\" \"foo\"\n        S: e NO [CONTACTADMIN]\n   COPYUID\n      Followed by the UIDVALIDITY of the destination mailbox, a UID set\n      containing the UIDs of the message(s) in the source mailbox that\n      were copied to the destination mailbox, followed by another UID\n      set containing the UIDs assigned to the copied message(s) in the\n      destination mailbox, indicates that the message(s) has been copied\n      to the destination mailbox with the stated UID(s).\n      The source UID set is in the order the message(s) was copied; the\n      destination UID set corresponds to the source UID set and is in\n      the same order.  Neither of the UID sets may contain extraneous\n      UIDs or the symbol \"*\".\n      UIDs are assigned in strictly ascending order in the mailbox\n      (refer to Section 2.3.1.1); note that a range of 12:10 is exactly\n      equivalent to 10:12 and refers to the sequence 10,11,12.\n      This response code is returned in a tagged OK response to the COPY\n      or UID COPY command or in the untagged OK response to the MOVE or\n      UID MOVE command.\n   CORRUPTION\n      The server discovered that some relevant data (e.g., the mailbox)\n      are corrupt.  This response code does not include any information\n      about what's corrupt, but the server can write that to its\n      logfiles.\n        C: i select \"/archive/projects/experiment-iv\"\n        S: i NO [CORRUPTION] Cannot open mailbox\n   EXPIRED\n      Either authentication succeeded or the server no longer had the\n      necessary data; either way, access is no longer permitted using\n      that passphrase.  The client or user should get a new passphrase.\n        C: d login \"fred\" \"foo\"\n        S: d NO [EXPIRED] That password isn't valid any more\n   EXPUNGEISSUED\n      Someone else has issued an EXPUNGE for the same mailbox.  The\n      client may want to issue NOOP soon.  [IMAP-MULTIACCESS] discusses\n      this subject in depth.\n        C: h search from maria@example.com\n        S: * ESEARCH (TAG \"h\") ALL 1:3,5,8,13,21,42\n        S: h OK [EXPUNGEISSUED] Search completed\n   HASCHILDREN\n      The mailbox delete operation failed because the mailbox has one or\n      more children, and the server doesn't allow deletion of mailboxes\n      with children.\n        C: m356 DELETE Notes\n        S: o356 NO [HASCHILDREN] Mailbox \"Notes\" has children\n        that need to be deleted first\n   INUSE\n      An operation has not been carried out because it involves sawing\n      off a branch someone else is sitting on.  Someone else may be\n      holding an exclusive lock needed for this operation, or the\n      operation may involve deleting a resource someone else is using,\n      typically a mailbox.\n      The operation may succeed if the client tries again later.\n        C: g delete \"/archive/projects/experiment-iv\"\n        S: g NO [INUSE] Mailbox in use\n   LIMIT\n      The operation ran up against an implementation limit of some kind,\n      such as the number of flags on a single message or the number of\n      flags used in a mailbox.\n        C: m STORE 42 FLAGS f1 f2 f3 f4 f5 ... f250\n        S: m NO [LIMIT] At most 32 flags in one mailbox supported\n   NONEXISTENT\n      The operation attempts to delete something that does not exist.\n      Similar to ALREADYEXISTS.\n        C: p RENAME this that\n        S: p NO [NONEXISTENT] No such mailbox\n   NOPERM\n      The access control system (e.g., ACL; see [RFC4314]) does not\n      permit this user to carry out an operation, such as selecting or\n      creating a mailbox.\n        C: f select \"/archive/projects/experiment-iv\"\n        S: f NO [NOPERM] Access denied\n   OVERQUOTA\n      The user would be over quota after the operation.  (The user may\n      or may not be over quota already.)\n      Note that if the server sends OVERQUOTA but doesn't support the\n      IMAP QUOTA extension defined by [RFC2087], then there is a quota,\n      but the client cannot find out what the quota is.\n        C: n1 uid copy 1:* oldmail\n        S: n1 NO [OVERQUOTA] Sorry\n        C: n2 uid copy 1:* oldmail\n        S: n2 OK [OVERQUOTA] You are now over your soft quota\n   PARSE\n      The human-readable text represents an error in parsing the\n      [RFC5322] header or [MIME-IMB] headers of a message in the\n      mailbox.\n   PERMANENTFLAGS\n      Followed by a parenthesized list of flags and indicates which of\n      the known flags the client can change permanently.  Any flags that\n      are in the FLAGS untagged response, but not in the PERMANENTFLAGS\n      list, cannot be set permanently.  The PERMANENTFLAGS list can also\n      include the special flag \\*, which indicates that it is possible\n      to create new keywords by attempting to store those keywords in\n      the mailbox.  If the client attempts to STORE a flag that is not\n      in the PERMANENTFLAGS list, the server will either ignore the\n      change or store the state change for the remainder of the current\n      session only.\n      There is no need for a server that included the special flag \\* to\n      return a new PERMANENTFLAGS response code when a new keyword was\n      successfully set on a message upon client request.  However, if\n      the server has a limit on the number of different keywords that\n      can be stored in a mailbox and that limit is reached, the server\n      MUST send a new PERMANENTFLAGS response code without the special\n      flag \\*.\n   PRIVACYREQUIRED\n      The operation is not permitted due to a lack of data\n      confidentiality.  If TLS is not in use, the client could try\n      STARTTLS (see Section 6.2.1) or alternatively reconnect on an\n      Implicit TLS port, and then repeat the operation.\n        C: d login \"fred\" \"foo\"\n        S: d NO [PRIVACYREQUIRED] Connection offers no privacy\n        C: d select inbox\n        S: d NO [PRIVACYREQUIRED] Connection offers no privacy\n   READ-ONLY\n      The mailbox is selected as read-only, or its access while selected\n      has changed from read-write to read-only.\n   READ-WRITE\n      The mailbox is selected as read-write, or its access while\n      selected has changed from read-only to read-write.\n   SERVERBUG\n      The server encountered a bug in itself or violated one of its own\n      invariants.\n        C: j select \"/archive/projects/experiment-iv\"\n        S: j NO [SERVERBUG] This should not happen\n   TRYCREATE\n      An APPEND, COPY, or MOVE attempt is failing because the target\n      mailbox does not exist (as opposed to some other reason).  This is\n      a hint to the client that the operation can succeed if the mailbox\n      is first created by the CREATE command.\n   UIDNEXT\n      Followed by a decimal number and indicates the next unique\n      identifier value.  Refer to Section 2.3.1.1 for more information.\n   UIDNOTSTICKY\n      The selected mailbox is supported by a mail store that does not\n      support persistent UIDs; that is, UIDVALIDITY will be different\n      each time the mailbox is selected.  Consequently, APPEND or COPY\n      to this mailbox will not return an APPENDUID or COPYUID response\n      code.\n      This response code is returned in an untagged NO response to the\n      SELECT command.\n         Note: servers SHOULD NOT have any UIDNOTSTICKY mail stores.\n         This facility exists to support legacy mail stores in which it\n         is technically infeasible to support persistent UIDs.  This\n         should be avoided when designing new mail stores.\n   UIDVALIDITY\n      Followed by a decimal number and indicates the unique identifier\n      validity value.  Refer to Section 2.3.1.1 for more information.\n   UNAVAILABLE\n      Temporary failure because a subsystem is down.  For example, an\n      IMAP server that uses a Lightweight Directory Access Protocol\n      (LDAP) or Radius server for authentication might use this response\n      code when the LDAP/Radius server is down.\n        C: a LOGIN \"fred\" \"foo\"\n        S: a NO [UNAVAILABLE] User's backend down for maintenance\n   UNKNOWN-CTE\n      The server does not know how to decode the section's Content-\n      Transfer-Encoding.\n   Client implementations MUST ignore response codes that they do not\n   recognize.\n7.1.1.  OK Response\n   Contents: \n               OPTIONAL response code\n               human-readable text\n   The OK response indicates an information message from the server.\n   When tagged, it indicates successful completion of the associated\n   command.  The human-readable text MAY be presented to the user as an\n   information message.  The untagged form indicates an information-only\n   message; the nature of the information MAY be indicated by a response\n   code.\n   The untagged form is also used as one of three possible greetings at\n   connection startup.  It indicates that the connection is not yet\n   authenticated and that a LOGIN or an AUTHENTICATE command is needed.\n   Example:\n     S: * OK IMAP4rev2 server ready\n     C: A001 LOGIN fred blurdybloop\n     S: * OK [ALERT] System shutdown in 10 minutes\n     S: A001 OK LOGIN Completed\n7.1.2.  NO Response\n   Contents: \n               OPTIONAL response code\n               human-readable text\n   The NO response indicates an operational error message from the\n   server.  When tagged, it indicates unsuccessful completion of the\n   associated command.  The untagged form indicates a warning; the\n   command can still complete successfully.  The human-readable text\n   describes the condition.\n   Example:\n     C: A222 COPY 1:2 owatagusiam\n     S: * NO Disk is 98% full, please delete unnecessary data\n     S: A222 OK COPY completed\n     C: A223 COPY 3:200 blurdybloop\n     S: * NO Disk is 98% full, please delete unnecessary data\n     S: * NO Disk is 99% full, please delete unnecessary data\n     S: A223 NO COPY failed: disk is full\n7.1.3.  BAD Response\n   Contents: \n               OPTIONAL response code\n               human-readable text\n   The BAD response indicates an error message from the server.  When\n   tagged, it reports a protocol-level error in the client's command;\n   the tag indicates the command that caused the error.  The untagged\n   form indicates a protocol-level error for which the associated\n   command can not be determined; it can also indicate an internal\n   server failure.  The human-readable text describes the condition.\n   Example:\n     C: ...very long command line...\n     S: * BAD Command line too long\n     C: ...empty line...\n     S: * BAD Empty command line\n     C: A443 EXPUNGE\n     S: * BAD Disk crash, attempting salvage to a new disk!\n     S: * OK Salvage successful, no data lost\n     S: A443 OK Expunge completed\n7.1.4.  PREAUTH Response\n   Contents: \n               OPTIONAL response code\n               human-readable text\n   The PREAUTH response is always untagged and is one of three possible\n   greetings at connection startup.  It indicates that the connection\n   has already been authenticated by external means; thus, no LOGIN/\n   AUTHENTICATE command is needed.\n   Because PREAUTH moves the connection directly to the authenticated\n   state, it effectively prevents the client from using the STARTTLS\n   command (Section 6.2.1).  For this reason, the PREAUTH response\n   SHOULD only be returned by servers on connections that are protected\n   by TLS (such as on an Implicit TLS port [RFC8314]) or protected\n   through other means such as IPsec.  Clients that require mandatory\n   TLS MUST close the connection after receiving the PREAUTH response on\n   a non-protected port.\n   Example:\n     S: * PREAUTH IMAP4rev2 server logged in as Smith\n7.1.5.  BYE Response\n   Contents: \n               OPTIONAL response code\n               human-readable text\n   The BYE response is always untagged and indicates that the server is\n   about to close the connection.  The human-readable text MAY be\n   displayed to the user in a status report by the client.  The BYE\n   response is sent under one of four conditions:\n   1.  as part of a normal logout sequence.  The server will close the\n       connection after sending the tagged OK response to the LOGOUT\n       command.\n   2.  as a panic shutdown announcement.  The server closes the\n       connection immediately.\n   3.  as an announcement of an inactivity autologout.  The server\n       closes the connection immediately.\n   4.  as one of three possible greetings at connection startup,\n       indicating that the server is not willing to accept a connection\n       from this client.  The server closes the connection immediately.\n   The difference between a BYE that occurs as part of a normal LOGOUT\n   sequence (the first case) and a BYE that occurs because of a failure\n   (the other three cases) is that the connection closes immediately in\n   the failure case.  In all cases, the client SHOULD continue to read\n   response data from the server until the connection is closed; this\n   will ensure that any pending untagged or completion responses are\n   read and processed.\n   Example:\n     S: * BYE Autologout; idle for too long\n7.2.  Server Responses - Server Status\n   These responses are always untagged.  This is how server status data\n   are transmitted from the server to the client.\n7.2.1.  ENABLED Response\n   Contents:   capability listing\n   The ENABLED response occurs as a result of an ENABLE command.  The\n   capability listing contains a space-separated listing of capability\n   names that the server supports and that were successfully enabled.\n   The ENABLED response may contain no capabilities, which means that no\n   extensions listed by the client were successfully enabled.\n   Example:\n     S: * ENABLED CONDSTORE QRESYNC\n7.2.2.  CAPABILITY Response\n   Contents:   capability listing\n   The CAPABILITY response occurs as a result of a CAPABILITY command.\n   The capability listing contains a space-separated listing of\n   capability names that the server supports.  The capability listing\n   MUST include the atom \"IMAP4rev2\", but note that it doesn't have to\n   be the first capability listed.  The order of capability names has no\n   significance.\n   Client and server implementations MUST implement the capabilities\n   \"AUTH=PLAIN\" (described in [PLAIN]), and MUST implement \"STARTTLS\"\n   and \"LOGINDISABLED\" on the cleartext port.  See the Security\n   Considerations (Section 11) for important information related to\n   these capabilities.\n   A capability name that begins with \"AUTH=\" indicates that the server\n   supports that particular authentication mechanism [SASL].\n   The LOGINDISABLED capability indicates that the LOGIN command is\n   disabled, and that the server will respond with a tagged NO response\n   to any attempt to use the LOGIN command even if the user name and\n   password are valid (their validity will not be checked).  An IMAP\n   client MUST NOT issue the LOGIN command if the server advertises the\n   LOGINDISABLED capability.\n   Other capability names indicate that the server supports an\n   extension, revision, or amendment to the IMAP4rev2 protocol.  If\n   IMAP4rev1 capability is not advertised, server responses MUST conform\n   to this document until the client issues a command that uses an\n   additional capability.  If both IMAP4rev1 and IMAP4rev2 capabilities\n   are advertised, server responses MUST conform to [RFC3501] until the\n   client issues a command that uses an additional capability.  (For\n   example, the client can issue ENABLE IMAP4rev2 to enable\n   IMAP4rev2-specific behavior.)\n   Capability names SHOULD be registered with IANA using the RFC\n   Required policy [RFC8126].  A server SHOULD NOT offer unregistered\n   capability names.\n   Client implementations SHOULD NOT require any capability name other\n   than \"IMAP4rev2\", and possibly \"STARTTLS\" and \"LOGINDISABLED\" (on a\n   cleartext port).  Client implementations MUST ignore any unknown\n   capability names.\n   A server MAY send capabilities automatically, by using the CAPABILITY\n   response code in the initial PREAUTH or OK responses and by sending\n   an updated CAPABILITY response code in the tagged OK response as part\n   of a successful authentication.  It is unnecessary for a client to\n   send a separate CAPABILITY command if it recognizes these automatic\n   capabilities and there was no change to the TLS and/or authentication\n   state since they were received.\n   The list of capabilities returned by a server MAY change during the\n   connection.  In particular, it is quite common for the server to\n   change the list of capabilities after successful TLS negotiation\n   (STARTTLS command) and/or after successful authentication\n   (AUTHENTICATE or LOGIN commands).\n   Example:\n     S: * CAPABILITY STARTTLS AUTH=GSSAPI IMAP4rev2 LOGINDISABLED\n      XPIG-LATIN\n   Note that in the above example, XPIG-LATIN is a fictitious capability\n   name.\n7.3.  Server Responses - Mailbox Status\n   These responses are always untagged.  This is how mailbox status data\n   are transmitted from the server to the client.  Many of these\n   responses typically result from a command with the same name.\n7.3.1.  LIST Response\n   Contents: \n               name attributes\n               hierarchy delimiter\n               name\n               OPTIONAL extension data\n   The LIST response occurs as a result of a LIST command.  It returns a\n   single name that matches the LIST specification.  There can be\n   multiple LIST responses for a single LIST command.\n   The following base mailbox name attributes are defined:\n   \\NonExistent\n      The \"\\NonExistent\" attribute indicates that a mailbox name does\n      not refer to an existing mailbox.  Note that this attribute is not\n      meaningful by itself, as mailbox names that match the canonical\n      LIST pattern but don't exist must not be returned unless one of\n      the two conditions listed below is also satisfied:\n      1.  The mailbox name also satisfies the selection criteria (for\n          example, it is subscribed and the \"SUBSCRIBED\" selection\n          option has been specified).\n      2.  \"RECURSIVEMATCH\" has been specified, and the mailbox name has\n          at least one descendant mailbox name that does not match the\n          LIST pattern and does match the selection criteria.\n      In practice, this means that the \"\\NonExistent\" attribute is\n      usually returned with one or more of \"\\Subscribed\", \"\\Remote\",\n      \"\\HasChildren\", or the CHILDINFO extended data item.\n      The \"\\NonExistent\" attribute implies \"\\NoSelect\".\n   \\Noinferiors\n      It is not possible for any child levels of hierarchy to exist\n      under this name; no child levels exist now and none can be created\n      in the future.\n   \\Noselect\n      It is not possible to use this name as a selectable mailbox.\n   \\HasChildren\n      The presence of this attribute indicates that the mailbox has\n      child mailboxes.  A server SHOULD NOT set this attribute if there\n      are child mailboxes and the user does not have permission to\n      access any of them.  In this case, \\HasNoChildren SHOULD be used.\n      In many cases, however, a server may not be able to efficiently\n      compute whether a user has access to any child mailboxes.  Note\n      that even though the \\HasChildren attribute for a mailbox must be\n      correct at the time of processing the mailbox, a client must be\n      prepared to deal with a situation when a mailbox is marked with\n      the \\HasChildren attribute, but no child mailbox appears in the\n      response to the LIST command.  This might happen, for example, due\n      to child mailboxes being deleted or made inaccessible to the user\n      (using access control) by another client before the server is able\n      to list them.\n   \\HasNoChildren\n      The presence of this attribute indicates that the mailbox has NO\n      child mailboxes that are accessible to the currently authenticated\n      user.\n   \\Marked\n      The mailbox has been marked \"interesting\" by the server; the\n      mailbox probably contains messages that have been added since the\n      last time the mailbox was selected.\n   \\Unmarked\n      The mailbox does not contain any additional messages since the\n      last time the mailbox was selected.\n   \\Subscribed\n      The mailbox name was subscribed to using the SUBSCRIBE command.\n   \\Remote\n      The mailbox is a remote mailbox.\n   It is an error for the server to return both a \\HasChildren and a\n   \\HasNoChildren attribute in the same LIST response.  A client that\n   encounters a LIST response with both \\HasChildren and \\HasNoChildren\n   attributes present should act as if both are absent in the LIST\n   response.\n      Note: the \\HasNoChildren attribute should not be confused with the\n      \\NoInferiors attribute, which indicates that no child mailboxes\n      exist now and none can be created in the future.\n   If it is not feasible for the server to determine whether or not the\n   mailbox is \"interesting\", the server SHOULD NOT send either \\Marked\n   or \\Unmarked.  The server MUST NOT send more than one of \\Marked,\n   \\Unmarked, and \\Noselect for a single mailbox, and it MAY send none\n   of these.\n   In addition to the base mailbox name attributes defined above, an\n   IMAP server MAY also include any or all of the following attributes\n   that denote \"role\" (or \"special-use\") of a mailbox.  These attributes\n   are included along with base attributes defined above.  A given\n   mailbox may have none, one, or more than one of these attributes.  In\n   some cases, a special use is advice to a client about what to put in\n   that mailbox.  In other cases, it's advice to a client about what to\n   expect to find there.\n   \\All\n      This mailbox presents all messages in the user's message store.\n      Implementations MAY omit some messages, such as, perhaps, those in\n      \\Trash and \\Junk.  When this special use is supported, it is\n      almost certain to represent a virtual mailbox.\n   \\Archive\n      This mailbox is used to archive messages.  The meaning of an\n      \"archival\" mailbox is server dependent; typically, it will be used\n      to get messages out of the inbox, or otherwise keep them out of\n      the user's way, while still making them accessible.\n   \\Drafts\n      This mailbox is used to hold draft messages -- typically, messages\n      that are being composed but have not yet been sent.  In some\n      server implementations, this might be a virtual mailbox,\n      containing messages from other mailboxes that are marked with the\n      \"\\Draft\" message flag.  Alternatively, this might just be advice\n      that a client put drafts here.\n   \\Flagged\n      This mailbox presents all messages marked in some way as\n      \"important\".  When this special use is supported, it is likely to\n      represent a virtual mailbox collecting messages (from other\n      mailboxes) that are marked with the \"\\Flagged\" message flag.\n   \\Junk\n      This mailbox is where messages deemed to be junk mail are held.\n      Some server implementations might put messages here automatically.\n      Alternatively, this might just be advice to a client-side spam\n      filter.\n   \\Sent\n      This mailbox is used to hold copies of messages that have been\n      sent.  Some server implementations might put messages here\n      automatically.  Alternatively, this might just be advice that a\n      client save sent messages here.\n   \\Trash\n      This mailbox is used to hold messages that have been deleted or\n      marked for deletion.  In some server implementations, this might\n      be a virtual mailbox, containing messages from other mailboxes\n      that are marked with the \"\\Deleted\" message flag.  Alternatively,\n      this might just be advice that a client that chooses not to use\n      the IMAP \"\\Deleted\" model should use as its trash location.  In\n      server implementations that strictly expect the IMAP \"\\Deleted\"\n      model, this special use is likely not to be supported.\n   All special-use attributes are OPTIONAL, and any given server or\n   message store may support any combination of the attributes, or none\n   at all.  In most cases, there will likely be at most one mailbox with\n   a given attribute for a given user, but in some server or message\n   store implementations, it might be possible for multiple mailboxes to\n   have the same special-use attribute.\n   Special-use attributes are likely to be user specific.  User Adam\n   might share his \\Sent mailbox with user Barb, but that mailbox is\n   unlikely to also serve as Barb's \\Sent mailbox.\n   Other mailbox name attributes can be found in the \"IMAP Mailbox Name\n   Attributes\" registry [IMAP-MAILBOX-NAME-ATTRS-REG].\n   The hierarchy delimiter is a character used to delimit levels of\n   hierarchy in a mailbox name.  A client can use it to create child\n   mailboxes and to search higher or lower levels of naming hierarchy.\n   All children of a top-level hierarchy node MUST use the same\n   separator character.  A NIL hierarchy delimiter means that no\n   hierarchy exists; the name is a \"flat\" name.\n   The name represents an unambiguous left-to-right hierarchy and MUST\n   be valid for use as a reference in LIST command.  Unless \\Noselect or\n   \\NonExistent is indicated, the name MUST also be valid as an argument\n   for commands, such as SELECT, that accept mailbox names.\n   The name might be followed by an OPTIONAL series of extended fields,\n   a parenthesized list of tagged data (also referred to as an \"extended\n   data item\").  The first element of an extended field is a string,\n   which identifies the type of data.  [RFC5258] specifies requirements\n   on string registration (which are called \"tags\"; such tags are not to\n   be confused with IMAP command tags); in particular, it states that\n   \"Tags MUST be registered with IANA\".  This document doesn't change\n   that.  See Section 9.5 of [RFC5258] for the registration template.\n   The server MAY return data in the extended fields that was not\n   directly solicited by the client in the corresponding LIST command.\n   For example, the client can enable extra extended fields by using\n   another IMAP extension that makes use of the extended LIST responses.\n   The client MUST ignore all extended fields it doesn't recognize.\n   Example:\n     S: * LIST (\\Noselect) \"/\" ~/Mail/foo\n   Example:\n     S: * LIST (\\Marked) \":\" Tables (tablecloth ((\"edge\" \"lacy\")\n         (\"color\" \"red\")) Sample \"text\")\n     S: * LIST () \":\" Tables:new (tablecloth (\"edge\" \"lacy\")\n         Sample (\"text\" \"more text\"))\n7.3.2.  NAMESPACE Response\n   Contents:   the prefix and hierarchy delimiter to the server's\n               Personal Namespace(s), Other Users' Namespace(s), and\n               Shared Namespace(s)\n   The NAMESPACE response occurs as a result of a NAMESPACE command.  It\n   contains the prefix and hierarchy delimiter to the server's Personal\n   Namespace(s), Other Users' Namespace(s), and Shared Namespace(s) that\n   the server wishes to expose.  The response will contain a NIL for any\n   namespace class that is not available.  The Namespace-Response-\n   Extensions ABNF non-terminal is defined for extensibility and MAY be\n   included in the response.\n   Example:\n     S: * NAMESPACE ((\"\" \"/\")) ((\"~\" \"/\")) NIL\n7.3.3.  STATUS Response\n   Contents: \n               name\n               status parenthesized list\n   The STATUS response occurs as a result of a STATUS command.  It\n   returns the mailbox name that matches the STATUS specification and\n   the requested mailbox status information.\n   Example:\n     S: * STATUS blurdybloop (MESSAGES 231 UIDNEXT 44292)\n7.3.4.  ESEARCH Response\n   Contents:   one or more search-return-data pairs\n   The ESEARCH response occurs as a result of a SEARCH or UID SEARCH\n   command.\n   The ESEARCH response starts with an optional search correlator.  If\n   it is missing, then the response was not caused by a particular IMAP\n   command, whereas if it is present, it contains the tag of the command\n   that caused the response to be returned.\n   The search correlator is followed by an optional UID indicator.  If\n   this indicator is present, all data in the ESEARCH response refers to\n   UIDs; otherwise, all returned data refers to message numbers.\n   The rest of the ESEARCH response contains one or more search data\n   pairs.  Each pair starts with a unique return item name, followed by\n   a space and the corresponding data.  Search data pairs may be\n   returned in any order.  Unless otherwise specified by an extension,\n   any return item name SHOULD appear only once in an ESEARCH response.\n   This document specifies the following return item names:\n   MIN\n      Returns the lowest message number/UID that satisfies the SEARCH\n      criteria.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the MIN return item in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   MAX\n      Returns the highest message number/UID that satisfies the SEARCH\n      criteria.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the MAX return item in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   ALL\n      Returns all message numbers/UIDs that satisfy the SEARCH criteria\n      using the sequence-set syntax.  Each set MUST be complete; in\n      particular, a UID set is returned in an ESEARCH response only when\n      each number in the range corresponds to an existing (matching)\n      message.  The client MUST NOT assume that messages/UIDs will be\n      listed in any particular order.\n      If the SEARCH results in no matches, the server MUST NOT include\n      the ALL return item in the ESEARCH response; however, it still\n      MUST send the ESEARCH response.\n   COUNT\n      Returns the number of messages that satisfy the SEARCH criteria.\n      This return item MUST always be included in the ESEARCH response.\n   Example:\n     S: * ESEARCH UID COUNT 17 ALL 4:18,21,28\n   Example:\n     S: * ESEARCH (TAG \"a567\") UID COUNT 17 ALL 4:18,21,28\n   Example:\n     S: * ESEARCH COUNT 18 ALL 1:17,21\n7.3.5.  FLAGS Response\n   Contents:   flag parenthesized list\n   The FLAGS response occurs as a result of a SELECT or EXAMINE command.\n   The flag parenthesized list identifies the flags (at a minimum, the\n   system-defined flags) that are applicable for this mailbox.  Flags\n   other than the system flags can also exist, depending on server\n   implementation.\n   The update from the FLAGS response MUST be remembered by the client.\n   Example:\n     S: * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n7.4.  Server Responses - Mailbox Size\n   These responses are always untagged.  This is how changes in the size\n   of the mailbox are transmitted from the server to the client.\n   Immediately following the \"*\" token is a number that represents a\n   message count.\n7.4.1.  EXISTS Response\n   Contents:   none\n   The EXISTS response reports the number of messages in the mailbox.\n   This response occurs as a result of a SELECT or EXAMINE command and\n   if the size of the mailbox changes (e.g., new messages).\n   The update from the EXISTS response MUST be remembered by the client.\n   Example:\n     S: * 23 EXISTS\n7.5.  Server Responses - Message Status\n   These responses are always untagged.  This is how message data are\n   transmitted from the server to the client, often as a result of a\n   command with the same name.  Immediately following the \"*\" token is a\n   number that represents a message sequence number.\n7.5.1.  EXPUNGE Response\n   Contents:   none\n   The EXPUNGE response reports that the specified message sequence\n   number has been permanently removed from the mailbox.  The message\n   sequence number for each successive message in the mailbox is\n   immediately decremented by 1, and this decrement is reflected in\n   message sequence numbers in subsequent responses (including other\n   untagged EXPUNGE responses).\n   The EXPUNGE response also decrements the number of messages in the\n   mailbox; it is not necessary to send an EXISTS response with the new\n   value.\n   As a result of the immediate decrement rule, message sequence numbers\n   that appear in a set of successive EXPUNGE responses depend upon\n   whether the messages are removed starting from lower numbers to\n   higher numbers, or from higher numbers to lower numbers.  For\n   example, if the last 5 messages in a 9-message mailbox are expunged,\n   a \"lower to higher\" server will send five untagged EXPUNGE responses\n   for message sequence number 5, whereas a \"higher to lower\" server\n   will send successive untagged EXPUNGE responses for message sequence\n   numbers 9, 8, 7, 6, and 5.\n   An EXPUNGE response MUST NOT be sent when no command is in progress,\n   nor while responding to a FETCH, STORE, or SEARCH command.  This rule\n   is necessary to prevent a loss of synchronization of message sequence\n   numbers between client and server.  A command is not \"in progress\"\n   until the complete command has been received; in particular, a\n   command is not \"in progress\" during the negotiation of command\n   continuation.\n      Note: UID FETCH, UID STORE, and UID SEARCH are different commands\n      from FETCH, STORE, and SEARCH.  An EXPUNGE response MAY be sent\n      during a UID command.\n   The update from the EXPUNGE response MUST be remembered by the\n   client.\n   Example:\n     S: * 44 EXPUNGE\n7.5.2.  FETCH Response\n   Contents:   message data\n   The FETCH response returns data about a message to the client.  The\n   data are pairs of data item names, and their values are in\n   parentheses.  This response occurs as the result of a FETCH or STORE\n   command, as well as by a unilateral server decision (e.g., flag\n   updates).\n   The current data items are:\n   BINARY[<section-binary>]<<number>>\n      An <nstring> or <literal8> expressing the content of the specified\n      section after removing any encoding specified in the corresponding\n      Content-Transfer-Encoding header field.  If <number> is present,\n      it refers to the offset within the DECODED section data.\n      If the domain of the decoded data is \"8bit\" and the data does not\n      contain the NUL octet, the server SHOULD return the data in a\n      <string> instead of a <literal8>; this allows the client to\n      determine if the \"8bit\" data contains the NUL octet without having\n      to explicitly scan the data stream for NULs.\n      Messaging clients and servers have been notoriously lax in their\n      adherence to the Internet CRLF convention for terminating lines of\n      textual data (text/* media types) in Internet protocols.  When\n      sending data in a BINARY[...] FETCH data item, servers MUST ensure\n      that textual line-oriented sections are always transmitted using\n      the IMAP CRLF line termination syntax, regardless of the\n      underlying storage representation of the data on the server.\n      If the server does not know how to decode the section's Content-\n      Transfer-Encoding, it MUST fail the request and issue a \"NO\"\n      response that contains the \"UNKNOWN-CTE\" response code.\n   BINARY.SIZE[<section-binary>]\n      The size of the section after removing any encoding specified in\n      the corresponding Content-Transfer-Encoding header field.  The\n      value returned MUST match the size of the <nstring> or <literal8>\n      that will be returned by the corresponding FETCH BINARY request.\n      If the server does not know how to decode the section's Content-\n      Transfer-Encoding, it MUST fail the request and issue a \"NO\"\n      response that contains the \"UNKNOWN-CTE\" response code.\n   BODY\n      A form of BODYSTRUCTURE without extension data.\n   BODY[<section>]<<origin octet>>\n      A string expressing the body contents of the specified section.\n      The string SHOULD be interpreted by the client according to the\n      content transfer encoding, body type, and subtype.\n      If the origin octet is specified, this string is a substring of\n      the entire body contents, starting at that origin octet.  This\n      means that BODY[]<0> MAY be truncated, but BODY[] is NEVER\n      truncated.\n         Note: The origin octet facility MUST NOT be used by a server in\n         a FETCH response unless the client specifically requested it by\n         means of a FETCH of a BODY[<section>]<<partial>> data item.\n      8-bit textual data is permitted if a [CHARSET] identifier is part\n      of the body parameter parenthesized list for this section.  Note\n      that headers (part specifiers HEADER or MIME, or the header\n      portion of a MESSAGE/RFC822 or MESSAGE/GLOBAL part) MAY be in UTF-\n      8.  Note also that the [RFC5322] delimiting blank line between the\n      header and the body is not affected by header-line subsetting; the\n      blank line is always included as part of the header data, except\n      in the case of a message that has no body and no blank line.\n      Non-textual data such as binary data MUST be transfer encoded into\n      a textual form, such as base64, prior to being sent to the client.\n      To derive the original binary data, the client MUST decode the\n      transfer-encoded string.\n   BODYSTRUCTURE\n      A parenthesized list that describes the [MIME-IMB] body structure\n      of a message.  This is computed by the server by parsing the\n      [MIME-IMB] header fields, defaulting various fields as necessary.\n      For example, a simple text message of 48 lines and 2279 octets can\n      have a body structure of:\n         (\"TEXT\" \"PLAIN\" (\"CHARSET\" \"US-ASCII\") NIL NIL \"7BIT\" 2279 48)\n      Multiple parts are indicated by parenthesis nesting.  Instead of a\n      body type as the first element of the parenthesized list, there is\n      a sequence of one or more nested body structures.  The second\n      element of the parenthesized list is the multipart subtype (mixed,\n      digest, parallel, alternative, etc.).\n      For example, a two-part message consisting of a text and a\n      base64-encoded text attachment can have a body structure of:\n         ((\"TEXT\" \"PLAIN\" (\"CHARSET\" \"US-ASCII\") NIL NIL \"7BIT\" 1152 23)\n          (\"TEXT\" \"PLAIN\" (\"CHARSET\" \"US-ASCII\" \"NAME\" \"cc.diff\")\n          \"<960723163407.20117h@cac.washington.edu>\" \"Compiler diff\"\n          \"BASE64\" 4554 73) \"MIXED\")\n      Extension data follows the multipart subtype.  Extension data is\n      never returned with the BODY fetch but can be returned with a\n      BODYSTRUCTURE fetch.  Extension data, if present, MUST be in the\n      defined order.  The extension data of a multipart body part are in\n      the following order:\n   body parameter parenthesized list\n      A parenthesized list of attribute/value pairs (e.g., (\"foo\" \"bar\"\n      \"baz\" \"rag\") where \"bar\" is the value of \"foo\", and \"rag\" is the\n      value of \"baz\") as defined in [MIME-IMB].  Servers SHOULD decode\n      parameter-value continuations and parameter-value character sets\n      as described in [RFC2231], for example, if the message contains\n      parameters \"baz*0\", \"baz*1\", and \"baz*2\", the server should decode\n      them per [RFC2231], concatenate, and return the resulting value as\n      a parameter \"baz\".  Similarly, if the message contains parameters\n      \"foo*0*\" and \"foo*1*\", the server should decode them per\n      [RFC2231], convert to UTF-8, concatenate, and return the resulting\n      value as a parameter \"foo*\".\n   body disposition\n      A parenthesized list, consisting of a disposition type string,\n      followed by a parenthesized list of disposition attribute/value\n      pairs as defined in [DISPOSITION].  Servers SHOULD decode\n      parameter-value continuations as described in [RFC2231].\n   body language\n      A string or parenthesized list giving the body language value as\n      defined in [LANGUAGE-TAGS].\n   body location\n      A string giving the body content URI as defined in [LOCATION].\n      Any following extension data are not yet defined in this version\n      of the protocol.  Such extension data can consist of zero or more\n      NILs, strings, numbers, or potentially nested parenthesized lists\n      of such data.  Client implementations that do a BODYSTRUCTURE\n      fetch MUST be prepared to accept such extension data.  Server\n      implementations MUST NOT send such extension data until it has\n      been defined by a revision of this protocol.\n      The basic fields of a non-multipart body part are in the following\n      order:\n   body type\n      A string giving the content media-type name as defined in\n      [MIME-IMB].\n   body subtype\n      A string giving the content subtype name as defined in [MIME-IMB].\n   body parameter parenthesized list\n      A parenthesized list of attribute/value pairs (e.g., (\"foo\" \"bar\"\n      \"baz\" \"rag\") where \"bar\" is the value of \"foo\", and \"rag\" is the\n      value of \"baz\") as defined in [MIME-IMB].\n   body id\n      A string giving the Content-ID header field value as defined in\n      Section 7 of [MIME-IMB].\n   body description\n      A string giving the Content-Description header field value as\n      defined in Section 8 of [MIME-IMB].\n   body encoding\n      A string giving the content transfer encoding as defined in\n      Section 6 of [MIME-IMB].\n   body size\n      A number giving the size of the body in octets.  Note that this\n      size is the size in its transfer encoding and not the resulting\n      size after any decoding.\n      A body type of type MESSAGE and subtype RFC822 contains,\n      immediately after the basic fields, the envelope structure, body\n      structure, and size in text lines of the encapsulated message.\n      A body type of type TEXT contains, immediately after the basic\n      fields, the size of the body in text lines.  Note that this size\n      is the size in its content transfer encoding and not the resulting\n      size after any decoding.\n      Extension data follows the basic fields and the type-specific\n      fields listed above.  Extension data is never returned with the\n      BODY fetch but can be returned with a BODYSTRUCTURE fetch.\n      Extension data, if present, MUST be in the defined order.\n      The extension data of a non-multipart body part are in the\n      following order:\n   body MD5\n      A string giving the body MD5 value as defined in [MD5].\n   body disposition\n      A parenthesized list with the same content and function as the\n      body disposition for a multipart body part.\n   body language\n      A string or parenthesized list giving the body language value as\n      defined in [LANGUAGE-TAGS].\n   body location\n      A string giving the body content URI as defined in [LOCATION].\n      Any following extension data are not yet defined in this version\n      of the protocol and would be as described above under multipart\n      extension data.\n   ENVELOPE\n      A parenthesized list that describes the envelope structure of a\n      message.  This is computed by the server by parsing the [RFC5322]\n      header into the component parts, defaulting various fields as\n      necessary.\n      The fields of the envelope structure are in the following order:\n      date, subject, from, sender, reply-to, to, cc, bcc, in-reply-to,\n      and message-id.  The date, subject, in-reply-to, and message-id\n      fields are strings.  The from, sender, reply-to, to, cc, and bcc\n      fields are parenthesized lists of address structures.\n      An address structure is a parenthesized list that describes an\n      electronic mail address.  The fields of an address structure are\n      in the following order: display name, [SMTP] at-domain-list\n      (source route and obs-route ABNF production from [RFC5322]),\n      mailbox name (local-part ABNF production from [RFC5322]), and\n      hostname.\n      [RFC5322] group syntax is indicated by a special form of address\n      structure in which the hostname field is NIL.  If the mailbox name\n      field is also NIL, this is an end-of-group marker (semicolon in\n      RFC 822 syntax).  If the mailbox name field is non-NIL, this is\n      the start of a group marker, and the mailbox name field holds the\n      group name phrase.\n      If the Date, Subject, In-Reply-To, and Message-ID header fields\n      are absent in the [RFC5322] header, the corresponding member of\n      the envelope is NIL; if these header fields are present but empty,\n      the corresponding member of the envelope is the empty string.\n         Note: some servers may return a NIL envelope member in the\n         \"present but empty\" case.  Clients SHOULD treat NIL and the\n         empty string as identical.\n         Note: [RFC5322] requires that all messages have a valid Date\n         header field.  Therefore, for a well-formed message, the date\n         member in the envelope cannot be NIL or the empty string.\n         However, it can be NIL for a malformed or draft message.\n         Note: [RFC5322] requires that the In-Reply-To and Message-ID\n         header fields, if present, have non-empty content.  Therefore,\n         for a well-formed message, the in-reply-to and message-id\n         members in the envelope cannot be the empty string.  However,\n         they can still be the empty string for a malformed message.\n      If the From, To, Cc, and Bcc header fields are absent in the\n      [RFC5322] header, or are present but empty, the corresponding\n      member of the envelope is NIL.\n      If the Sender or Reply-To header fields are absent in the\n      [RFC5322] header, or are present but empty, the server sets the\n      corresponding member of the envelope to be the same value as the\n      from member (the client is not expected to know how to do this).\n         Note: [RFC5322] requires that all messages have a valid From\n         header field.  Therefore, for a well-formed message, the from,\n         sender, and reply-to members in the envelope cannot be NIL.\n         However, they can be NIL for a malformed or draft message.\n   FLAGS\n      A parenthesized list of flags that are set for this message.\n   INTERNALDATE\n      A string representing the internal date of the message.\n   RFC822.SIZE\n      A number expressing the size of a message, as described in\n      Section 2.3.4.\n   UID\n      A number expressing the unique identifier of the message.\n   If the server chooses to send unsolicited FETCH responses, they MUST\n   include UID FETCH item.  Note that this is a new requirement when\n   compared to [RFC3501].\n   Example:\n     S: * 23 FETCH (FLAGS (\\Seen) RFC822.SIZE 44827 UID 447)\n7.6.  Server Responses - Command Continuation Request\n   The command continuation request response is indicated by a \"+\" token\n   instead of a tag.  This form of response indicates that the server is\n   ready to accept the continuation of a command from the client.  The\n   remainder of this response is a line of text.\n   This response is used in the AUTHENTICATE command to transmit server\n   data to the client and request additional client data.  This response\n   is also used if an argument to any command is a synchronizing\n   literal.\n   The client is not permitted to send the octets of the synchronizing\n   literal unless the server indicates that it is expected.  This\n   permits the server to process commands and reject errors on a line-\n   by-line basis.  The remainder of the command, including the CRLF that\n   terminates a command, follows the octets of the literal.  If there\n   are any additional command arguments, the literal octets are followed\n   by a space and those arguments.\n   Example:\n     C: A001 LOGIN {11}\n     S: + Ready for additional command text\n     C: FRED FOOBAR {7}\n     S: + Ready for additional command text\n     C: fat man\n     S: A001 OK LOGIN completed\n     C: A044 BLURDYBLOOP {102856}\n     S: A044 BAD No such command as \"BLURDYBLOOP\"\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"NotAuthenticated\", \"Authenticated\", \"Selected\", \"WaitingForContinuation\", \"ConnectionClosed\"],\n  \"transitions\": [\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"send PREAUTH\",\n      \"action\": \"set authenticated\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"recv LOGIN\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"recv SELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"*\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"recv APPEND\",\n      \"action\": \"reply +\",\n      \"to\": \"WaitingForContinuation\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"recv data\",\n      \"action\": \"process data\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"recv CLOSE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 8. Sample IMAP4rev2 Connection",
      "prompt": "\nYou will be given the section \"Section 8. Sample IMAP4rev2 Connection\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nThe following is a transcript of an IMAP4rev2 connection on a non-TLS\n   port.  A long line in this sample is broken for editorial clarity.\n   S:   * OK [CAPABILITY STARTTLS AUTH=SCRAM-SHA-256 LOGINDISABLED\n         IMAP4rev2] IMAP4rev2 Service Ready\n   C:   a000 starttls\n   S:   a000 OK Proceed with TLS negotiation\n    <TLS negotiation>\n   C:   A001 AUTHENTICATE SCRAM-SHA-256\n         biwsbj11c2VyLHI9ck9wck5HZndFYmVSV2diTkVrcU8=\n   S:   + cj1yT3ByTkdmd0ViZVJXZ2JORWtxTyVodllEcFdVYTJSYVRDQWZ1eEZJbGopaE\n        5sRiRrMCxzPVcyMlphSjBTTlk3c29Fc1VFamI2Z1E9PSxpPTQwOTY=\n   C:   Yz1iaXdzLHI9ck9wck5HZndFYmVSV2diTkVrcU8laHZZRHBXVWEyUmFUQ0FmdXhG\n        SWxqKWhObEYkazAscD1kSHpiWmFwV0lrNGpVaE4rVXRlOXl0YWc5empmTUhnc3Ft\n        bWl6N0FuZFZRPQ==\n   S:   + dj02cnJpVFJCaTIzV3BSUi93dHVwK21NaFVaVW4vZEI1bkxUSlJzamw5NUc0\n        PQ==\n   C:\n   S:   A001 OK SCRAM-SHA-256 authentication successful\n   C:   babc ENABLE IMAP4rev2\n   S:   * ENABLED IMAP4rev2\n   S:   babc OK Some capabilities enabled\n   C:   a002 select inbox\n   S:   * 18 EXISTS\n   S:   * FLAGS (\\Answered \\Flagged \\Deleted \\Seen \\Draft)\n   S:   * OK [UIDVALIDITY 3857529045] UIDs valid\n   S:   * LIST () \"/\" INBOX (\"OLDNAME\" (\"inbox\"))\n   S:   a002 OK [READ-WRITE] SELECT completed\n   C:   a003 fetch 12 full\n   S:   * 12 FETCH (FLAGS (\\Seen) INTERNALDATE\n         \"17-Jul-1996 02:44:25 -0700\" RFC822.SIZE 4286 ENVELOPE (\n         \"Wed, 17 Jul 1996 02:23:25 -0700 (PDT)\"\n         \"IMAP4rev2 WG mtg summary and minutes\"\n         ((\"Terry Gray\" NIL \"gray\" \"cac.washington.edu\"))\n         ((\"Terry Gray\" NIL \"gray\" \"cac.washington.edu\"))\n         ((\"Terry Gray\" NIL \"gray\" \"cac.washington.edu\"))\n         ((NIL NIL \"imap\" \"cac.washington.edu\"))\n         ((NIL NIL \"minutes\" \"CNRI.Reston.VA.US\")\n         (\"John Klensin\" NIL \"KLENSIN\" \"MIT.EDU\")) NIL NIL\n         \"<B27397-0100000@cac.washington.ed>\")\n         BODY (\"TEXT\" \"PLAIN\" (\"CHARSET\" \"US-ASCII\") NIL NIL \"7BIT\"\n         3028 92))\n   S:    a003 OK FETCH completed\n   C:    a004 fetch 12 body[header]\n   S:    * 12 FETCH (BODY[HEADER] {342}\n   S:    Date: Wed, 17 Jul 1996 02:23:25 -0700 (PDT)\n   S:    From: Terry Gray <gray@cac.washington.edu>\n   S:    Subject: IMAP4rev2 WG mtg summary and minutes\n   S:    To: imap@cac.washington.edu\n   S:    cc: minutes@CNRI.Reston.VA.US, John Klensin <KLENSIN@MIT.EDU>\n   S:    Message-Id: <B27397-0100000@cac.washington.edu>\n   S:    MIME-Version: 1.0\n   S:    Content-Type: TEXT/PLAIN; CHARSET=US-ASCII\n   S:\n   S:    )\n   S:    a004 OK FETCH completed\n   C:    a005 store 12 +flags \\deleted\n   S:    * 12 FETCH (FLAGS (\\Seen \\Deleted))\n   S:    a005 OK +FLAGS completed\n   C:    a006 logout\n   S:    * BYE IMAP4rev2 server terminating connection\n   S:    a006 OK LOGOUT completed\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"Ready\", \"TlsNegotiation\", \"Authenticated\", \"Selected\", \"Logout\"],\n  \"transitions\": [\n    {\n      \"from\": \"Ready\",\n      \"event\": \"receive STARTTLS\",\n      \"action\": \"reply OK Proceed\",\n      \"to\": \"TlsNegotiation\"\n    },\n    {\n      \"from\": \"TlsNegotiation\",\n      \"event\": \"receive AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive ENABLE\",\n      \"action\": \"reply ENABLED OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive SELECT\",\n      \"action\": \"reply READ-WRITE\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive FETCH\",\n      \"action\": \"reply FETCH OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive STORE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE OK\",\n      \"to\": \"Logout\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 9. Formal Syntax",
      "prompt": "\nYou will be given the section \"Section 9. Formal Syntax\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nThe following syntax specification uses the Augmented Backus-Naur\n   Form (ABNF) notation as specified in [ABNF].\n   In the case of alternative or optional rules in which a later rule\n   overlaps an earlier rule, the rule that is listed earlier MUST take\n   priority.  For example, \"\\Seen\" when parsed as a flag is the \\Seen\n   flag name and not a flag-extension, even though \"\\Seen\" can be parsed\n   as a flag-extension.  Some, but not all, instances of this rule are\n   noted below.\n     Note: [ABNF] rules MUST be followed strictly; in particular:\n   1.  Unless otherwise noted, all alphabetic characters are case\n       insensitive.  The use of uppercase or lowercase characters to\n       define token strings is for editorial clarity only.\n       Implementations MUST accept these strings in a case-insensitive\n       fashion.\n   2.  In all cases, SP refers to exactly one space.  It is NOT\n       permitted to substitute TAB, insert additional spaces, or\n       otherwise treat SP as being equivalent to linear whitespace\n       (LWSP).\n   3.  The ASCII NUL character, %x00, MUST NOT be used anywhere, with\n       the exception of the OCTET production.\n   SP              = <Defined in RFC 5234>\n   CTL             = <Defined in RFC 5234>\n   CRLF            = <Defined in RFC 5234>\n   ALPHA           = <Defined in RFC 5234>\n   DIGIT           = <Defined in RFC 5234>\n   DQUOTE          = <Defined in RFC 5234>\n   OCTET           = <Defined in RFC 5234>\n   address         = \"(\" addr-name SP addr-adl SP addr-mailbox SP\n                     addr-host \")\"\n   addr-adl        = nstring\n                       ; Holds route from [RFC5322] obs-route if\n                       ; non-NIL\n   addr-host       = nstring\n                       ; NIL indicates [RFC5322] group syntax.\n                       ; Otherwise, holds [RFC5322] domain name\n   addr-mailbox    = nstring\n                       ; NIL indicates end of [RFC5322] group; if\n                       ; non-NIL and addr-host is NIL, holds\n                       ; [RFC5322] group name.\n                       ; Otherwise, holds [RFC5322] local-part\n                       ; after removing [RFC5322] quoting\n   addr-name       = nstring\n                       ; If non-NIL, holds phrase from [RFC5322]\n                       ; mailbox after removing [RFC5322] quoting\n   append          = \"APPEND\" SP mailbox [SP flag-list] [SP date-time]\n                     SP literal\n   append-uid      = uniqueid\n   astring         = 1*ASTRING-CHAR / string\n   ASTRING-CHAR   = ATOM-CHAR / resp-specials\n   atom            = 1*ATOM-CHAR\n   ATOM-CHAR       = <any CHAR except atom-specials>\n   atom-specials   = \"(\" / \")\" / \"{\" / SP / CTL / list-wildcards /\n                     quoted-specials / resp-specials\n   authenticate    = \"AUTHENTICATE\" SP auth-type [SP initial-resp]\n                     *(CRLF base64)\n   auth-type       = atom\n                       ; Authentication mechanism name, as defined by\n                       ; [SASL], Section 7.1\n   base64          = *(4base64-char) [base64-terminal]\n   base64-char     = ALPHA / DIGIT / \"+\" / \"/\"\n                       ; Case sensitive\n   base64-terminal = (2base64-char \"==\") / (3base64-char \"=\")\n   body            = \"(\" (body-type-1part / body-type-mpart) \")\"\n   body-extension  = nstring / number / number64 /\n                      \"(\" body-extension *(SP body-extension) \")\"\n                       ; Future expansion.  Client implementations\n                       ; MUST accept body-extension fields.  Server\n                       ; implementations MUST NOT generate\n                       ; body-extension fields except as defined by\n                       ; future Standard or Standards Track\n                       ; revisions of this specification.\n   body-ext-1part  = body-fld-md5 [SP body-fld-dsp [SP body-fld-lang\n                     [SP body-fld-loc *(SP body-extension)]]]\n                       ; MUST NOT be returned on non-extensible\n                       ; \"BODY\" fetch\n   body-ext-mpart  = body-fld-param [SP body-fld-dsp [SP body-fld-lang\n                     [SP body-fld-loc *(SP body-extension)]]]\n                       ; MUST NOT be returned on non-extensible\n                       ; \"BODY\" fetch\n   body-fields     = body-fld-param SP body-fld-id SP body-fld-desc SP\n                     body-fld-enc SP body-fld-octets\n   body-fld-desc   = nstring\n   body-fld-dsp    = \"(\" string SP body-fld-param \")\" / nil\n   body-fld-enc    = (DQUOTE (\"7BIT\" / \"8BIT\" / \"BINARY\" / \"BASE64\"/\n                     \"QUOTED-PRINTABLE\") DQUOTE) / string\n                     ; Content-Transfer-Encoding header field value.\n                     ; Defaults to \"7BIT\" (as per RFC 2045)\n                     ; if not present in the body part.\n   body-fld-id     = nstring\n   body-fld-lang   = nstring / \"(\" string *(SP string) \")\"\n   body-fld-loc    = nstring\n   body-fld-lines  = number64\n   body-fld-md5    = nstring\n   body-fld-octets = number\n   body-fld-param  = \"(\" string SP string *(SP string SP string) \")\" /\n                     nil\n   body-type-1part = (body-type-basic / body-type-msg / body-type-text)\n                     [SP body-ext-1part]\n   body-type-basic = media-basic SP body-fields\n                       ; MESSAGE subtype MUST NOT be \"RFC822\" or\n                       ; \"GLOBAL\"\n   body-type-mpart = 1*body SP media-subtype\n                     [SP body-ext-mpart]\n                       ; MULTIPART body part\n   body-type-msg   = media-message SP body-fields SP envelope\n                     SP body SP body-fld-lines\n   body-type-text  = media-text SP body-fields SP body-fld-lines\n   capability      = (\"AUTH=\" auth-type) / atom\n                       ; New capabilities SHOULD be\n                       ; registered with IANA using the\n                       ; RFC Required policy, i.e., in\n                       ; a Standards Track, an Experimental,\n                       ; or an Informational RFC.\n   capability-data = \"CAPABILITY\" *(SP capability) SP \"IMAP4rev2\"\n                     *(SP capability)\n                       ; See Section 6.1.1 for information about\n                       ; required security-related capabilities.\n                       ; Servers that offer RFC 1730 compatibility MUST\n                       ; list \"IMAP4\" as the first capability.\n                       ; Servers that offer RFC 3501 compatibility MUST\n                       ; list \"IMAP4rev1\" as one of the capabilities.\n   CHAR            = <defined in [ABNF]>\n   CHAR8           = %x01-ff\n                       ; any OCTET except NUL, %x00\n   charset         = atom / quoted\n   childinfo-extended-item =  \"CHILDINFO\" SP \"(\"\n               list-select-base-opt-quoted\n               *(SP list-select-base-opt-quoted) \")\"\n               ; Extended data item (mbox-list-extended-item)\n               ; returned when the RECURSIVEMATCH\n               ; selection option is specified.\n               ; Note 1: the CHILDINFO extended data item tag can be\n               ; returned with or without surrounding quotes, as per\n               ; mbox-list-extended-item-tag production.\n               ; Note 2: The selection options are always returned\n               ; quoted, unlike their specification in\n               ; the extended LIST command.\n   child-mbox-flag =  \"\\HasChildren\" / \"\\HasNoChildren\"\n               ; attributes for the CHILDREN return option, at most\n               ; one possible per LIST response\n   command         = tag SP (command-any / command-auth /\n                     command-nonauth / command-select) CRLF\n                       ; Modal based on state\n   command-any     = \"CAPABILITY\" / \"LOGOUT\" / \"NOOP\"\n                       ; Valid in all states\n   command-auth    = append / create / delete / enable / examine /\n                     list / namespace-command / rename /\n                     select / status / subscribe / unsubscribe /\n                     idle\n                       ; Valid only in Authenticated or Selected state\n   command-nonauth = login / authenticate / \"STARTTLS\"\n                       ; Valid only when in Not Authenticated state\n   command-select  = \"CLOSE\" / \"UNSELECT\" / \"EXPUNGE\" / copy /\n                      move / fetch / store / search / uid\n                       ; Valid only when in Selected state\n   continue-req    = \"+\" SP (resp-text / base64) CRLF\n   copy            = \"COPY\" SP sequence-set SP mailbox\n   create          = \"CREATE\" SP mailbox\n                       ; Use of INBOX gives a NO error\n   date            = date-text / DQUOTE date-text DQUOTE\n   date-day        = 1*2DIGIT\n                       ; Day of month\n   date-day-fixed  = (SP DIGIT) / 2DIGIT\n                       ; Fixed-format version of date-day\n   date-month      = \"Jan\" / \"Feb\" / \"Mar\" / \"Apr\" / \"May\" / \"Jun\" /\n                     \"Jul\" / \"Aug\" / \"Sep\" / \"Oct\" / \"Nov\" / \"Dec\"\n   date-text       = date-day \"-\" date-month \"-\" date-year\n   date-year       = 4DIGIT\n   date-time       = DQUOTE date-day-fixed \"-\" date-month \"-\" date-year\n                     SP time SP zone DQUOTE\n   delete          = \"DELETE\" SP mailbox\n                       ; Use of INBOX gives a NO error\n   digit-nz        = %x31-39\n                       ; 1-9\n   eitem-standard-tag =  atom\n               ; a tag for LIST extended data item defined in a Standard\n               ; Track or Experimental RFC.\n   eitem-vendor-tag =  vendor-token \"-\" atom\n               ; a vendor-specific tag for LIST extended data item\n   enable          = \"ENABLE\" 1*(SP capability)\n   enable-data     = \"ENABLED\" *(SP capability)\n   envelope        = \"(\" env-date SP env-subject SP env-from SP\n                     env-sender SP env-reply-to SP env-to SP env-cc SP\n                     env-bcc SP env-in-reply-to SP env-message-id \")\"\n   env-bcc         = \"(\" 1*address \")\" / nil\n   env-cc          = \"(\" 1*address \")\" / nil\n   env-date        = nstring\n   env-from        = \"(\" 1*address \")\" / nil\n   env-in-reply-to = nstring\n   env-message-id  = nstring\n   env-reply-to    = \"(\" 1*address \")\" / nil\n   env-sender      = \"(\" 1*address \")\" / nil\n   env-subject     = nstring\n   env-to          = \"(\" 1*address \")\" / nil\n   esearch-response  = \"ESEARCH\" [search-correlator] [SP \"UID\"]\n                       *(SP search-return-data)\n                     ; ESEARCH response replaces SEARCH response\n                     ; from IMAP4rev1.\n   examine         = \"EXAMINE\" SP mailbox\n   fetch           = \"FETCH\" SP sequence-set SP (\n                     \"ALL\" / \"FULL\" / \"FAST\" /\n                     fetch-att / \"(\" fetch-att *(SP fetch-att) \")\")\n   fetch-att       = \"ENVELOPE\" / \"FLAGS\" / \"INTERNALDATE\" /\n                     \"RFC822.SIZE\" /\n                     \"BODY\" [\"STRUCTURE\"] / \"UID\" /\n                     \"BODY\" section [partial] /\n                     \"BODY.PEEK\" section [partial] /\n                     \"BINARY\" [\".PEEK\"] section-binary [partial] /\n                     \"BINARY.SIZE\" section-binary\n   flag            = \"\\Answered\" / \"\\Flagged\" / \"\\Deleted\" /\n                     \"\\Seen\" / \"\\Draft\" / flag-keyword / flag-extension\n                       ; Does not include \"\\Recent\"\n   flag-extension  = \"\\\" atom\n                       ; Future expansion.  Client implementations\n                       ; MUST accept flag-extension flags.  Server\n                       ; implementations MUST NOT generate\n                       ; flag-extension flags except as defined by\n                       ; a future Standard or Standards Track\n                       ; revisions of this specification.\n                       ; \"\\Recent\" was defined in RFC 3501\n                       ; and is now deprecated.\n   flag-fetch      = flag / obsolete-flag-recent\n   flag-keyword    = \"$MDNSent\" / \"$Forwarded\" / \"$Junk\" /\n                     \"$NotJunk\" / \"$Phishing\" / atom\n   flag-list       = \"(\" [flag *(SP flag)] \")\"\n   flag-perm       = flag / \"\\*\"\n   greeting        = \"*\" SP (resp-cond-auth / resp-cond-bye) CRLF\n   header-fld-name = astring\n   header-list     = \"(\" header-fld-name *(SP header-fld-name) \")\"\n   idle            = \"IDLE\" CRLF \"DONE\"\n   initial-resp    =  (base64 / \"=\")\n                      ; \"initial response\" defined in\n                      ; Section 4 of [SASL]\n   list            = \"LIST\" [SP list-select-opts] SP\n                     mailbox SP mbox-or-pat\n                     [SP list-return-opts]\n   list-mailbox    = 1*list-char / string\n   list-char       = ATOM-CHAR / list-wildcards / resp-specials\n   list-return-opt   =  return-option\n                        ; Note that return-option is the ABNF\n                        ; non-terminal used by RFC 5258\n   list-return-opts =  \"RETURN\" SP\n               \"(\" [list-return-opt *(SP list-return-opt)] \")\"\n               ; list return options, e.g., CHILDREN\n   list-select-base-opt =  \"SUBSCRIBED\" / option-extension\n               ; options that can be used by themselves\n   list-select-base-opt-quoted =  DQUOTE list-select-base-opt DQUOTE\n   list-select-independent-opt =  \"REMOTE\" / option-extension\n               ; options that do not syntactically interact with\n               ; other options\n   list-select-mod-opt =  \"RECURSIVEMATCH\" / option-extension\n               ; options that require a list-select-base-opt\n               ; to also be present\n   list-select-opt =  list-select-base-opt / list-select-independent-opt\n                      / list-select-mod-opt\n   list-select-opts =  \"(\" [\n                      (*(list-select-opt SP) list-select-base-opt\n                      *(SP list-select-opt))\n                     / (list-select-independent-opt\n                      *(SP list-select-independent-opt))\n                        ] \")\"\n               ; Any number of options may be in any order.\n               ; If a list-select-mod-opt appears, then a\n               ; list-select-base-opt must also appear.\n               ; This allows these:\n               ; ()\n               ; (REMOTE)\n               ; (SUBSCRIBED)\n               ; (SUBSCRIBED REMOTE)\n               ; (SUBSCRIBED RECURSIVEMATCH)\n               ; (SUBSCRIBED REMOTE RECURSIVEMATCH)\n               ; But does NOT allow these:\n               ; (RECURSIVEMATCH)\n               ; (REMOTE RECURSIVEMATCH)\n   list-wildcards  = \"%\" / \"*\"\n   literal         = \"{\" number64 [\"+\"] \"}\" CRLF *CHAR8\n                       ; <number64> represents the number of CHAR8s.\n                       ; A non-synchronizing literal is distinguished\n                       ; from a synchronizing literal by the presence of\n                       ; \"+\" before the closing \"}\".\n                       ; Non-synchronizing literals are not allowed when\n                       ; sent from server to the client.\n   literal8        =  \"~{\" number64 \"}\" CRLF *OCTET\n                       ; <number64> represents the number of OCTETs\n                       ; in the response string.\n   login           = \"LOGIN\" SP userid SP password\n   mailbox         = \"INBOX\" / astring\n                       ; INBOX is case insensitive.  All case variants\n                       ; of INBOX (e.g., \"iNbOx\") MUST be interpreted as\n                       ; INBOX, not as an astring.  An astring that\n                       ; consists of the case-insensitive sequence\n                       ; \"I\" \"N\" \"B\" \"O\" \"X\" is considered\n                       ; to be an INBOX and not an astring.\n                       ; Refer to Section 5.1 for further\n                       ; semantic details of mailbox names.\n   mailbox-data    =  \"FLAGS\" SP flag-list / \"LIST\" SP mailbox-list /\n                      esearch-response /\n                      \"STATUS\" SP mailbox SP \"(\" [status-att-list] \")\" /\n                      number SP \"EXISTS\" / namespace-response /\n                      obsolete-search-response /\n                      obsolete-recent-response\n                       ; obsolete-search-response and\n                       ; obsolete-recent-response can only be returned\n                       ; by servers that support both IMAPrev1\n                       ; and IMAPrev2.\n   mailbox-list    = \"(\" [mbx-list-flags] \")\" SP\n                      (DQUOTE QUOTED-CHAR DQUOTE / nil) SP mailbox\n                      [SP mbox-list-extended]\n               ; This is the list information pointed to by the ABNF\n               ; item \"mailbox-data\", which is defined above\n   mbox-list-extended =  \"(\" [mbox-list-extended-item\n                         *(SP mbox-list-extended-item)] \")\"\n   mbox-list-extended-item = mbox-list-extended-item-tag SP\n                              tagged-ext-val\n   mbox-list-extended-item-tag = astring\n                  ; The content MUST conform to either\n                  ; \"eitem-vendor-tag\" or \"eitem-standard-tag\"\n                  ; ABNF productions.\n   mbox-or-pat =  list-mailbox / patterns\n   mbx-list-flags  = *(mbx-list-oflag SP) mbx-list-sflag\n                     *(SP mbx-list-oflag) /\n                     mbx-list-oflag *(SP mbx-list-oflag)\n   mbx-list-oflag  = \"\\Noinferiors\" / child-mbox-flag /\n                     \"\\Subscribed\" / \"\\Remote\" / flag-extension\n                  ; Other flags; multiple from this list are\n                  ; possible per LIST response, but each flag\n                  ; can only appear once per LIST response\n   mbx-list-sflag  = \"\\NonExistent\" / \"\\Noselect\" / \"\\Marked\" /\n                     \"\\Unmarked\"\n                  ; Selectability flags; only one per LIST response\n   media-basic     = ((DQUOTE (\"APPLICATION\" / \"AUDIO\" / \"IMAGE\" /\n                     \"FONT\" / \"MESSAGE\" / \"MODEL\" / \"VIDEO\" ) DQUOTE)\n                     / string)\n                     SP media-subtype\n                       ; FONT defined in [RFC8081].\n                       ; MODEL defined in [RFC2077].\n                       ; Other top-level media types\n                       ; are defined in [MIME-IMT].\n   media-message   = DQUOTE \"MESSAGE\" DQUOTE SP\n                     DQUOTE (\"RFC822\" / \"GLOBAL\") DQUOTE\n                       ; Defined in [MIME-IMT]\n   media-subtype   = string\n                       ; Defined in [MIME-IMT]\n   media-text      = DQUOTE \"TEXT\" DQUOTE SP media-subtype\n                       ; Defined in [MIME-IMT]\n   message-data    = nz-number SP (\"EXPUNGE\" / (\"FETCH\" SP msg-att))\n   move            = \"MOVE\" SP sequence-set SP mailbox\n   msg-att         = \"(\" (msg-att-dynamic / msg-att-static)\n                      *(SP (msg-att-dynamic / msg-att-static)) \")\"\n   msg-att-dynamic = \"FLAGS\" SP \"(\" [flag-fetch *(SP flag-fetch)] \")\"\n                       ; MAY change for a message\n   msg-att-static  = \"ENVELOPE\" SP envelope /\n                     \"INTERNALDATE\" SP date-time /\n                     \"RFC822.SIZE\" SP number64 /\n                     \"BODY\" [\"STRUCTURE\"] SP body /\n                     \"BODY\" section [\"<\" number \">\"] SP nstring /\n                     \"BINARY\" section-binary SP (nstring / literal8) /\n                     \"BINARY.SIZE\" section-binary SP number /\n                     \"UID\" SP uniqueid\n                       ; MUST NOT change for a message\n   name-component  = 1*UTF8-CHAR\n                       ; MUST NOT contain \".\", \"/\", \"%\", or \"*\"\n   namespace         = nil / \"(\" 1*namespace-descr \")\"\n   namespace-command = \"NAMESPACE\"\n   namespace-descr   = \"(\" string SP\n                          (DQUOTE QUOTED-CHAR DQUOTE / nil)\n                           [namespace-response-extensions] \")\"\n   namespace-response-extensions = *namespace-response-extension\n   namespace-response-extension = SP string SP\n                     \"(\" string *(SP string) \")\"\n   namespace-response = \"NAMESPACE\" SP namespace\n                         SP namespace SP namespace\n                    ; The first Namespace is the Personal Namespace(s).\n                    ; The second Namespace is the Other Users'\n                    ; Namespace(s).\n                    ; The third Namespace is the Shared Namespace(s).\n   nil             = \"NIL\"\n   nstring         = string / nil\n   number          = 1*DIGIT\n                       ; Unsigned 32-bit integer\n                       ; (0 <= n < 4,294,967,296)\n   number64        = 1*DIGIT\n                       ; Unsigned 63-bit integer\n                       ; (0 <= n <= 9,223,372,036,854,775,807)\n   nz-number       = digit-nz *DIGIT\n                       ; Non-zero unsigned 32-bit integer\n                       ; (0 < n < 4,294,967,296)\n   nz-number64     = digit-nz *DIGIT\n                       ; Unsigned 63-bit integer\n                       ; (0 < n <= 9,223,372,036,854,775,807)\n   obsolete-flag-recent = \"\\Recent\"\n   obsolete-recent-response = number SP \"RECENT\"\n   obsolete-search-response = \"SEARCH\" *(SP nz-number)\n   oldname-extended-item =  \"OLDNAME\" SP \"(\" mailbox \")\"\n                       ; Extended data item (mbox-list-extended-item)\n                       ; returned in a LIST response when a mailbox is\n                       ; renamed or deleted. Also returned when\n                       ; the server canonicalized the provided mailbox\n                       ; name.\n                       ; Note 1: the OLDNAME tag can be returned\n                       ; with or without surrounding quotes, as per\n                       ; mbox-list-extended-item-tag production.\n   option-extension = (option-standard-tag / option-vendor-tag)\n                      [SP option-value]\n   option-standard-tag =  atom\n                  ; an option defined in a Standards Track or\n                  ; Experimental RFC\n   option-val-comp =  astring /\n                      option-val-comp *(SP option-val-comp) /\n                      \"(\" option-val-comp \")\"\n   option-value =  \"(\" option-val-comp \")\"\n   option-vendor-tag =  vendor-token \"-\" atom\n                  ; a vendor-specific option, non-standard\n   partial-range    = number64 [\".\" nz-number64]\n                       ; Copied from RFC 5092 (IMAP URL)\n                       ; and updated to support 64-bit sizes.\n   partial         = \"<\" number64 \".\" nz-number64 \">\"\n                       ; Partial FETCH request. 0-based offset of\n                       ; the first octet, followed by the number of\n                       ; octets in the fragment.\n   password        = astring\n   patterns        = \"(\" list-mailbox \")\"\n                     ; [RFC5258] supports multiple patterns,\n                     ; but this document only requires one\n                     ; to be supported.\n                     ; If the server is also implementing\n                     ; [RFC5258], the \"patterns\" syntax from\n                     ; that document must be followed.\n   quoted          = DQUOTE *QUOTED-CHAR DQUOTE\n   QUOTED-CHAR     = <any TEXT-CHAR except quoted-specials> /\n                     \"\\\" quoted-specials / UTF8-2 / UTF8-3 / UTF8-4\n   quoted-specials = DQUOTE / \"\\\"\n   rename          = \"RENAME\" SP mailbox SP mailbox\n                       ; Use of INBOX as a destination gives a NO error\n   response        = *(continue-req / response-data) response-done\n   response-data   = \"*\" SP (resp-cond-state / resp-cond-bye /\n                     mailbox-data / message-data / capability-data /\n                     enable-data) CRLF\n   response-done   = response-tagged / response-fatal\n   response-fatal  = \"*\" SP resp-cond-bye CRLF\n                       ; Server closes connection immediately\n   response-tagged = tag SP resp-cond-state CRLF\n   resp-code-apnd  = \"APPENDUID\" SP nz-number SP append-uid\n   resp-code-copy  = \"COPYUID\" SP nz-number SP uid-set SP uid-set\n   resp-cond-auth  = (\"OK\" / \"PREAUTH\") SP resp-text\n                       ; Authentication condition\n   resp-cond-bye   = \"BYE\" SP resp-text\n   resp-cond-state = (\"OK\" / \"NO\" / \"BAD\") SP resp-text\n                       ; Status condition\n   resp-specials   = \"]\"\n   resp-text       = [\"[\" resp-text-code \"]\" SP] [text]\n   resp-text-code  = \"ALERT\" /\n                     \"BADCHARSET\" [SP \"(\" charset *(SP charset) \")\" ] /\n                     capability-data / \"PARSE\" /\n                     \"PERMANENTFLAGS\" SP\n                         \"(\" [flag-perm *(SP flag-perm)] \")\" /\n                     \"READ-ONLY\" / \"READ-WRITE\" / \"TRYCREATE\" /\n                     \"UIDNEXT\" SP nz-number /\n                     \"UIDVALIDITY\" SP nz-number /\n                     resp-code-apnd / resp-code-copy / \"UIDNOTSTICKY\" /\n                     \"UNAVAILABLE\" / \"AUTHENTICATIONFAILED\" /\n                     \"AUTHORIZATIONFAILED\" / \"EXPIRED\" /\n                     \"PRIVACYREQUIRED\" / \"CONTACTADMIN\" / \"NOPERM\" /\n                     \"INUSE\" / \"EXPUNGEISSUED\" / \"CORRUPTION\" /\n                     \"SERVERBUG\" / \"CLIENTBUG\" / \"CANNOT\" /\n                     \"LIMIT\" / \"OVERQUOTA\" / \"ALREADYEXISTS\" /\n                     \"NONEXISTENT\" / \"NOTSAVED\" / \"HASCHILDREN\" /\n                     \"CLOSED\" /\n                     \"UNKNOWN-CTE\" /\n                     atom [SP 1*<any TEXT-CHAR except \"]\">]\n   return-option   = \"SUBSCRIBED\" / \"CHILDREN\" / status-option /\n                      option-extension\n   search          = \"SEARCH\" [search-return-opts]\n                     SP search-program\n   search-correlator  = SP \"(\" \"TAG\" SP tag-string \")\"\n   search-key      = \"ALL\" / \"ANSWERED\" / \"BCC\" SP astring /\n                     \"BEFORE\" SP date / \"BODY\" SP astring /\n                     \"CC\" SP astring / \"DELETED\" / \"FLAGGED\" /\n                     \"FROM\" SP astring / \"KEYWORD\" SP flag-keyword /\n                     \"ON\" SP date / \"SEEN\" /\n                     \"SINCE\" SP date / \"SUBJECT\" SP astring /\n                     \"TEXT\" SP astring / \"TO\" SP astring /\n                     \"UNANSWERED\" / \"UNDELETED\" / \"UNFLAGGED\" /\n                     \"UNKEYWORD\" SP flag-keyword / \"UNSEEN\" /\n                       ; Above this line were in [IMAP2]\n                     \"DRAFT\" / \"HEADER\" SP header-fld-name SP astring /\n                     \"LARGER\" SP number64 / \"NOT\" SP search-key /\n                     \"OR\" SP search-key SP search-key /\n                     \"SENTBEFORE\" SP date / \"SENTON\" SP date /\n                     \"SENTSINCE\" SP date / \"SMALLER\" SP number64 /\n                     \"UID\" SP sequence-set / \"UNDRAFT\" / sequence-set /\n                     \"(\" search-key *(SP search-key) \")\"\n   search-modifier-name = tagged-ext-label\n   search-mod-params = tagged-ext-val\n                     ; This non-terminal shows recommended syntax\n                     ; for future extensions.\n   search-program     = [\"CHARSET\" SP charset SP]\n                       search-key *(SP search-key)\n                       ; CHARSET argument to SEARCH MUST be\n                       ; registered with IANA.\n   search-ret-data-ext = search-modifier-name SP search-return-value\n                       ; Note that not every SEARCH return option\n                       ; is required to have the corresponding\n                       ; ESEARCH return data.\n   search-return-data = \"MIN\" SP nz-number /\n                       \"MAX\" SP nz-number /\n                       \"ALL\" SP sequence-set /\n                       \"COUNT\" SP number /\n                       search-ret-data-ext\n                       ; All return data items conform to\n                       ; search-ret-data-ext syntax.\n                       ; Note that \"$\" marker is not allowed\n                       ; after the ALL return data item.\n   search-return-opts = SP \"RETURN\" SP \"(\" [search-return-opt\n                       *(SP search-return-opt)] \")\"\n   search-return-opt  = \"MIN\" / \"MAX\" / \"ALL\" / \"COUNT\" /\n                        \"SAVE\" /\n                        search-ret-opt-ext\n                       ; conforms to generic search-ret-opt-ext\n                       ; syntax\n   search-ret-opt-ext = search-modifier-name [SP search-mod-params]\n   search-return-value = tagged-ext-val\n                       ; Data for the returned search option.\n                       ; A single \"nz-number\"/\"number\"/\"number64\" value\n                       ; can be returned as an atom (i.e., without\n                       ; quoting).  A sequence-set can be returned\n                       ; as an atom as well.\n   section         = \"[\" [section-spec] \"]\"\n   section-binary  = \"[\" [section-part] \"]\"\n   section-msgtext = \"HEADER\" /\n                     \"HEADER.FIELDS\" [\".NOT\"] SP header-list /\n                     \"TEXT\"\n                       ; top-level or MESSAGE/RFC822 or\n                       ; MESSAGE/GLOBAL part\n   section-part    = nz-number *(\".\" nz-number)\n                       ; body part reference.\n                       ; Allows for accessing nested body parts.\n   section-spec    = section-msgtext / (section-part [\".\" section-text])\n   section-text    = section-msgtext / \"MIME\"\n                       ; text other than actual body part (headers,\n                       ; etc.)\n   select          = \"SELECT\" SP mailbox\n   seq-number      = nz-number / \"*\"\n                       ; message sequence number (COPY, FETCH, STORE\n                       ; commands) or unique identifier (UID COPY,\n                       ; UID FETCH, UID STORE commands).\n                       ; * represents the largest number in use.  In\n                       ; the case of message sequence numbers, it is\n                       ; the number of messages in a non-empty mailbox.\n                       ; In the case of unique identifiers, it is the\n                       ; unique identifier of the last message in the\n                       ; mailbox or, if the mailbox is empty, the\n                       ; mailbox's current UIDNEXT value.\n                       ; The server should respond with a tagged BAD\n                       ; response to a command that uses a message\n                       ; sequence number greater than the number of\n                       ; messages in the selected mailbox.  This\n                       ; includes \"*\" if the selected mailbox is empty.\n   seq-range       = seq-number \":\" seq-number\n                       ; two seq-number values and all values between\n                       ; these two regardless of order.\n                       ; Example: 2:4 and 4:2 are equivalent and\n                       ; indicate values 2, 3, and 4.\n                       ; Example: a unique identifier sequence range of\n                       ; 3291:* includes the UID of the last message in\n                       ; the mailbox, even if that value is less than\n                       ; 3291.\n   sequence-set    = (seq-number / seq-range) [\",\" sequence-set]\n                       ; set of seq-number values, regardless of order.\n                       ; Servers MAY coalesce overlaps and/or execute\n                       ; the sequence in any order.\n                       ; Example: a message sequence number set of\n                       ; 2,4:7,9,12:* for a mailbox with 15 messages is\n                       ; equivalent to 2,4,5,6,7,9,12,13,14,15\n                       ; Example: a message sequence number set of\n                       ; *:4,5:7 for a mailbox with 10 messages is\n                       ; equivalent to 10,9,8,7,6,5,4,5,6,7 and MAY\n                       ; be reordered and overlap coalesced to be\n                       ; 4,5,6,7,8,9,10.\n   sequence-set    =/ seq-last-command\n                       ; Allow for \"result of the last command\"\n                       ; indicator.\n   seq-last-command   = \"$\"\n   status          = \"STATUS\" SP mailbox SP\n                     \"(\" status-att *(SP status-att) \")\"\n   status-att      = \"MESSAGES\" / \"UIDNEXT\" / \"UIDVALIDITY\" /\n                     \"UNSEEN\" / \"DELETED\" / \"SIZE\"\n   status-att-val  = (\"MESSAGES\" SP number) /\n                     (\"UIDNEXT\" SP nz-number) /\n                     (\"UIDVALIDITY\" SP nz-number) /\n                     (\"UNSEEN\" SP number) /\n                     (\"DELETED\" SP number) /\n                     (\"SIZE\" SP number64)\n                       ; Extensions to the STATUS responses\n                       ; should extend this production.\n                       ; Extensions should use the generic\n                       ; syntax defined by tagged-ext.\n   status-att-list =  status-att-val *(SP status-att-val)\n   status-option = \"STATUS\" SP \"(\" status-att *(SP status-att) \")\"\n                       ; This ABNF production complies with\n                       ; <option-extension> syntax.\n   store           = \"STORE\" SP sequence-set SP store-att-flags\n   store-att-flags = ([\"+\" / \"-\"] \"FLAGS\" [\".SILENT\"]) SP\n                     (flag-list / (flag *(SP flag)))\n   string          = quoted / literal\n   subscribe       = \"SUBSCRIBE\" SP mailbox\n   tag             = 1*<any ASTRING-CHAR except \"+\">\n   tag-string      = astring\n                     ; <tag> represented as <astring>\n   tagged-ext-label    = tagged-label-fchar *tagged-label-char\n                         ; Is a valid RFC 3501 \"atom\".\n   tagged-label-fchar  = ALPHA / \"-\" / \"_\" / \".\"\n   tagged-label-char   = tagged-label-fchar / DIGIT / \":\"\n   tagged-ext-comp     = astring /\n                         tagged-ext-comp *(SP tagged-ext-comp) /\n                         \"(\" tagged-ext-comp \")\"\n                         ; Extensions that follow this general\n                         ; syntax should use nstring instead of\n                         ; astring when appropriate in the context\n                         ; of the extension.\n                         ; Note that a message set or a \"number\"\n                         ; can always be represented as an \"atom\".\n                         ; A URL should be represented as\n                         ; a \"quoted\" string.\n   tagged-ext-simple   = sequence-set / number / number64\n   tagged-ext-val      = tagged-ext-simple /\n                         \"(\" [tagged-ext-comp] \")\"\n   text            = 1*(TEXT-CHAR / UTF8-2 / UTF8-3 / UTF8-4)\n                       ; Non-ASCII text can only be returned\n                       ; after ENABLE IMAP4rev2 command\n   TEXT-CHAR       = <any CHAR except CR and LF>\n   time            = 2DIGIT \":\" 2DIGIT \":\" 2DIGIT\n                       ; Hours minutes seconds\n   uid             = \"UID\" SP\n                     (copy / move / fetch / search / store /\n                      uid-expunge)\n                       ; Unique identifiers used instead of message\n                       ; sequence numbers\n   uid-expunge     = \"EXPUNGE\" SP sequence-set\n                       ; Unique identifiers used instead of message\n                       ; sequence numbers\n   uid-set         = (uniqueid / uid-range) *(\",\" uid-set)\n   uid-range       = (uniqueid \":\" uniqueid)\n                       ; two uniqueid values and all values\n                       ; between these two regardless of order.\n                       ; Example: 2:4 and 4:2 are equivalent.\n   uniqueid        = nz-number\n                       ; Strictly ascending\n   unsubscribe     = \"UNSUBSCRIBE\" SP mailbox\n   userid          = astring\n   UTF8-CHAR       = <Defined in Section 4 of RFC 3629>\n   UTF8-2          = <Defined in Section 4 of RFC 3629>\n   UTF8-3          = <Defined in Section 4 of RFC 3629>\n   UTF8-4          = <Defined in Section 4 of RFC 3629>\n   vendor-token    = \"vendor.\" name-component\n                       ; Definition copied from RFC 2244.\n                       ; MUST be registered with IANA\n   zone            = (\"+\" / \"-\") 4DIGIT\n                       ; Signed four-digit value of hhmm representing\n                       ; hours and minutes east of Greenwich (that is,\n                       ; the amount that the given time differs from\n                       ; Universal Time).  Subtracting the timezone\n                       ; from the given time will give the UT form.\n                       ; The Universal Time zone is \"+0000\".\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>\n{\n  \"states\": [\"Not_Authenticated\", \"Authenticated\", \"Selected\"],\n  \"transitions\": [\n    {\n      \"from\": \"Not_Authenticated\",\n      \"event\": \"recv LOGIN\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Not_Authenticated\",\n      \"event\": \"recv AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"recv SELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"recv EXAMINE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"recv CLOSE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"recv UNSELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    }\n  ]\n}\n</json>"
    },
    {
      "tag": "Section 10. Author's Note",
      "prompt": "\nYou will be given the section \"Section 10. Author's Note\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nThis document is a revision or rewrite of earlier documents and\n   supercedes the protocol specification in those documents: [RFC3501],\n   [RFC2060], [RFC1730], unpublished IMAP2bis.TXT document, [IMAP2], and\n   [RFC1064].\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>None</json>"
    },
    {
      "tag": "Section 11. Security Considerations",
      "prompt": "\nYou will be given the section \"Section 11. Security Considerations\" of an RFC document for protocol \"IMAP\".\n\n**RESPONSE FORMAT (MANDATORY)**\n- Your reply must consist **exclusively** of the JSON object representing the state machine.\n- That JSON must be wrapped in <json> and </json> tags.\n- Do **not** include any extra text, explanation, code fences, or formatting.\n\n<section>\nIMAP4rev2 protocol transactions, including electronic mail data, are\n   sent in the clear over the network, exposing them to possible\n   eavesdropping and manipulation unless protection is negotiated.  This\n   can be accomplished by use of the Implicit TLS port, the STARTTLS\n   command, negotiated confidentiality protection in the AUTHENTICATE\n   command, or some other protection mechanism.\n11.1.  TLS-Related Security Considerations\n   This section applies to use of both the STARTTLS command and the\n   Implicit TLS port.\n   IMAP client and server implementations MUST comply with relevant TLS\n   recommendations from [RFC8314].  If recommendations/requirements in\n   this document conflict with recommendations from [RFC8314], for\n   example in regards to TLS ciphersuites, recommendations from this\n   document take precedence.\n   Clients and servers MUST implement TLS 1.2 [TLS-1.2] or newer.  Use\n   of TLS 1.3 [TLS-1.3] is RECOMMENDED.  TLS 1.2 may be used only in\n   cases where the other party has not yet implemented TLS 1.3.\n   Additionally, when using TLS 1.2, IMAP implementations MUST implement\n   the TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 cipher suite.  This is\n   important as it ensures that any two compliant implementations can be\n   configured to interoperate.  Other TLS cipher suites recommended in\n   RFC 7525 [RFC7525] are RECOMMENDED:\n   TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,\n   TLS_DHE_RSA_WITH_AES_256_GCM_SHA384, and\n   TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384.  All other cipher suites are\n   OPTIONAL.  Note that this is a change from Section 2.1 of [IMAP-TLS].\n   The list of mandatory-to-implement TLS 1.3 cipher suites is described\n   in Section 9.1 of [TLS-1.3].\n   During the TLS negotiation [TLS-1.3] [TLS-1.2], the client MUST check\n   its understanding of the server hostname against the server's\n   identity as presented in the server Certificate message, in order to\n   prevent on-path attackers attempting to masquerade as the server.\n   This procedure is described in [RFC7817].\n   Both the client and server MUST check the result of the STARTTLS\n   command and subsequent TLS [TLS-1.3] [TLS-1.2] negotiation to see\n   whether acceptable authentication and/or privacy was achieved.\n11.2.  STARTTLS Command versus Use of Implicit TLS Port\n   For maximum backward compatibility, the client MUST implement both\n   TLS negotiation on an Implicit TLS port and TLS negotiation using the\n   STARTTLS command on a cleartext port.\n   The server MUST implement TLS negotiation on an Implicit TLS port.\n   The server SHOULD also implement IMAP on a cleartext port.  If the\n   server listens on a cleartext port, it MUST allow the STARTTLS\n   command on it.\n   Some site/firewall maintainers insist on TLS site-wide and prefer not\n   to rely on a configuration option in each higher-level protocol.  For\n   this reason, IMAP4rev2 clients SHOULD try both ports 993 and 143 (and\n   both IPv4 and IPv6) concurrently by default, unless overridden by\n   either user configuration or DNS SRV records [RFC6186].  A good\n   algorithm for implementing such concurrent connect is described in\n   [RFC8305].\n11.3.  Client Handling of Unsolicited Responses Not Suitable for the\n       Current Connection State\n   Cleartext mail transmission (whether caused by firewall configuration\n   errors that result in TLS stripping or weak security policies in\n   email clients that choose not to negotiate TLS in the first place)\n   can enable injection of responses that can confuse or even cause\n   crashes in email clients.  The following measures are recommended to\n   minimize damage from them.\n   *  See Section 7.1.4 for special security considerations related to\n      the PREAUTH response.\n   *  Many server responses and response codes are only meaningful in\n      authenticated or even selected state.  However, nothing prevents a\n      server (or an on-path attacker) from sending such invalid\n      responses in cleartext before STARTTLS/AUTHENTICATE commands are\n      issued.  Before authentication, clients SHOULD ignore any\n      responses other than CAPABILITY and server status responses\n      (Section 7.1), as well as any response codes other than\n      CAPABILITY.  (In particular, some email clients are known to\n      incorrectly process LIST responses received before authentication,\n      or FETCH responses when no mailbox is selected.)  Clients SHOULD\n      ignore the ALERT response code until after TLS (whether using\n      STARTTLS or TLS negotiation on an Implicit TLS port) or a SASL\n      security layer with confidentiality protection has been\n      successfully negotiated.  Unless explicitly allowed by an IMAP\n      extension, when not in selected state, clients MUST ignore\n      responses / response codes related to message and mailbox status\n      such as FLAGS, EXIST, EXPUNGE, and FETCH.\n11.4.  COPYUID and APPENDUID Response Codes\n   The COPYUID and APPENDUID response codes return information about the\n   mailbox, which may be considered sensitive if the mailbox has\n   permissions set that permit the client to COPY or APPEND to the\n   mailbox, but not SELECT or EXAMINE it.\n   Consequently, these response codes SHOULD NOT be issued if the client\n   does not have access to SELECT or EXAMINE the mailbox.\n11.5.  LIST Command and Other Users' Namespace\n   In response to a LIST command containing an argument of the Other\n   Users' Namespace prefix, a server MUST NOT list users that have not\n   granted list access to their personal mailboxes to the currently\n   authenticated user.  Providing such a list could compromise security\n   by potentially disclosing confidential information of who is located\n   on the server or providing a starting point for a list of user\n   accounts to attack.\n11.6.  Use of MD5\n   The BODYSTRUCTURE FETCH data item can contain the MD5 digest of the\n   message body in the \"body MD5\" field (body-fld-md5 ABNF production).\n   While MD5 is no longer considered a secure cryptographic hash\n   [RFC6151], this field is used solely to expose the value of the\n   Content-MD5 header field (if present in the original message), which\n   is just a message integrity check and is not used for cryptographic\n   purposes.  Also note that other mechanisms that provide message\n   integrity checks were defined since RFC 1864 [MD5] was published and\n   are now more commonly used than Content-MD5.  Two such mechanisms are\n   the DKIM-Signature header field [RFC6376] and S/MIME signing\n   [RFC8550] [RFC8551].\n11.7.  Other Security Considerations\n   A server error message for an AUTHENTICATE command that fails due to\n   invalid credentials SHOULD NOT detail why the credentials are\n   invalid.\n   Use of the LOGIN command sends passwords in the clear.  This can be\n   avoided by using the AUTHENTICATE command with a [SASL] mechanism\n   that does not use plaintext passwords, by first negotiating\n   encryption via STARTTLS or some other protection mechanism.\n   A server implementation MUST implement a configuration that, at the\n   time of authentication, requires:\n   1.  The STARTTLS command has been negotiated or TLS negotiated on an\n       Implicit TLS port\n       OR\n   2.  Some other mechanism that protects the session from password\n       snooping has been provided\n       OR\n   3.  The following measures are in place:\n       a)  The LOGINDISABLED capability is advertised, and [SASL]\n           mechanisms (such as PLAIN) using plaintext passwords are NOT\n           advertised in the CAPABILITY list.\n           AND\n       b)  The LOGIN command returns an error even if the password is\n           correct\n           AND\n       c)  The AUTHENTICATE command returns an error with all [SASL]\n           mechanisms that use plaintext passwords, even if the password\n           is correct.\n   A server error message for a failing LOGIN command SHOULD NOT specify\n   that the user name, as opposed to the password, is invalid.\n   A server SHOULD have mechanisms in place to limit or delay failed\n   AUTHENTICATE/LOGIN attempts.\n   A server SHOULD report any authentication failure and analyze such\n   authentication failure attempts with regard to a password brute-force\n   attack as well as a password spraying attack [NCSC].  Accounts with\n   passwords that match well-known passwords from spraying attacks MUST\n   be blocked, and users associated with such accounts must be requested\n   to change their passwords.  Only a password with significant strength\n   SHOULD be accepted.\n   Additional security considerations are discussed in the sections that\n   define the AUTHENTICATE and LOGIN commands (see Sections 6.2.2 and\n   6.2.3, respectively).\n12.  IANA Considerations\n   IANA has updated the \"Service Names and Transport Protocol Port\n   Numbers\" registry as follows:\n   1.  Registration for TCP port 143 and the corresponding \"imap\"\n       service name have been updated to point to this document and\n       [RFC3501].\n   2.  Registration for TCP port 993 and the corresponding \"imaps\"\n       service name have been updated to point to this document,\n       [RFC8314], and [RFC3501].\n   3.  UDP ports 143 and 993 have both been marked as \"Reserved\" in the\n       registry.\n   Additional IANA actions are specified in the subsections that follow.\n12.1.  Updates to IMAP Capabilities Registry\n   IMAP4 capabilities are registered by publishing a Standards Track or\n   IESG-approved Informational or Experimental RFC.  The registry is\n   currently located at: <https://www.iana.org/assignments/\n   imap4-capabilities>\n   As this specification revises the AUTH= prefix, STARTTLS, and\n   LOGINDISABLED extensions, IANA has updated registry entries for these\n   3 extensions to point to this document and [RFC3501].\n12.2.  GSSAPI/SASL Service Name\n   GSSAPI/Kerberos/SASL service names are registered by publishing a\n   Standards Track or IESG-approved Experimental RFC.  The registry is\n   currently located at: <https://www.iana.org/assignments/gssapi-\n   service-names>\n   IANA has updated the \"imap\" service name previously registered in\n   [RFC3501] to point to both this document and [RFC3501].\n12.3.  LIST Selection Options, LIST Return Options, and LIST Extended\n       Data Items\n   [RFC5258] specifies IANA registration procedures for LIST selection\n   options, LIST return options, and LIST extended data items.  This\n   document doesn't change these registration procedures.  In\n   particular, LIST selection options (Section 6.3.9.1) and LIST return\n   options (Section 6.3.9.2) are registered using the procedure\n   specified in Section 9 of [RFC5258] (and using the registration\n   template from Section 9.3 of [RFC5258]).  LIST extended data items\n   are registered using the registration template from Section 9.6 of\n   [RFC5258]).\n   IANA has added a reference to RFC 9051 for the \"OLDNAME\" LIST-\n   EXTENDED extended data item entry.  This is in addition to the\n   existing reference to [RFC5465].\n12.4.  IMAP Mailbox Name Attributes and IMAP Response Codes\n   IANA has updated the \"IMAP Mailbox Name Attributes\" registry to point\n   to this document in addition to [RFC3501].\n   IANA has updated the \"IMAP Response Codes\" registry to point to this\n   document in addition to [RFC3501].\n13.  References\n13.1.  Normative References\n   [ABNF]     Crocker, D., Ed. and P. Overell, \"Augmented BNF for Syntax\n              Specifications: ABNF\", STD 68, RFC 5234,\n              <https://www.rfc-editor.org/info/rfc5234>.\n   [BCP178]   Saint-Andre, P., Crocker, D., and M. Nottingham,\n              \"Deprecating the \"X-\" Prefix and Similar Constructs in\n              <https://www.rfc-editor.org/info/bcp178>\n   [CHARSET]  Freed, N. and J. Postel, \"IANA Charset Registration\n              Procedures\", BCP 19, RFC 2978, DOI 10.17487/RFC2978,\n   [DISPOSITION]\n              Troost, R., Dorner, S., and K. Moore, Ed., \"Communicating\n              Presentation Information in Internet Messages: The\n              Content-Disposition Header Field\", RFC 2183,\n              <https://www.rfc-editor.org/info/rfc2183>.\n   [I18N-HDRS]\n              Yang, A., Steele, S., and N. Freed, \"Internationalized\n              Email Headers\", RFC 6532, DOI 10.17487/RFC6532, February\n              2012, <https://www.rfc-editor.org/info/rfc6532>.\n   [IMAP-IMPLEMENTATION]\n              Leiba, B., \"IMAP4 Implementation Recommendations\",\n              <https://www.rfc-editor.org/info/rfc2683>.\n   [IMAP-MULTIACCESS]\n              Gahrns, M., \"IMAP4 Multi-Accessed Mailbox Practice\",\n              <https://www.rfc-editor.org/info/rfc2180>.\n   [LANGUAGE-TAGS]\n              Alvestrand, H., \"Content Language Headers\", RFC 3282,\n              <https://www.rfc-editor.org/info/rfc3282>.\n   [LOCATION] Palme, J., Hopmann, A., and N. Shelness, \"MIME\n              Encapsulation of Aggregate Documents, such as HTML\n              <https://www.rfc-editor.org/info/rfc2557>.\n   [MD5]      Myers, J. and M. Rose, \"The Content-MD5 Header Field\",\n              <https://www.rfc-editor.org/info/rfc1864>.\n   [MIME-HDRS]\n              Moore, K., \"MIME (Multipurpose Internet Mail Extensions)\n              Part Three: Message Header Extensions for Non-ASCII Text\",\n              <https://www.rfc-editor.org/info/rfc2047>.\n   [MIME-IMB] Freed, N. and N. Borenstein, \"Multipurpose Internet Mail\n              Extensions (MIME) Part One: Format of Internet Message\n              <https://www.rfc-editor.org/info/rfc2045>.\n   [MIME-IMT] Freed, N. and N. Borenstein, \"Multipurpose Internet Mail\n              Extensions (MIME) Part Two: Media Types\", RFC 2046,\n              <https://www.rfc-editor.org/info/rfc2046>.\n   [MULTIAPPEND]\n              Crispin, M., \"Internet Message Access Protocol (IMAP) -\n              MULTIAPPEND Extension\", RFC 3502, DOI 10.17487/RFC3502,\n   [NET-UNICODE]\n              Klensin, J. and M. Padlipsky, \"Unicode Format for Network\n              <https://www.rfc-editor.org/info/rfc5198>.\n   [PLAIN]    Zeilenga, K., Ed., \"The PLAIN Simple Authentication and\n              Security Layer (SASL) Mechanism\", RFC 4616,\n              <https://www.rfc-editor.org/info/rfc4616>.\n   [RFC2077]  Nelson, S., Parks, C., and , \"The Model Primary Content\n              Type for Multipurpose Internet Mail Extensions\", RFC 2077,\n              <https://www.rfc-editor.org/info/rfc2077>.\n   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n              <https://www.rfc-editor.org/info/rfc2119>.\n   [RFC2231]  Freed, N. and K. Moore, \"MIME Parameter Value and Encoded\n              Word Extensions: Character Sets, Languages, and\n              Continuations\", RFC 2231, DOI 10.17487/RFC2231, November\n              1997, <https://www.rfc-editor.org/info/rfc2231>.\n   [RFC3503]  Melnikov, A., \"Message Disposition Notification (MDN)\n              profile for Internet Message Access Protocol (IMAP)\",\n              <https://www.rfc-editor.org/info/rfc3503>.\n   [RFC4648]  Josefsson, S., \"The Base16, Base32, and Base64 Data\n              <https://www.rfc-editor.org/info/rfc4648>.\n   [RFC4752]  Melnikov, A., Ed., \"The Kerberos V5 (\"GSSAPI\") Simple\n              Authentication and Security Layer (SASL) Mechanism\",\n              <https://www.rfc-editor.org/info/rfc4752>.\n   [RFC5258]  Leiba, B. and A. Melnikov, \"Internet Message Access\n              Protocol version 4 - LIST Command Extensions\", RFC 5258,\n              <https://www.rfc-editor.org/info/rfc5258>.\n   [RFC5322]  Resnick, P., Ed., \"Internet Message Format\", RFC 5322,\n              <https://www.rfc-editor.org/info/rfc5322>.\n   [RFC5788]  Melnikov, A. and D. Cridland, \"IMAP4 Keyword Registry\",\n              <https://www.rfc-editor.org/info/rfc5788>.\n   [RFC7525]  Sheffer, Y., Holz, R., and P. Saint-Andre,\n              \"Recommendations for Secure Use of Transport Layer\n              Security (TLS) and Datagram Transport Layer Security\n              (DTLS)\", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May\n              2015, <https://www.rfc-editor.org/info/rfc7525>.\n   [RFC7817]  Melnikov, A., \"Updated Transport Layer Security (TLS)\n              Server Identity Check Procedure for Email-Related\n              <https://www.rfc-editor.org/info/rfc7817>.\n   [RFC8081]  Lilley, C., \"The \"font\" Top-Level Media Type\", RFC 8081,\n              <https://www.rfc-editor.org/info/rfc8081>.\n   [RFC8098]  Hansen, T., Ed. and A. Melnikov, Ed., \"Message Disposition\n              Notification\", STD 85, RFC 8098, DOI 10.17487/RFC8098,\n   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC\n              2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,\n   [RFC8314]  Moore, K. and C. Newman, \"Cleartext Considered Obsolete:\n              Use of Transport Layer Security (TLS) for Email Submission\n              <https://www.rfc-editor.org/info/rfc8314>.\n   [SASL]     Melnikov, A., Ed. and K. Zeilenga, Ed., \"Simple\n              Authentication and Security Layer (SASL)\", RFC 4422,\n              <https://www.rfc-editor.org/info/rfc4422>.\n   [SCRAM-SHA-256]\n              Hansen, T., \"SCRAM-SHA-256 and SCRAM-SHA-256-PLUS Simple\n              Authentication and Security Layer (SASL) Mechanisms\",\n              <https://www.rfc-editor.org/info/rfc7677>.\n   [TLS-1.2]  Dierks, T. and E. Rescorla, \"The Transport Layer Security\n              (TLS) Protocol Version 1.2\", RFC 5246,\n              <https://www.rfc-editor.org/info/rfc5246>.\n   [TLS-1.3]  Rescorla, E., \"The Transport Layer Security (TLS) Protocol\n              <https://www.rfc-editor.org/info/rfc8446>.\n   [UTF-7]    Goldsmith, D. and M. Davis, \"UTF-7 A Mail-Safe\n              Transformation Format of Unicode\", RFC 2152,\n              <https://www.rfc-editor.org/info/rfc2152>.\n   [UTF-8]    Yergeau, F., \"UTF-8, a transformation format of ISO\n              10646\", STD 63, RFC 3629, DOI 10.17487/RFC3629, November\n              2003, <https://www.rfc-editor.org/info/rfc3629>.\n13.2.  Informative References\n13.2.1.  Related Protocols\n   [ANONYMOUS]\n              Zeilenga, K., \"Anonymous Simple Authentication and\n              Security Layer (SASL) Mechanism\", RFC 4505,\n              <https://www.rfc-editor.org/info/rfc4505>.\n   [CERT-555316]\n              Carnegie Mellon University, \"STARTTLS plaintext command\n              injection vulnerability\", Software Engineering Institute,\n              CERT Coordination Center, Vulnerability Note VU#555316,\n              September 2011, <https://www.kb.cert.org/vuls/id/555316>.\n   [CHARSET-REG]\n              IANA, \"Character Set Registrations\",\n              <https://www.iana.org/assignments/charset-reg/>.\n   [IMAP-DISC]\n              Melnikov, A., Ed., \"Synchronization Operations for\n              Disconnected IMAP4 Clients\", RFC 4549,\n              <https://www.rfc-editor.org/info/rfc4549>.\n   [IMAP-I18N]\n              Newman, C., Gulbrandsen, A., and A. Melnikov, \"Internet\n              Message Access Protocol Internationalization\", RFC 5255,\n              <https://www.rfc-editor.org/info/rfc5255>.\n   [IMAP-KEYWORDS-REG]\n              IANA, \"IMAP and JMAP Keywords\",\n              <https://www.iana.org/assignments/imap-jmap-keywords/>.\n   [IMAP-MAILBOX-NAME-ATTRS-REG]\n              IANA, \"IMAP Mailbox Name Attributes\",\n              <https://www.iana.org/assignments/imap-mailbox-name-\n              attributes/>.\n   [IMAP-MODEL]\n              Crispin, M., \"Distributed Electronic Mail Models in\n              <https://www.rfc-editor.org/info/rfc1733>.\n   [IMAP-URL] Melnikov, A., Ed. and C. Newman, \"IMAP URL Scheme\",\n              <https://www.rfc-editor.org/info/rfc5092>.\n   [IMAP-UTF-8]\n              Resnick, P., Ed., Newman, C., Ed., and S. Shen, Ed., \"IMAP\n              Support for UTF-8\", RFC 6855, DOI 10.17487/RFC6855, March\n              2013, <https://www.rfc-editor.org/info/rfc6855>.\n   [NCSC]     NCSC, \"Spray you, spray me: defending against password\n              spraying attacks\", May 2018, <https://www.ncsc.gov.uk/\n              blog-post/spray-you-spray-me-defending-against-password-\n              spraying-attacks>.\n   [RFC2087]  Myers, J., \"IMAP4 QUOTA extension\", RFC 2087,\n              <https://www.rfc-editor.org/info/rfc2087>.\n   [RFC2177]  Leiba, B., \"IMAP4 IDLE command\", RFC 2177,\n              <https://www.rfc-editor.org/info/rfc2177>.\n   [RFC2193]  Gahrns, M., \"IMAP4 Mailbox Referrals\", RFC 2193,\n              <https://www.rfc-editor.org/info/rfc2193>.\n   [RFC2342]  Gahrns, M. and C. Newman, \"IMAP4 Namespace\", RFC 2342,\n              <https://www.rfc-editor.org/info/rfc2342>.\n   [RFC3348]  Gahrns, M. and R. Cheng, \"The Internet Message Action\n              Protocol (IMAP4) Child Mailbox Extension\", RFC 3348,\n              <https://www.rfc-editor.org/info/rfc3348>.\n   [RFC3516]  Nerenberg, L., \"IMAP4 Binary Content Extension\", RFC 3516,\n              <https://www.rfc-editor.org/info/rfc3516>.\n   [RFC3691]  Melnikov, A., \"Internet Message Access Protocol (IMAP)\n              UNSELECT command\", RFC 3691, DOI 10.17487/RFC3691,\n   [RFC4314]  Melnikov, A., \"IMAP4 Access Control List (ACL) Extension\",\n              <https://www.rfc-editor.org/info/rfc4314>.\n   [RFC4315]  Crispin, M., \"Internet Message Access Protocol (IMAP) -\n              UIDPLUS extension\", RFC 4315, DOI 10.17487/RFC4315,\n   [RFC4466]  Melnikov, A. and C. Daboo, \"Collected Extensions to IMAP4\n              <https://www.rfc-editor.org/info/rfc4466>.\n   [RFC4731]  Melnikov, A. and D. Cridland, \"IMAP4 Extension to SEARCH\n              Command for Controlling What Kind of Information Is\n              <https://www.rfc-editor.org/info/rfc4731>.\n   [RFC4959]  Siemborski, R. and A. Gulbrandsen, \"IMAP Extension for\n              Simple Authentication and Security Layer (SASL) Initial\n              Client Response\", RFC 4959, DOI 10.17487/RFC4959,\n   [RFC5161]  Gulbrandsen, A., Ed. and A. Melnikov, Ed., \"The IMAP\n              ENABLE Extension\", RFC 5161, DOI 10.17487/RFC5161, March\n              2008, <https://www.rfc-editor.org/info/rfc5161>.\n   [RFC5182]  Melnikov, A., \"IMAP Extension for Referencing the Last\n              SEARCH Result\", RFC 5182, DOI 10.17487/RFC5182, March\n              2008, <https://www.rfc-editor.org/info/rfc5182>.\n   [RFC5256]  Crispin, M. and K. Murchison, \"Internet Message Access\n              Protocol - SORT and THREAD Extensions\", RFC 5256,\n              <https://www.rfc-editor.org/info/rfc5256>.\n   [RFC5465]  Gulbrandsen, A., King, C., and A. Melnikov, \"The IMAP\n              NOTIFY Extension\", RFC 5465, DOI 10.17487/RFC5465,\n   [RFC5530]  Gulbrandsen, A., \"IMAP Response Codes\", RFC 5530,\n              <https://www.rfc-editor.org/info/rfc5530>.\n   [RFC5819]  Melnikov, A. and T. Sirainen, \"IMAP4 Extension for\n              Returning STATUS Information in Extended LIST\", RFC 5819,\n              <https://www.rfc-editor.org/info/rfc5819>.\n   [RFC6151]  Turner, S. and L. Chen, \"Updated Security Considerations\n              for the MD5 Message-Digest and the HMAC-MD5 Algorithms\",\n              <https://www.rfc-editor.org/info/rfc6151>.\n   [RFC6154]  Leiba, B. and J. Nicolson, \"IMAP LIST Extension for\n              Special-Use Mailboxes\", RFC 6154, DOI 10.17487/RFC6154,\n   [RFC6186]  Daboo, C., \"Use of SRV Records for Locating Email\n              Submission/Access Services\", RFC 6186,\n              <https://www.rfc-editor.org/info/rfc6186>.\n   [RFC6376]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,\n              \"DomainKeys Identified Mail (DKIM) Signatures\", STD 76,\n              <https://www.rfc-editor.org/info/rfc6376>.\n   [RFC6409]  Gellens, R. and J. Klensin, \"Message Submission for Mail\",\n              <https://www.rfc-editor.org/info/rfc6409>.\n   [RFC6851]  Gulbrandsen, A. and N. Freed, Ed., \"Internet Message\n              Access Protocol (IMAP) - MOVE Extension\", RFC 6851,\n              <https://www.rfc-editor.org/info/rfc6851>.\n   [RFC7162]  Melnikov, A. and D. Cridland, \"IMAP Extensions: Quick Flag\n              Changes Resynchronization (CONDSTORE) and Quick Mailbox\n              Resynchronization (QRESYNC)\", RFC 7162,\n              <https://www.rfc-editor.org/info/rfc7162>.\n   [RFC7888]  Melnikov, A., Ed., \"IMAP4 Non-synchronizing Literals\",\n              <https://www.rfc-editor.org/info/rfc7888>.\n   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, \"Guidelines for\n              Writing an IANA Considerations Section in RFCs\", BCP 26,\n              <https://www.rfc-editor.org/info/rfc8126>.\n   [RFC8305]  Schinazi, D. and T. Pauly, \"Happy Eyeballs Version 2:\n              Better Connectivity Using Concurrency\", RFC 8305,\n              <https://www.rfc-editor.org/info/rfc8305>.\n   [RFC8438]  Bosch, S., \"IMAP Extension for STATUS=SIZE\", RFC 8438,\n              <https://www.rfc-editor.org/info/rfc8438>.\n   [RFC8474]  Gondwana, B., Ed., \"IMAP Extension for Object\n              Identifiers\", RFC 8474, DOI 10.17487/RFC8474, September\n              2018, <https://www.rfc-editor.org/info/rfc8474>.\n   [RFC8550]  Schaad, J., Ramsdell, B., and S. Turner, \"Secure/\n              Multipurpose Internet Mail Extensions (S/MIME) Version 4.0\n              Certificate Handling\", RFC 8550, DOI 10.17487/RFC8550,\n   [RFC8551]  Schaad, J., Ramsdell, B., and S. Turner, \"Secure/\n              Multipurpose Internet Mail Extensions (S/MIME) Version 4.0\n              Message Specification\", RFC 8551, DOI 10.17487/RFC8551,\n   [SMTP]     Klensin, J., \"Simple Mail Transfer Protocol\", RFC 5321,\n              <https://www.rfc-editor.org/info/rfc5321>.\n13.2.2.  Historical Aspects of IMAP and Related Protocols\n   [IMAP-COMPAT]\n              Crispin, M., \"IMAP4 Compatibility with IMAP2bis\",\n              <https://www.rfc-editor.org/info/rfc2061>.\n   [IMAP-HISTORICAL]\n              Crispin, M., \"IMAP4 Compatibility with IMAP2 and\n              <https://www.rfc-editor.org/info/rfc1732>.\n   [IMAP-OBSOLETE]\n              Crispin, M., \"Internet Message Access Protocol - Obsolete\n              <https://www.rfc-editor.org/info/rfc2062>.\n   [IMAP-TLS] Newman, C., \"Using TLS with IMAP, POP3 and ACAP\",\n              <https://www.rfc-editor.org/info/rfc2595>.\n   [IMAP2]    Crispin, M., \"Interactive Mail Access Protocol: Version\n              <https://www.rfc-editor.org/info/rfc1176>.\n   [IMAP2BIS] Crispin, M., \"INTERACTIVE MAIL ACCESS PROTOCOL - VERSION\n              2bis\", Work in Progress, Internet-Draft, draft-ietf-imap-\n              imap2bis-02, 29 October 1993,\n              <https://datatracker.ietf.org/doc/html/draft-ietf-imap-\n              imap2bis-02>.\n   [RFC1064]  Crispin, M., \"Interactive Mail Access Protocol: Version\n              <https://www.rfc-editor.org/info/rfc1064>.\n   [RFC1730]  Crispin, M., \"Internet Message Access Protocol - Version\n              <https://www.rfc-editor.org/info/rfc1730>.\n   [RFC2060]  Crispin, M., \"Internet Message Access Protocol - Version\n              <https://www.rfc-editor.org/info/rfc2060>.\n   [RFC3501]  Crispin, M., \"INTERNET MESSAGE ACCESS PROTOCOL - VERSION\n              <https://www.rfc-editor.org/info/rfc3501>.\n   [RFC822]   Crocker, D., \"STANDARD FOR THE FORMAT OF ARPA INTERNET\n              TEXT MESSAGES\", STD 11, RFC 822, DOI 10.17487/RFC0822,\nAppendix A.  Backward Compatibility with IMAP4rev1\n   An implementation that wants to remain compatible with IMAP4rev1 can\n   advertise both IMAP4rev1 and IMAP4rev2 in its CAPABILITY response /\n   response code.  (Such server implementation is likely to also want to\n   advertise other IMAP4rev1 extensions that were folded into IMAP4rev2;\n   see Appendix E.)  While some IMAP4rev1 responses were removed in\n   IMAP4rev2, their presence will not break IMAP4rev2-only clients.\n   If both IMAP4rev1 and IMAP4rev2 are advertised, an IMAP client that\n   wants to use IMAP4rev2 MUST issue an \"ENABLE IMAP4rev2\" command.\n   When compared to IMAP4rev1, some request data items, corresponding\n   response data items, and responses were removed in IMAP4rev2.  See\n   Appendix E for more details.  With the exception of obsolete SEARCH\n   and RECENT responses, servers advertising both IMAP4rev1 and\n   IMAP4rev2 would never return such removed response data items/\n   responses unless explicitly requested by an IMAPrev1 client.\n   Servers advertising both IMAP4rev1 and IMAP4rev2 MUST NOT generate\n   UTF-8-quoted strings unless the client has issued \"ENABLE IMAP4rev2\".\n   Consider implementation of mechanisms described or referenced in\n   [IMAP-UTF-8] to achieve this goal.\n   Servers advertising both IMAP4rev1 and IMAP4rev2, and clients\n   intending to be compatible with IMAP4rev1 servers, MUST be compatible\n   with the Mailbox International Naming Convention described in\n   Appendix A.1.\n   Also see Appendix D for special considerations for servers that\n   support 63-bit body part / message sizes and want to advertise\n   support for both IMAP4rev1 and IMAP4rev2.\nA.1.  Mailbox International Naming Convention for Compatibility with\n      IMAP4rev1\n   Support for the Mailbox International Naming Convention described in\n   this section is not required for IMAP4rev2-only clients and servers.\n   It is only used for backward compatibility with IMAP4rev1\n   implementations.\n   By convention, international mailbox names in IMAP4rev1 are specified\n   using a modified version of the UTF-7 encoding described in [UTF-7].\n   Modified UTF-7 may also be usable in servers that implement an\n   earlier version of this protocol.\n   In modified UTF-7, printable US-ASCII characters, except for \"&\",\n   represent themselves; that is, characters with octet values 0x20-0x25\n   and 0x27-0x7e.  The character \"&\" (0x26) is represented by the\n   2-octet sequence \"&-\".\n   All other characters (octet values 0x00-0x1f and 0x7f-0xff) are\n   represented in modified base64, with a further modification from\n   [UTF-7] that \",\" is used instead of \"/\".  Modified base64 MUST NOT be\n   used to represent any printing of a US-ASCII character that can\n   represent itself.  Only characters inside the modified base64\n   alphabet are permitted in modified base64 text.\n   \"&\" is used to shift to modified base64 and \"-\" to shift back to US-\n   ASCII.  There is no implicit shift from base64 to US-ASCII, and null\n   shifts (\"-&\" while in base64; note that \"&-\" while in US-ASCII means\n   \"&\") are not permitted.  However, all names start in US-ASCII and\n   MUST end in US-ASCII; that is, a name that ends with a non-ASCII\n   ISO-10646 character MUST end with a \"-\".\n   The purpose of these modifications is to correct the following\n   problems with UTF-7:\n   1.  UTF-7 uses the \"+\" character for shifting; this conflicts with\n       the common use of \"+\" in mailbox names, in particular USENET\n       newsgroup names.\n   2.  UTF-7's encoding is base64, which uses the \"/\" character; this\n       conflicts with the use of \"/\" as a popular hierarchy delimiter.\n   3.  UTF-7 prohibits the unencoded usage of \"\\\"; this conflicts with\n       the use of \"\\\" as a popular hierarchy delimiter.\n   4.  UTF-7 prohibits the unencoded usage of \"~\"; this conflicts with\n       the use of \"~\" in some servers as a home directory indicator.\n   5.  UTF-7 permits multiple alternate forms to represent the same\n       string; in particular, printable US-ASCII characters can be\n       represented in encoded form.\n   Although modified UTF-7 is a convention, it establishes certain\n   requirements on the server handling of any mailbox name with an\n   embedded \"&\" character.  In particular, server implementations MUST\n   preserve the exact form of the modified base64 portion of a modified\n   UTF-7 name and treat that text as case sensitive, even if names are\n   otherwise case insensitive or case folded.\n   Server implementations SHOULD verify that any mailbox name with an\n   embedded \"&\" character, used as an argument to CREATE, is: in the\n   correctly modified UTF-7 syntax; has no superfluous shifts; and has\n   no encoding in modified base64 of any printing US-ASCII character\n   that can represent itself.  However, client implementations MUST NOT\n   depend upon the server doing this and SHOULD NOT attempt to create a\n   mailbox name with an embedded \"&\" character unless it complies with\n   the modified UTF-7 syntax.\n   Server implementations that export a mail store that does not follow\n   the modified UTF-7 convention MUST convert any mailbox name that\n   contains either non-ASCII characters or the \"&\" character to modified\n   UTF-7.\n      For example, here is a mailbox name that mixes English, Chinese,\n      and Japanese text: ~peter/mail/&U,BTFw-/&ZeVnLIqe-\n      For example, the string \"&Jjo!\" is not a valid mailbox name\n      because it does not contain a shift to US-ASCII before the \"!\".\n      The correct form is \"&Jjo-!\".  The string \"&U,BTFw-&ZeVnLIqe-\" is\n      not permitted because it contains a superfluous shift.  The\n      correct form is \"&U,BTF2XlZyyKng-\".\nAppendix B.  Backward Compatibility with BINARY Extension\n   IMAP4rev2 incorporates a subset of functionality provided by the\n   BINARY extension [RFC3516]; in particular, it includes additional\n   FETCH items (BINARY, BINARY.PEEK, and BINARY.SIZE) but not extensions\n   to the APPEND command.  IMAP4rev2 implementations that support full\n   [RFC3516] functionality need to also advertise the BINARY capability\n   in the CAPABILITY response / response code.\nAppendix C.  Backward Compatibility with LIST-EXTENDED Extension\n   IMAP4rev2 incorporates most of the functionality provided by the\n   LIST-EXTENDED extension [RFC5258].  In particular, the syntax for\n   multiple mailbox patterns is not supported in IMAP4rev2, unless LIST-\n   EXTENDED capability is also advertised in the CAPABILITY response /\n   response code.\nAppendix D.  63-Bit Body Part and Message Sizes\n   IMAP4rev2 increases allowed body part and message sizes that servers\n   can support from 32 to 63 bits.  Server implementations don't have to\n   support 63-bit-long body parts/message sizes; however, client\n   implementations have to expect them.\n   As IMAP4rev1 didn't support 63-bit-long body part / message sizes,\n   there is an interoperability issue exposed by 63-bit-capable servers/\n   mailboxes that are accessible by both IMAP4rev1 and IMAP4rev2 email\n   clients.  As IMAP4rev1 would be unable to retrieve the full content\n   of messages bigger than 4 Gb, such servers either need to replace\n   messages bigger that 4 Gb with messages under 4 Gb or hide them from\n   IMAP4rev1 clients.  This document doesn't prescribe any\n   implementation strategy to address this issue.\nAppendix E.  Changes from RFC 3501 / IMAP4rev1\n   Below is the summary of changes since RFC 3501:\n   1.   Support for 64-bit message and body part sizes.\n   2.   Folded in IMAP NAMESPACE [RFC2342], UNSELECT [RFC3691], UIDPLUS\n        [RFC4315], ESEARCH [RFC4731], SEARCHRES [RFC5182], ENABLE\n        [RFC5161], IDLE [RFC2177], SASL-IR [RFC4959], LIST-EXTENDED\n        [RFC5258], LIST-STATUS [RFC5819], MOVE [RFC6851], and LITERAL-\n        extensions [RFC7888].  Also folded in IMAP ABNF extensions\n        [RFC4466], response codes [RFC5530], the FETCH side of the\n        BINARY extension [RFC3516], and the list of new mailbox\n        attributes from SPECIAL-USE [RFC6154].\n   3.   Added STATUS SIZE [RFC8438] and STATUS DELETED.\n   4.   SEARCH command now requires to return the ESEARCH response\n        (SEARCH response is now deprecated).\n   5.   Clarified which SEARCH keys have to use substring match and\n        which don't.\n   6.   Clarified that the server should decode parameter value\n        continuations as described in [RFC2231].  This requirement was\n        hidden in [RFC2231] itself.\n   7.   Clarified that the COPYUID response code is returned for both\n        MOVE and UID MOVE.\n   8.   Tightened requirements about COPY/MOVE commands not creating a\n        target mailbox.  Also required them to return the TRYCREATE\n        response code, if the target mailbox doesn't exist and can be\n        created.\n   9.   Added the CLOSED response code from [RFC7162].  SELECT/EXAMINE\n        when a mailbox is already selected now requires a CLOSED\n        response code to be returned.\n   10.  SELECT/EXAMINE are now required to return an untagged LIST\n        response.\n   11.  UNSEEN response code on SELECT/EXAMINE is now deprecated.\n   12.  RECENT response on SELECT/EXAMINE, \\Recent flag, RECENT STATUS,\n        and SEARCH NEW items are now deprecated.\n   13.  Clarified that the server doesn't need to send a new\n        PERMANENTFLAGS response code when a new keyword was successfully\n        added and the server advertised \\* earlier for the same mailbox.\n   14.  For future extensibility, extended ABNF for tagged-ext-simple to\n        allow for bare number64.\n   15.  Added SHOULD level requirement on IMAP servers to support\n        $MDNSent, $Forwarded, $Junk, $NonJunk, and $Phishing keywords.\n   16.  Mailbox names and message headers now allow for UTF-8.  Support\n        for modified UTF-7 in mailbox names is not required, unless\n        compatibility with IMAP4rev1 is desired.\n   17.  Removed the CHECK command.  Clients should use NOOP instead.\n   18.  RFC822, RFC822.HEADER, and RFC822.TEXT FETCH data items were\n        deprecated.  Clients should use the corresponding BODY[]\n        variants instead.\n   19.  LSUB command was deprecated.  Clients should use LIST\n        (SUBSCRIBED) instead.\n   20.  IDLE command can now return updates not related to the currently\n        selected mailbox state.\n   21.  All unsolicited FETCH updates are required to include UID.\n   22.  Clarified that client implementations MUST ignore response codes\n        that they do not recognize.  (Changed from a SHOULD to a MUST.)\n   23.  resp-text ABNF non-terminal was updated to allow for empty text.\n   24.  After ENABLE, IMAP4rev2 human-readable response text can include\n        non-ASCII encoded in UTF-8.\n   25.  Updated to use modern TLS-related recommendations as per\n        [RFC7525], [RFC7817], and [RFC8314].\n   26.  Added warnings about use of ALERT response codes and PREAUTH\n        response.\n   27.  Replaced DIGEST-MD5 SASL mechanism with SCRAM-SHA-256.  DIGEST-\n        MD5 was deprecated.\n   28.  Clarified that any command received from the client resets\n        server autologout timer.\n   29.  Revised IANA registration procedure for IMAP extensions and\n        removed \"X\" convention in accordance with [BCP178].\n   30.  Loosened requirements on servers when closing connections to be\n        more aligned with existing practices.\nAppendix F.  Other Recommended IMAP Extensions\n   Support for the following extensions is recommended for all IMAP\n   clients and servers.  While they significantly reduce bandwidth and/\n   or number of round trips used by IMAP in certain situations, the\n   EXTRA WG decided that requiring them as a part of IMAP4rev2 would\n   push the bar to implement too high for new implementations.  Also\n   note that the absence of any IMAP extension from this list doesn't\n   make it somehow deficient or not recommended for use with IMAP4rev2.\n   1.  Quick Mailbox Resynchronization (QRESYNC) and CONDSTORE\n       extensions [RFC7162].  They make discovering changes to IMAP\n       mailboxes more efficient, at the expense of storing a bit more\n       state.\n   2.  OBJECTID extension [RFC8474] helps with preserving the IMAP\n       client cache when messages are moved/copied or mailboxes are\n       renamed.\nAcknowledgements\n   Earlier draft versions of this document were edited by Mark Crispin.\n   Sadly, he is no longer available to help with this work.  Editors of\n   this revision are hoping that Mark would have approved.\n   Chris Newman has contributed text on I18N and use of UTF-8 in\n   messages and mailbox names.\n   Thank you to Tony Hansen for helping with the index generation.\n   Thank you to Murray Kucherawy, Timo Sirainen, Bron Gondwana, Stephan\n   Bosch, Robert Sparks, Arnt Gulbrandsen, Benjamin Kaduk, Daniel\n   Migaul, Roman Danyliw, and \u00c9ric Vyncke for extensive feedback.\n   This document incorporates text from [RFC2342] (by Mike Gahrns and\n   Chris Newman), [RFC3516] (by Lyndon Nerenberg), [RFC4315] (by Mark\n   Crispin), [RFC4466] (by Cyrus Daboo), [RFC4731] (by Dave Cridland),\n   [RFC4959] (by Rob Siemborski and Arnt Gulbrandsen), [RFC5161] (by\n   Arnt Gulbrandsen), [RFC5465] (by Arnt Gulbrandsen and Curtis King),\n   [RFC5530] (by Arnt Gulbrandsen), [RFC5819] (by Timo Sirainen),\n   [RFC6154] (by Jamie Nicolson), [RFC6851] (by Arnt Gulbrandsen and Ned\n   Freed), and [RFC8438] (by Stephan Bosch), so work done by authors/\n   editors of these documents is appreciated.  Note that editors of this\n   document were redacted from the above list.\n   The CHILDREN return option was originally proposed by Mike Gahrns and\n   Raymond Cheng in [RFC3348].  Most of the information in\n   Section 6.3.9.5 is taken directly from their original specification\n   [RFC3348].\n   Thank you to Damian Poddebniak, Fabian Ising, Hanno Boeck, and\n   Sebastian Schinzel for pointing out that the ENABLE command should be\n   a member of \"command-auth\" and not \"command-any\" ABNF production, as\n   well as pointing out security issues associated with ALERT, PREAUTH,\n   and other responses received before authentication.\nIndex\n   $ + - \\ A B C D E F H I K L M N O P R S T U\n      $\n         $Forwarded (predefined flag)\n            Section 2.3.2\n         $Junk (predefined flag)\n            Section 2.3.2\n         $MDNSent (predefined flag)\n            Section 2.3.2\n         $NotJunk (predefined flag)\n            Section 2.3.2\n         $Phishing (predefined flag)\n            Section 2.3.2, Paragraph 6.10.1\n      +\n         +FLAGS <flag list>\n            Section 6.4.6\n         +FLAGS.SILENT <flag list>\n            Section 6.4.6\n      -\n         -FLAGS <flag list>\n            Section 6.4.6\n         -FLAGS.SILENT <flag list>\n            Section 6.4.6\n      \\\n         \\All (mailbox name attribute)\n            Section 7.3.1\n         \\Answered (system flag)\n            Section 2.3.2\n         \\Archive (mailbox name attribute)\n            Section 7.3.1\n         \\Deleted (system flag)\n            Section 2.3.2\n         \\Draft (system flag)\n            Section 2.3.2\n         \\Drafts (mailbox name attribute)\n            Section 7.3.1\n         \\Flagged (mailbox name attribute)\n            Section 7.3.1\n         \\Flagged (system flag)\n            Section 2.3.2\n         \\HasChildren (mailbox name attribute)\n            Section 7.3.1\n         \\HasNoChildren (mailbox name attribute)\n            Section 7.3.1\n         \\Junk (mailbox name attribute)\n            Section 7.3.1\n         \\Marked (mailbox name attribute)\n            Section 7.3.1\n         \\Noinferiors (mailbox name attribute)\n            Section 7.3.1\n         \\NonExistent (mailbox name attribute)\n            Section 7.3.1, Paragraph 4.2.1\n         \\Noselect (mailbox name attribute)\n            Section 7.3.1\n         \\Recent (system flag)\n            Section 2.3.2\n         \\Remote (mailbox name attribute)\n            Section 7.3.1\n         \\Seen (system flag)\n            Section 2.3.2\n         \\Sent (mailbox name attribute)\n            Section 7.3.1\n         \\Subscribed (mailbox name attribute)\n            Section 7.3.1\n         \\Trash (mailbox name attribute)\n            Section 7.3.1\n         \\Unmarked (mailbox name attribute)\n            Section 7.3.1\n      A\n         ALERT (response code)\n            Section 7.1\n         ALL (fetch item)\n            Section 6.4.5\n         ALL (search key)\n            Section 6.4.4\n         ALL (search result option)\n            Section 6.4.4, Paragraph 6.6.1\n         ALL (search return item name)\n            Section 7.3.4, Paragraph 7.6.1\n         ALREADYEXISTS (response code)\n            Section 7.1, Paragraph 4.4.1\n         ANSWERED (search key)\n            Section 6.4.4\n         APPEND (command)\n            Section 6.3.12\n         APPENDUID (response code)\n            Section 7.1, Paragraph 4.6.1\n         AUTHENTICATE (command)\n            Section 6.2.2\n         AUTHENTICATIONFAILED (response code)\n            Section 7.1, Paragraph 4.8.1\n         AUTHORIZATIONFAILED (response code)\n            Section 7.1, Paragraph 4.10.1\n      B\n         BAD (response)\n            Section 7.1.3\n         BADCHARSET (response code)\n            Section 7.1\n         BCC <string> (search key)\n            Section 6.4.4\n         BEFORE <date> (search key)\n            Section 6.4.4\n         BINARY.PEEK[<section-binary>]<<partial>> (fetch item)\n            Section 6.4.5\n         BINARY.SIZE[<section-binary>] (fetch item)\n            Section 6.4.5, Paragraph 9.6.1\n         BINARY.SIZE[<section-binary>] (fetch result)\n            Section 7.5.2, Paragraph 4.4.1\n         BINARY[<section-binary>]<<number>> (fetch result)\n            Section 7.5.2, Paragraph 4.2.1\n         BINARY[<section-binary>]<<partial>> (fetch item)\n            Section 6.4.5, Paragraph 9.2.1\n         BODY (fetch item)\n            Section 6.4.5\n         BODY (fetch result)\n            Section 7.5.2\n         BODY <string> (search key)\n            Section 6.4.4\n         BODY.PEEK[<section>]<<partial>> (fetch item)\n            Section 6.4.5\n         BODYSTRUCTURE (fetch item)\n            Section 6.4.5\n         BODYSTRUCTURE (fetch result)\n            Section 7.5.2, Paragraph 4.10.1\n         BODY[<section>]<<origin octet>> (fetch result)\n            Section 7.5.2, Paragraph 4.8.1\n         BODY[<section>]<<partial>> (fetch item)\n            Section 6.4.5, Paragraph 9.10.1\n         BYE (response)\n            Section 7.1.5\n         Body Structure (message attribute)\n            Section 2.3.6\n      C\n         CANNOT (response code)\n            Section 7.1, Paragraph 4.14.1\n         CAPABILITY (command)\n            Section 6.1.1\n         CAPABILITY (response code)\n            Section 7.1\n         CAPABILITY (response)\n            Section 7.2.2\n         CC <string> (search key)\n            Section 6.4.4\n         CLIENTBUG (response code)\n            Section 7.1, Paragraph 4.18.1\n         CLOSE (command)\n            Section 6.4.1\n         CLOSED (response code)\n            Section 7.1, Paragraph 4.20.1\n         CONTACTADMIN (response code)\n            Section 7.1, Paragraph 4.22.1\n         COPY (command)\n            Section 6.4.7\n         COPYUID (response code)\n            Section 7.1, Paragraph 4.24.1\n         CORRUPTION (response code)\n            Section 7.1, Paragraph 4.26.1\n         COUNT (search result option)\n            Section 6.4.4\n         COUNT (search return item name)\n            Section 7.3.4\n         CREATE (command)\n            Section 6.3.4\n      D\n         DELETE (command)\n            Section 6.3.5\n         DELETED (search key)\n            Section 6.4.4\n         DELETED (status item)\n            Section 6.3.11\n         DRAFT (search key)\n            Section 6.4.4\n      E\n         ENABLE (command)\n            Section 6.3.1\n         ENVELOPE (fetch item)\n            Section 6.4.5\n         ENVELOPE (fetch result)\n            Section 7.5.2, Paragraph 4.42.1\n         ESEARCH (response)\n            Section 7.3.4\n         EXAMINE (command)\n            Section 6.3.3\n         EXPIRED (response code)\n            Section 7.1, Paragraph 4.28.1\n         EXPUNGE (command)\n            Section 6.4.3\n         EXPUNGE (response)\n            Section 7.5.1\n         EXPUNGEISSUED (response code)\n            Section 7.1, Paragraph 4.30.1\n         Envelope Structure (message attribute)\n            Section 2.3.5\n      F\n         FAST (fetch item)\n            Section 6.4.5\n         FETCH (command)\n            Section 6.4.5\n         FETCH (response)\n            Section 7.5.2\n         FLAGGED (search key)\n            Section 6.4.4\n         FLAGS (fetch item)\n            Section 6.4.5\n         FLAGS (fetch result)\n            Section 7.5.2\n         FLAGS (response)\n            Section 7.3.5\n         FLAGS <flag list> (store command data item)\n            Section 6.4.6\n         FLAGS.SILENT <flag list> (store command data item)\n            Section 6.4.6\n         FROM <string> (search key)\n            Section 6.4.4\n         FULL (fetch item)\n            Section 6.4.5\n         Flags (message attribute)\n            Section 2.3.2\n      H\n         HASCHILDREN (response code)\n            Section 7.1, Paragraph 4.32.1\n         HEADER (part specifier)\n            Section 6.4.5.1, Paragraph 5\n         HEADER <field-name> <string> (search key)\n            Section 6.4.4\n         HEADER.FIELDS (part specifier)\n            Section 6.4.5.1, Paragraph 5\n         HEADER.FIELDS.NOT (part specifier)\n            Section 6.4.5.1, Paragraph 5\n      I\n         IDLE (command)\n            Section 6.3.13\n         INTERNALDATE ( fetch item)\n            Section 6.4.5\n         INTERNALDATE (fetch result)\n            Section 7.5.2\n         INUSE (response code)\n            Section 7.1, Paragraph 4.34.1\n         Internal Date (message attribute)\n            Section 2.3.3\n      K\n         KEYWORD <flag> (search key)\n            Section 6.4.4\n         Keyword (type of flag)\n            Section 2.3.2, Paragraph 4\n      L\n         LARGER <n> (search key)\n            Section 6.4.4\n         LIMIT (response code)\n            Section 7.1, Paragraph 4.36.1\n         LIST (command)\n            Section 6.3.9\n         LIST (response)\n            Section 7.3.1\n         LOGOUT (command)\n            Section 6.1.3\n      M\n         MAX (search result option)\n            Section 6.4.4, Paragraph 6.4.1\n         MAX (search return item name)\n            Section 7.3.4, Paragraph 7.4.1\n         MAY (specification requirement term)\n            Section 1.2\n         MESSAGES (status item)\n            Section 6.3.11\n         MIME (part specifier)\n            Section 6.4.5.1, Paragraph 7\n         MIN (search result option)\n            Section 6.4.4, Paragraph 6.2.1\n         MIN (search return item name)\n            Section 7.3.4, Paragraph 7.2.1\n         MOVE (command)\n            Section 6.4.8\n         MUST (specification requirement term)\n            Section 1.2\n         MUST NOT (specification requirement term)\n            Section 1.2\n         Message Sequence Number (message attribute)\n            Section 2.3.1.2\n      N\n         NAMESPACE (command)\n            Section 6.3.10\n         NAMESPACE (response)\n            Section 7.3.2\n         NO (response)\n            Section 7.1.2\n         NONEXISTENT (response code)\n            Section 7.1, Paragraph 4.38.1\n         NOOP (command)\n            Section 6.1.2\n         NOPERM (response code)\n            Section 7.1, Paragraph 4.40.1\n         NOT <search-key> (search key)\n            Section 6.4.4\n         NOT RECOMMENDED (specification requirement term)\n            Section 1.2\n      O\n         OK (response)\n            Section 7.1.1\n         ON <date> (search key)\n            Section 6.4.4\n         OPTIONAL (specification requirement term)\n            Section 1.2; Section 1.2\n         OR <search-key1> <search-key2> (search key)\n            Section 6.4.4\n         OVERQUOTA (response code)\n            Section 7.1, Paragraph 4.42.1\n      P\n         PARSE (response code)\n            Section 7.1\n         PERMANENTFLAGS (response code)\n            Section 7.1, Paragraph 4.46.1\n         PREAUTH (response)\n            Section 7.1.4\n         PRIVACYREQUIRED (response code)\n            Section 7.1, Paragraph 4.48.1\n         Permanent Flag (class of flag)\n            Section 2.3.2, Paragraph 9\n         Predefined keywords\n            Section 2.3.2, Paragraph 5\n      R\n         READ-ONLY (response code)\n            Section 7.1\n         READ-WRITE (response code)\n            Section 7.1\n         RECOMMENDED (specification requirement term)\n            Section 1.2\n         RENAME (command)\n            Section 6.3.6\n         REQUIRED (specification requirement term)\n            Section 1.2\n         RFC822.SIZE (fetch item)\n            Section 6.4.5\n         RFC822.SIZE (fetch result)\n            Section 7.5.2\n         RFC822.SIZE (message attribute)\n            Section 2.3.4\n      S\n         SAVE (search result option)\n            Section 6.4.4, Paragraph 6.10.1\n         SEARCH (command)\n            Section 6.4.4\n         SEEN (search key)\n            Section 6.4.4\n         SELECT (command)\n            Section 6.3.2\n         SENTBEFORE <date> (search key)\n            Section 6.4.4\n         SENTON <date> (search key)\n            Section 6.4.4\n         SENTSINCE <date> (search key)\n            Section 6.4.4\n         SERVERBUG (response code)\n            Section 7.1, Paragraph 4.54.1\n         SHOULD (specification requirement term)\n            Section 1.2\n         SHOULD NOT (specification requirement term)\n            Section 1.2\n         SINCE <date> (search key)\n            Section 6.4.4\n         SIZE (status item)\n            Section 6.3.11\n         SMALLER <n> (search key)\n            Section 6.4.4\n         STARTTLS (command)\n            Section 6.2.1\n         STATUS (command)\n            Section 6.3.11\n         STATUS (response)\n            Section 7.3.3\n         STORE (command)\n            Section 6.4.6\n         SUBJECT <string> (search key)\n            Section 6.4.4\n         SUBSCRIBE (command)\n            Section 6.3.7\n         Session Flag (class of flag)\n            Section 2.3.2, Paragraph 9\n         System Flag (type of flag)\n            Section 2.3.2, Paragraph 2\n      T\n         TEXT (part specifier)\n            Section 6.4.5.1, Paragraph 5\n         TEXT <string> (search key)\n            Section 6.4.4\n         TO <string> (search key)\n            Section 6.4.4\n         TRYCREATE (response code)\n            Section 7.1\n      U\n         UID (command)\n            Section 6.4.9\n         UID (fetch item)\n            Section 6.4.5\n         UID (fetch result)\n            Section 7.5.2\n         UID <sequence set> (search key)\n            Section 6.4.4\n         UIDNEXT (response code)\n            Section 7.1\n         UIDNEXT (status item)\n            Section 6.3.11\n         UIDNOTSTICKY (response code)\n            Section 7.1, Paragraph 4.60.1\n         UIDVALIDITY (response code)\n            Section 7.1\n         UIDVALIDITY (status item)\n            Section 6.3.11\n         UNANSWERED (search key)\n            Section 6.4.4\n         UNAVAILABLE (response code)\n            Section 7.1, Paragraph 4.64.1\n         UNDELETED (search key)\n            Section 6.4.4\n         UNDRAFT (search key)\n            Section 6.4.4\n         UNFLAGGED (search key)\n            Section 6.4.4\n         UNKEYWORD <flag> (search key)\n            Section 6.4.4\n         UNKNOWN-CTE (response code)\n            Section 7.1\n         UNSEEN (search key)\n            Section 6.4.4\n         UNSEEN (status item)\n            Section 6.3.11\n         UNSELECT (command)\n            Section 6.4.2\n         UNSUBSCRIBE (command)\n            Section 6.3.8\n         Unique Identifier (UID) (message attribute)\n            Section 2.3.1.1\nAuthors' Addresses\n   Alexey Melnikov (editor)\n   Isode Ltd\n   14 Castle Mews\n   Hampton, Middlesex\n   TW12 2NP\n   United Kingdom\n   Email: Alexey.Melnikov@isode.com\n   Barry Leiba (editor)\n   Futurewei Technologies\n   Email: barryleiba@computer.org\n   URI:   http://internetmessagingtechnology.org/\n</section>\n\nSteps:\n1. Determine if this section has any FSM-related information (states, transitions, diagrams, reply codes, sequences).\n2. If **none**, reply exactly:\n   <json>None</json>\n3. If there is FSM information, extract it and return a structured JSON in the following format (strictly):\n\n{\n  \"states\": [\"state1\", \"state2\", \"state3\"],\n  \"transitions\": [\n    {\n      \"from\": \"state1\",\n      \"event\": \"recv COMMAND\",\n      \"action\": \"reply CODE\",\n      \"to\": \"state2\"\n    },\n    ...\n  ]\n}\n\n**FSM Field Constraints:**\n\n\ud83d\udd39 `\"states\"`:\n- List of all states appearing in `\"from\"` or `\"to\"` fields.\n- Each state must:\n  - Be 1 to 3 words (max 30 characters)\n  - Use `CamelCase` or `snake_case`\n  - Describe a protocol phase, status, or role (e.g., `Authenticated`, `WaitingForReply`)\n  - Contain no punctuation, spaces, or free-form descriptions\n\nGood: `\"AwaitingPassword\"`, `\"transfer_in_progress\"`  \nBad: `\"State 1\"`, `\"waiting for command\"`, `\"cmd?\"`\n\n\ud83d\udd39 `\"from\"` / `\"to\"`:\n- Same naming rules as above\n\n\ud83d\udd39 `\"event\"`:\n- Describes the trigger that causes the transition\n- Maybe begin with a fixed prefix:\n  - `\"receive \"` for received command\n  - `\"send \"` for sent response\n  - `\"timeout \"` for timing event\n  - `\"cond \"` for internal condition\n  - or other words \n\nExamples: `\"receive USER\"`, `\"send 230\"`, `\"timeout 5s\"`, `\"cond valid_credentials\"`\n\n\ud83d\udd39 `\"action\"`:\n- Describes what the system does in response\n- It's best start with an action verb from this fixed set or other verbs if needed: `reply`, `send`, `set`, `log`, `reset`, \n`close`, 'collect', `open`, 'record', 'stop'\n- Followed by one or two short arguments (max 4 words total)\n\nExamples: `\"reply 230\"`, `\"log failure\"`, `\"set authenticated true\"`\n\n---\n\nImportant:\n- Do not generate free-text descriptions in any field.\n- Each transition must contain **exactly**: `from`, `event`, `action`, `to`.\n- Do not invent vague or inconsistent state or event names.\n\n---\n\n**OUTPUT RULES:**\n- Wrap the JSON in **<json>\u2026</json>** only.\n- Do not include Markdown, explanations, comments, or extra text.\n- If nothing is found, return exactly `<json>None</json>`.\n\n",
      "response": "<json>None</json>"
    }
  ],
  "final_response": "<json>\n{\n  \"states\": [\"NotAuthenticated\", \"Authenticated\", \"Selected\", \"Logout\", \"Ready\", \"ProcessingCommand\", \"WaitingForContinuation\", \"TlsNegotiation\", \"ConnectionClosed\"],\n  \"initial_state\": \"NotAuthenticated\",\n  \"final_states\": [\"Logout\", \"ConnectionClosed\"],\n  \"transitions\": [\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive LOGIN\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive STARTTLS\",\n      \"action\": \"reply OK\",\n      \"to\": \"NotAuthenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive SELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive EXAMINE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive APPEND\",\n      \"action\": \"reply +\",\n      \"to\": \"WaitingForContinuation\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"timeout 30m\",\n      \"action\": \"close connection\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive any command\",\n      \"action\": \"reset timer\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"receive ENABLE\",\n      \"action\": \"reply ENABLED OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive CLOSE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive UNSELECT\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE and OK\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive FETCH\",\n      \"action\": \"reply FETCH OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"receive STORE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Selected\"\n    },\n    {\n      \"from\": \"Ready\",\n      \"event\": \"receive COMMAND\",\n      \"action\": \"process command\",\n      \"to\": \"ProcessingCommand\"\n    },\n    {\n      \"from\": \"Ready\",\n      \"event\": \"send_sync_literal\",\n      \"action\": \"send_literal_header\",\n      \"to\": \"WaitingForContinuation\"\n    },\n    {\n      \"from\": \"Ready\",\n      \"event\": \"receive STARTTLS\",\n      \"action\": \"reply OK Proceed\",\n      \"to\": \"TlsNegotiation\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"send +\",\n      \"action\": \"reply +\",\n      \"to\": \"WaitingForContinuation\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"send OK/NO/BAD\",\n      \"action\": \"reply tagged\",\n      \"to\": \"Ready\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"receive CONTINUATION\",\n      \"action\": \"process data\",\n      \"to\": \"ProcessingCommand\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"receive_continuation\",\n      \"action\": \"send_data\",\n      \"to\": \"Ready\"\n    },\n    {\n      \"from\": \"TlsNegotiation\",\n      \"event\": \"receive AUTHENTICATE\",\n      \"action\": \"reply OK\",\n      \"to\": \"Authenticated\"\n    },\n    {\n      \"from\": \"NotAuthenticated\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"Authenticated\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"Selected\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"Ready\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"TlsNegotiation\",\n      \"event\": \"send BYE\",\n      \"action\": \"close connection\",\n      \"to\": \"ConnectionClosed\"\n    },\n    {\n      \"from\": \"Ready\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"ProcessingCommand\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"WaitingForContinuation\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE\",\n      \"to\": \"Logout\"\n    },\n    {\n      \"from\": \"TlsNegotiation\",\n      \"event\": \"receive LOGOUT\",\n      \"action\": \"reply BYE\",\n      \"to\": \"Logout\"\n    }\n  ]\n}\n</json>",
  "final_fsm": {
    "states": [
      "NotAuthenticated",
      "Authenticated",
      "Selected",
      "Logout",
      "Ready",
      "ProcessingCommand",
      "WaitingForContinuation",
      "TlsNegotiation",
      "ConnectionClosed"
    ],
    "initial_state": "NotAuthenticated",
    "final_states": [
      "Logout",
      "ConnectionClosed"
    ],
    "transitions": [
      {
        "from": "NotAuthenticated",
        "event": "receive LOGIN",
        "action": "reply OK",
        "to": "Authenticated"
      },
      {
        "from": "NotAuthenticated",
        "event": "receive AUTHENTICATE",
        "action": "reply OK",
        "to": "Authenticated"
      },
      {
        "from": "NotAuthenticated",
        "event": "receive STARTTLS",
        "action": "reply OK",
        "to": "NotAuthenticated"
      },
      {
        "from": "NotAuthenticated",
        "event": "receive LOGOUT",
        "action": "reply BYE and OK",
        "to": "Logout"
      },
      {
        "from": "Authenticated",
        "event": "receive SELECT",
        "action": "reply OK",
        "to": "Selected"
      },
      {
        "from": "Authenticated",
        "event": "receive EXAMINE",
        "action": "reply OK",
        "to": "Selected"
      },
      {
        "from": "Authenticated",
        "event": "receive LOGOUT",
        "action": "reply BYE and OK",
        "to": "Logout"
      },
      {
        "from": "Authenticated",
        "event": "receive APPEND",
        "action": "reply +",
        "to": "WaitingForContinuation"
      },
      {
        "from": "Authenticated",
        "event": "timeout 30m",
        "action": "close connection",
        "to": "Logout"
      },
      {
        "from": "Authenticated",
        "event": "receive any command",
        "action": "reset timer",
        "to": "Authenticated"
      },
      {
        "from": "Authenticated",
        "event": "receive ENABLE",
        "action": "reply ENABLED OK",
        "to": "Authenticated"
      },
      {
        "from": "Selected",
        "event": "receive CLOSE",
        "action": "reply OK",
        "to": "Authenticated"
      },
      {
        "from": "Selected",
        "event": "receive UNSELECT",
        "action": "reply OK",
        "to": "Authenticated"
      },
      {
        "from": "Selected",
        "event": "receive LOGOUT",
        "action": "reply BYE and OK",
        "to": "Logout"
      },
      {
        "from": "Selected",
        "event": "receive FETCH",
        "action": "reply FETCH OK",
        "to": "Selected"
      },
      {
        "from": "Selected",
        "event": "receive STORE",
        "action": "reply OK",
        "to": "Selected"
      },
      {
        "from": "Ready",
        "event": "receive COMMAND",
        "action": "process command",
        "to": "ProcessingCommand"
      },
      {
        "from": "Ready",
        "event": "send_sync_literal",
        "action": "send_literal_header",
        "to": "WaitingForContinuation"
      },
      {
        "from": "Ready",
        "event": "receive STARTTLS",
        "action": "reply OK Proceed",
        "to": "TlsNegotiation"
      },
      {
        "from": "ProcessingCommand",
        "event": "send +",
        "action": "reply +",
        "to": "WaitingForContinuation"
      },
      {
        "from": "ProcessingCommand",
        "event": "send OK/NO/BAD",
        "action": "reply tagged",
        "to": "Ready"
      },
      {
        "from": "WaitingForContinuation",
        "event": "receive CONTINUATION",
        "action": "process data",
        "to": "ProcessingCommand"
      },
      {
        "from": "WaitingForContinuation",
        "event": "receive_continuation",
        "action": "send_data",
        "to": "Ready"
      },
      {
        "from": "TlsNegotiation",
        "event": "receive AUTHENTICATE",
        "action": "reply OK",
        "to": "Authenticated"
      },
      {
        "from": "NotAuthenticated",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "Authenticated",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "Selected",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "Ready",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "ProcessingCommand",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "WaitingForContinuation",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "TlsNegotiation",
        "event": "send BYE",
        "action": "close connection",
        "to": "ConnectionClosed"
      },
      {
        "from": "Ready",
        "event": "receive LOGOUT",
        "action": "reply BYE",
        "to": "Logout"
      },
      {
        "from": "ProcessingCommand",
        "event": "receive LOGOUT",
        "action": "reply BYE",
        "to": "Logout"
      },
      {
        "from": "WaitingForContinuation",
        "event": "receive LOGOUT",
        "action": "reply BYE",
        "to": "Logout"
      },
      {
        "from": "TlsNegotiation",
        "event": "receive LOGOUT",
        "action": "reply BYE",
        "to": "Logout"
      }
    ]
  }
}